<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Configuration File Format</title><link rel="stylesheet" type="text/css" href="styles.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="index.html" title="Cedar Backup 2 Software Manual"><link rel="up" href="ch05.html" title="Chapter 5. Configuration"><link rel="prev" href="ch05.html" title="Chapter 5. Configuration"><link rel="next" href="ch05s03.html" title="Setting up a Pool of One"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Configuration File Format</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch05.html">Prev</a> </td><th width="60%" align="center">Chapter 5. Configuration</th><td width="20%" align="right"> <a accesskey="n" href="ch05s03.html">Next</a></td></tr></table><hr></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cedar-config-configfile"></a>Configuration File Format</h2></div></div></div><p>
         Cedar Backup is configured through an XML <a href="#ftn.idm968" class="footnote" name="idm968"><sup class="footnote">[17]</sup></a> configuration file,
         usually called <code class="filename">/etc/cback.conf</code>.  The configuration
         file contains the following sections: <em class="firstterm">reference</em>,
         <em class="firstterm">options</em>, <em class="firstterm">collect</em>,
         <em class="firstterm">stage</em>, <em class="firstterm">store</em>,
         <em class="firstterm">purge</em> and <em class="firstterm">extensions</em>.
      </p><p>
         All configuration files must contain the two general configuration
         sections, the reference section and the options section.  Besides
         that, administrators need only configure actions they intend to use.
         For instance, on a client machine, administrators will generally only
         configure the collect and purge sections, while on a master machine
         they will have to configure all four action-related sections.
         <a href="#ftn.idm980" class="footnote" name="idm980"><sup class="footnote">[18]</sup></a> The extensions section is
         always optional and can be omitted unless extensions are in use.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            Even though the Mac OS X (darwin) filesystem is
            <span class="emphasis"><em>not</em></span> case-sensitive, Cedar Backup configuration
            <span class="emphasis"><em>is</em></span> generally case-sensitive on that platform,
            just like on all other platforms.  For instance, even though the
            files <span class="quote">&#8220;<span class="quote">Ken</span>&#8221;</span> and <span class="quote">&#8220;<span class="quote">ken</span>&#8221;</span> might be the same on the
            Mac OS X filesystem, an exclusion in Cedar Backup configuration for
            <span class="quote">&#8220;<span class="quote">ken</span>&#8221;</span> will only match the file if it is actually on
            the filesystem with a lower-case <span class="quote">&#8220;<span class="quote">k</span>&#8221;</span> as its first
            letter.  This won't surprise the typical UNIX user, but might
            surprise someone who's gotten into the <span class="quote">&#8220;<span class="quote">Mac Mindset</span>&#8221;</span>.
         </p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="cedar-config-configfile-sample"></a>Sample Configuration File</h3></div></div></div><p>
            Both the Python source distribution and the Debian package come with a
            sample configuration file.  The Debian package includes its sample in
            <code class="filename">/usr/share/doc/cedar-backup2/examples/cback.conf.sample</code>.
         </p><p>
            This is a sample configuration file similar to the one provided in the
            source package.  Documentation below provides more information about
            each of the individual configuration sections.
         </p><pre class="programlisting">
&lt;?xml version="1.0"?&gt;
&lt;cb_config&gt;
   &lt;reference&gt;
      &lt;author&gt;Kenneth J. Pronovici&lt;/author&gt;
      &lt;revision&gt;1.3&lt;/revision&gt;
      &lt;description&gt;Sample&lt;/description&gt;
   &lt;/reference&gt;
   &lt;options&gt;
      &lt;starting_day&gt;tuesday&lt;/starting_day&gt;
      &lt;working_dir&gt;/opt/backup/tmp&lt;/working_dir&gt;
      &lt;backup_user&gt;backup&lt;/backup_user&gt;
      &lt;backup_group&gt;group&lt;/backup_group&gt;
      &lt;rcp_command&gt;/usr/bin/scp -B&lt;/rcp_command&gt;
   &lt;/options&gt;
   &lt;peers&gt;
      &lt;peer&gt;
         &lt;name&gt;debian&lt;/name&gt;
         &lt;type&gt;local&lt;/type&gt;
         &lt;collect_dir&gt;/opt/backup/collect&lt;/collect_dir&gt;
      &lt;/peer&gt;
   &lt;/peers&gt;
   &lt;collect&gt;
      &lt;collect_dir&gt;/opt/backup/collect&lt;/collect_dir&gt;
      &lt;collect_mode&gt;daily&lt;/collect_mode&gt;
      &lt;archive_mode&gt;targz&lt;/archive_mode&gt;
      &lt;ignore_file&gt;.cbignore&lt;/ignore_file&gt;
      &lt;dir&gt;
         &lt;abs_path&gt;/etc&lt;/abs_path&gt;
         &lt;collect_mode&gt;incr&lt;/collect_mode&gt;
      &lt;/dir&gt;
      &lt;file&gt;
         &lt;abs_path&gt;/home/root/.profile&lt;/abs_path&gt;
         &lt;collect_mode&gt;weekly&lt;/collect_mode&gt;
      &lt;/file&gt;
   &lt;/collect&gt;
   &lt;stage&gt;
      &lt;staging_dir&gt;/opt/backup/staging&lt;/staging_dir&gt;
   &lt;/stage&gt;
   &lt;store&gt;
      &lt;source_dir&gt;/opt/backup/staging&lt;/source_dir&gt;
      &lt;media_type&gt;cdrw-74&lt;/media_type&gt;
      &lt;device_type&gt;cdwriter&lt;/device_type&gt;
      &lt;target_device&gt;/dev/cdrw&lt;/target_device&gt;
      &lt;target_scsi_id&gt;0,0,0&lt;/target_scsi_id&gt;
      &lt;drive_speed&gt;4&lt;/drive_speed&gt;
      &lt;check_data&gt;Y&lt;/check_data&gt;
      &lt;check_media&gt;Y&lt;/check_media&gt;
      &lt;warn_midnite&gt;Y&lt;/warn_midnite&gt;
   &lt;/store&gt;
   &lt;purge&gt;
      &lt;dir&gt;
         &lt;abs_path&gt;/opt/backup/stage&lt;/abs_path&gt;
         &lt;retain_days&gt;7&lt;/retain_days&gt;
      &lt;/dir&gt;
      &lt;dir&gt;
         &lt;abs_path&gt;/opt/backup/collect&lt;/abs_path&gt;
         &lt;retain_days&gt;0&lt;/retain_days&gt;
      &lt;/dir&gt;
   &lt;/purge&gt;
&lt;/cb_config&gt;
         </pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="cedar-config-configfile-reference"></a>Reference Configuration</h3></div></div></div><p>
            The reference configuration section contains free-text elements
            that exist only for reference..  The section itself is required,
            but the individual elements may be left blank if desired.
         </p><p>
            This is an example reference configuration section:
         </p><pre class="programlisting">
&lt;reference&gt;
   &lt;author&gt;Kenneth J. Pronovici&lt;/author&gt;
   &lt;revision&gt;Revision 1.3&lt;/revision&gt;
   &lt;description&gt;Sample&lt;/description&gt;
   &lt;generator&gt;Yet to be Written Config Tool (tm)&lt;/description&gt;
&lt;/reference&gt;
         </pre><p>
            The following elements are part of the reference configuration section:
         </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">author</code></span></dt><dd><p>Author of the configuration file.</p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> None
                  </p></dd><dt><span class="term"><code class="literal">revision</code></span></dt><dd><p>Revision of the configuration file.</p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> None
                  </p></dd><dt><span class="term"><code class="literal">description</code></span></dt><dd><p>Description of the configuration file.</p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> None
                  </p></dd><dt><span class="term"><code class="literal">generator</code></span></dt><dd><p>Tool that generated the configuration file, if any.</p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> None
                  </p></dd></dl></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="cedar-config-configfile-options"></a>Options Configuration</h3></div></div></div><p>
            The options configuration section contains configuration options
            that are not specific to any one action.  
         </p><p>
            This is an example options configuration section:
         </p><pre class="programlisting">
&lt;options&gt;
   &lt;starting_day&gt;tuesday&lt;/starting_day&gt;
   &lt;working_dir&gt;/opt/backup/tmp&lt;/working_dir&gt;
   &lt;backup_user&gt;backup&lt;/backup_user&gt;
   &lt;backup_group&gt;backup&lt;/backup_group&gt;
   &lt;rcp_command&gt;/usr/bin/scp -B&lt;/rcp_command&gt;
   &lt;rsh_command&gt;/usr/bin/ssh&lt;/rsh_command&gt;
   &lt;cback_command&gt;/usr/bin/cback&lt;/cback_command&gt;
   &lt;managed_actions&gt;collect, purge&lt;/managed_actions&gt;
   &lt;override&gt;
      &lt;command&gt;cdrecord&lt;/command&gt;
      &lt;abs_path&gt;/opt/local/bin/cdrecord&lt;/abs_path&gt;
   &lt;/override&gt;
   &lt;override&gt;
      &lt;command&gt;mkisofs&lt;/command&gt;
      &lt;abs_path&gt;/opt/local/bin/mkisofs&lt;/abs_path&gt;
   &lt;/override&gt;
   &lt;pre_action_hook&gt;
      &lt;action&gt;collect&lt;/action&gt;
      &lt;command&gt;echo "I AM A PRE-ACTION HOOK RELATED TO COLLECT"&lt;/command&gt;
   &lt;/pre_action_hook&gt;
   &lt;post_action_hook&gt;
      &lt;action&gt;collect&lt;/action&gt;
      &lt;command&gt;echo "I AM A POST-ACTION HOOK RELATED TO COLLECT"&lt;/command&gt;
   &lt;/post_action_hook&gt;
&lt;/options&gt;
         </pre><p>
            The following elements are part of the options configuration section:
         </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">starting_day</code></span></dt><dd><p>Day that starts the week.</p><p>
                     Cedar Backup is built around the idea of weekly backups.
                     The starting day of week is the day that media will be
                     rebuilt from scratch and that incremental backup
                     information will be cleared.
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> Must be a day of the
                     week in English, i.e. <code class="literal">monday</code>,
                     <code class="literal">tuesday</code>, etc.  The validation is
                     case-sensitive.
                  </p></dd><dt><span class="term"><code class="literal">working_dir</code></span></dt><dd><p>Working (temporary) directory to use for backups.</p><p>
                     This directory is used for writing temporary files, such
                     as tar file or ISO filesystem images as they are being built.  It
                     is also used to store day-to-day information about
                     incremental backups.
                  </p><p>
                     The working directory should contain enough free space to
                     hold temporary tar files (on a client) or to build an ISO
                     filesystem image (on a master).
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> Must be an absolute path
                  </p></dd><dt><span class="term"><code class="literal">backup_user</code></span></dt><dd><p>Effective user that backups should run as.</p><p>
                     This user must exist on the machine which is being
                     configured and should not be root (although that
                     restriction is not enforced).
                  </p><p>
                     This value is also used as the default remote backup user
                     for remote peers.
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> Must be non-empty
                  </p></dd><dt><span class="term"><code class="literal">backup_group</code></span></dt><dd><p>Effective group that backups should run as.</p><p>
                     This group must exist on the machine which is being
                     configured, and should not be root or some other
                     <span class="quote">&#8220;<span class="quote">powerful</span>&#8221;</span> group (although that restriction
                     is not enforced).
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> Must be non-empty
                  </p></dd><dt><span class="term"><code class="literal">rcp_command</code></span></dt><dd><p>Default rcp-compatible copy command for staging.</p><p>
                     The rcp command should be the exact command used for
                     remote copies, including any required options.  If you are
                     using <span class="command"><strong>scp</strong></span>, you should pass it the
                     <code class="option">-B</code> option, so <span class="command"><strong>scp</strong></span> will
                     not ask for any user input (which could hang the backup).
                     A common example is something like <span class="command"><strong>/usr/bin/scp
                     -B</strong></span>.
                  </p><p>
                     This value is used as the default value for all remote
                     peers.  Technically, this value is not needed by clients,
                     but we require it for all config files anyway.
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> Must be non-empty
                  </p></dd><dt><span class="term"><code class="literal">rsh_command</code></span></dt><dd><p>Default rsh-compatible command to use for remote shells.</p><p>
                     The rsh command should be the exact command used for
                     remote shells, including any required options.  
                  </p><p>
                     This value is used as the default value for all managed
                     clients.  It is optional, because it is only used when
                     executing actions on managed clients.  However, each
                     managed client must either be able to read the value from
                     options configuration or must set the value explicitly.
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> Must be non-empty
                  </p></dd><dt><span class="term"><code class="literal">cback_command</code></span></dt><dd><p>Default cback-compatible command to use on managed remote clients.</p><p>
                     The cback command should be the exact command used for for
                     executing <span class="command"><strong>cback</strong></span> on a remote managed
                     client, including any required command-line options.  Do
                     <span class="emphasis"><em>not</em></span> list any actions in the command
                     line, and do <span class="emphasis"><em>not</em></span> include the
                     <span class="command"><strong>--full</strong></span> command-line option.
                  </p><p>
                     This value is used as the default value for all managed
                     clients.  It is optional, because it is only used when
                     executing actions on managed clients.  However, each
                     managed client must either be able to read the value from
                     options configuration or must set the value explicitly.
                  </p><p>
                     Note: if this command-line is complicated, it is often
                     better to create a simple shell script on the remote host
                     to encapsulate all of the options.  Then, just reference
                     the shell script in configuration.
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> Must be non-empty
                  </p></dd><dt><span class="term"><code class="literal">managed_actions</code></span></dt><dd><p>Default set of actions that are managed on remote clients.</p><p>
                     This is a comma-separated list of actions that the master
                     will manage on behalf of remote clients.  Typically, it
                     would include only collect-like actions and purge.  
                  </p><p>
                     This value is used as the default value for all managed
                     clients.  It is optional, because it is only used when
                     executing actions on managed clients.  However, each
                     managed client must either be able to read the value from
                     options configuration or must set the value explicitly.
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> Must be non-empty.  
                  </p></dd><dt><span class="term"><code class="literal">override</code></span></dt><dd><p>Command to override with a customized path.</p><p>
                     This is a subsection which contains a command to override
                     with a customized path.  This functionality would be used
                     if root's <code class="literal">$PATH</code> does not include a
                     particular required command, or if there is a need to use
                     a version of a command that is different than the one
                     listed on the <code class="literal">$PATH</code>.  Most users will
                     only use this section when directed to, in order to fix a
                     problem.
                  </p><p>
                     This section is optional, and can be repeated as many times
                     as necessary.
                  </p><p>
                     This subsection must contain the following two fields:
                  </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">command</code></span></dt><dd><p>
                              Name of the command to be overridden, i.e.
                              <span class="quote">&#8220;<span class="quote">cdrecord</span>&#8221;</span>. 
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be a
                              non-empty string.
                           </p></dd><dt><span class="term"><code class="literal">abs_path</code></span></dt><dd><p>
                              The absolute path where the overridden command 
                              can be found.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be an
                              absolute path.
                           </p></dd></dl></div></dd><dt><span class="term"><code class="literal">pre_action_hook</code></span></dt><dd><p>Hook configuring a command to be executed before an action.</p><p>
                     This is a subsection which configures a command to be
                     executed immediately before a named action.  It provides a
                     way for administrators to associate their own custom
                     functionality with standard Cedar Backup actions or with
                     arbitrary extensions.
                  </p><p>
                     This section is optional, and can be repeated as many times
                     as necessary.
                  </p><p>
                     This subsection must contain the following two fields:
                  </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">action</code></span></dt><dd><p>
                              Name of the Cedar Backup action that the hook is
                              associated with.   The action can be a standard
                              backup action (collect, stage, etc.) or can be an
                              extension action.  No validation is done to
                              ensure that the configured action actually
                              exists.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be a
                              non-empty string.
                           </p></dd><dt><span class="term"><code class="literal">command</code></span></dt><dd><p>
                              Name of the command to be executed.  This item
                              can either specify the path to a shell script of
                              some sort (the recommended approach) or can include
                              a complete shell command.  
                           </p><p>
                              Note: if you choose to provide a complete shell
                              command rather than the path to a script, you
                              need to be aware of some limitations of Cedar
                              Backup's command-line parser.  You cannot use a
                              subshell (via the <code class="literal">`command`</code> or
                              <code class="literal">$(command)</code> syntaxes) or any
                              shell variable in your command line.
                              Additionally, the command-line parser only
                              recognizes the double-quote character
                              (<code class="literal">"</code>) to delimit groupings or
                              strings on the command-line.  The bottom line is,
                              you are probably best off writing a shell script
                              of some sort for anything more sophisticated than
                              very simple shell commands.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be a
                              non-empty string.
                           </p></dd></dl></div></dd><dt><span class="term"><code class="literal">post_action_hook</code></span></dt><dd><p>Hook configuring a command to be executed after an action.</p><p>
                     This is a subsection which configures a command to be
                     executed immediately after a named action.  It provides a
                     way for administrators to associate their own custom
                     functionality with standard Cedar Backup actions or with
                     arbitrary extensions.
                  </p><p>
                     This section is optional, and can be repeated as many times
                     as necessary.
                  </p><p>
                     This subsection must contain the following two fields:
                  </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">action</code></span></dt><dd><p>
                              Name of the Cedar Backup action that the hook is
                              associated with.   The action can be a standard
                              backup action (collect, stage, etc.) or can be an
                              extension action.  No validation is done to
                              ensure that the configured action actually
                              exists.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be a
                              non-empty string.
                           </p></dd><dt><span class="term"><code class="literal">command</code></span></dt><dd><p>
                              Name of the command to be executed.  This item
                              can either specify the path to a shell script of
                              some sort (the recommended approach) or can include
                              a complete shell command.  
                           </p><p>
                              Note: if you choose to provide a complete shell
                              command rather than the path to a script, you
                              need to be aware of some limitations of Cedar
                              Backup's command-line parser.  You cannot use a
                              subshell (via the <code class="literal">`command`</code> or
                              <code class="literal">$(command)</code> syntaxes) or any
                              shell variable in your command line.
                              Additionally, the command-line parser only
                              recognizes the double-quote character
                              (<code class="literal">"</code>) to delimit groupings or
                              strings on the command-line.  The bottom line is,
                              you are probably best off writing a shell script
                              of some sort for anything more sophisticated than
                              very simple shell commands.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be a
                              non-empty string.
                           </p></dd></dl></div></dd></dl></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="cedar-config-configfile-peers"></a>Peers Configuration</h3></div></div></div><p>
            The peers configuration section contains a list of the peers
            managed by a master.  This section is only required on a master.
         </p><p>
            This is an example peers configuration section:
         </p><pre class="programlisting">
&lt;peers&gt;
   &lt;peer&gt;
      &lt;name&gt;machine1&lt;/name&gt;
      &lt;type&gt;local&lt;/type&gt;
      &lt;collect_dir&gt;/opt/backup/collect&lt;/collect_dir&gt;
   &lt;/peer&gt;
   &lt;peer&gt;
      &lt;name&gt;machine2&lt;/name&gt;
      &lt;type&gt;remote&lt;/type&gt;
      &lt;backup_user&gt;backup&lt;/backup_user&gt;
      &lt;collect_dir&gt;/opt/backup/collect&lt;/collect_dir&gt;
      &lt;ignore_failures&gt;all&lt;/ignore_failures&gt;
   &lt;/peer&gt;
   &lt;peer&gt;
      &lt;name&gt;machine3&lt;/name&gt;
      &lt;type&gt;remote&lt;/type&gt;
      &lt;managed&gt;Y&lt;/managed&gt;
      &lt;backup_user&gt;backup&lt;/backup_user&gt;
      &lt;collect_dir&gt;/opt/backup/collect&lt;/collect_dir&gt;
      &lt;rcp_command&gt;/usr/bin/scp&lt;/rcp_command&gt;
      &lt;rsh_command&gt;/usr/bin/ssh&lt;/rsh_command&gt;
      &lt;cback_command&gt;/usr/bin/cback&lt;/cback_command&gt;
      &lt;managed_actions&gt;collect, purge&lt;/managed_actions&gt;
   &lt;/peer&gt;
&lt;/peers&gt;
         </pre><p>
            The following elements are part of the peers configuration section:
         </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">peer</code> (local version)</span></dt><dd><p>Local client peer in a backup pool.</p><p>
                     This is a subsection which contains information about a
                     specific local client peer managed by a master.
                  </p><p>
                     This section can be repeated as many times as is
                     necessary.  At least one remote or local peer must be
                     configured.
                  </p><p>
                     The local peer subsection must contain the following fields:
                  </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">name</code></span></dt><dd><p>Name of the peer, typically a valid hostname.</p><p>
                              For local peers, this value is only used for
                              reference.  However, it is good practice to list
                              the peer's hostname here, for consistency with
                              remote peers.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be non-empty,
                              and unique among all peers.
                           </p></dd><dt><span class="term"><code class="literal">type</code></span></dt><dd><p>Type of this peer.</p><p>
                              This value identifies the type of the peer.  For
                              a local peer, it must always be <code class="literal">local</code>.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be <code class="literal">local</code>.
                           </p></dd><dt><span class="term"><code class="literal">collect_dir</code></span></dt><dd><p>Collect directory to stage from for this peer.</p><p>
                              The master will copy all files in this directory
                              into the appropriate staging directory.  Since
                              this is a local peer, the directory is assumed to
                              be reachable via normal filesystem operations
                              (i.e. <span class="command"><strong>cp</strong></span>). 
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be an absolute path.
                           </p></dd><dt><span class="term"><code class="literal">ignore_failures</code></span></dt><dd><p>Ignore failure mode for this peer</p><p>
                              The ignore failure mode indicates whether
                              <span class="quote">&#8220;<span class="quote">not ready to be staged</span>&#8221;</span> errors
                              should be ignored for this peer.  This option is
                              intended to be used for peers that are up only
                              intermittently, to cut down on the number of
                              error emails received by the Cedar Backup
                              administrator.
                           </p><p>
                              The "none" mode means that all errors will be
                              reported.  This is the default behavior.  The
                              "all" mode means to ignore all failures.  The
                              "weekly" mode means to ignore failures for a
                              start-of-week or full backup.  The "daily" mode
                              means to ignore failures for any backup that is
                              not either a full backup or a start-of-week
                              backup.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> If set, must
                              be one of "none", "all", "daily", or "weekly".
                           </p></dd></dl></div></dd><dt><span class="term"><code class="literal">peer</code> (remote version)</span></dt><dd><p>Remote client peer in a backup pool.</p><p>
                     This is a subsection which contains information about a
                     specific remote client peer managed by a master.  A remote
                     peer is one which can be reached via an rsh-based network
                     call.
                  </p><p>
                     This section can be repeated as many times as is
                     necessary.  At least one remote or local peer must be
                     configured.
                  </p><p>
                     The remote peer subsection must contain the following fields:
                  </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">name</code></span></dt><dd><p>Hostname of the peer.</p><p>
                              For remote peers, this must be a valid DNS
                              hostname or IP address which can be resolved
                              during an rsh-based network call.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be non-empty,
                              and unique among all peers.
                           </p></dd><dt><span class="term"><code class="literal">type</code></span></dt><dd><p>Type of this peer.</p><p>
                              This value identifies the type of the peer.  For
                              a remote peer, it must always be <code class="literal">remote</code>.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be <code class="literal">remote</code>.
                           </p></dd><dt><span class="term"><code class="literal">managed</code></span></dt><dd><p>Indicates whether this peer is managed.</p><p>
                              A managed peer (or managed client) is a peer for
                              which the master manages all of the backup
                              activites via a remote shell.
                           </p><p>
                              This field is optional.  If it doesn't exist, then
                              <code class="literal">N</code> will be assumed.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be a boolean (<code class="literal">Y</code> or <code class="literal">N</code>).
                           </p></dd><dt><span class="term"><code class="literal">collect_dir</code></span></dt><dd><p>Collect directory to stage from for this peer.</p><p>
                              The master will copy all files in this directory
                              into the appropriate staging directory.  Since
                              this is a remote peer, the directory is assumed to
                              be reachable via rsh-based network operations
                              (i.e. <span class="command"><strong>scp</strong></span> or the configured
                              rcp command). 
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be an absolute path.
                           </p></dd><dt><span class="term"><code class="literal">ignore_failures</code></span></dt><dd><p>Ignore failure mode for this peer</p><p>
                              The ignore failure mode indicates whether
                              <span class="quote">&#8220;<span class="quote">not ready to be staged</span>&#8221;</span> errors
                              should be ignored for this peer.  This option is
                              intended to be used for peers that are up only
                              intermittently, to cut down on the number of
                              error emails received by the Cedar Backup
                              administrator.
                           </p><p>
                              The "none" mode means that all errors will be
                              reported.  This is the default behavior.  The
                              "all" mode means to ignore all failures.  The
                              "weekly" mode means to ignore failures for a
                              start-of-week or full backup.  The "daily" mode
                              means to ignore failures for any backup that is
                              not either a full backup or a start-of-week
                              backup.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> If set, must
                              be one of "none", "all", "daily", or "weekly".
                           </p></dd><dt><span class="term"><code class="literal">backup_user</code></span></dt><dd><p>Name of backup user on the remote peer.</p><p>
                              This username will be used when copying files from
                              the remote peer via an rsh-based network connection.
                           </p><p>
                              This field is optional.  if it doesn't exist, the
                              backup will use the default backup user from the 
                              options section.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be non-empty.
                           </p></dd><dt><span class="term"><code class="literal">rcp_command</code></span></dt><dd><p>The rcp-compatible copy command for this peer.</p><p>
                              The rcp command should be the exact command used for
                              remote copies, including any required options.  If you are
                              using <span class="command"><strong>scp</strong></span>, you should pass it the
                              <code class="option">-B</code> option, so <span class="command"><strong>scp</strong></span> will
                              not ask for any user input (which could hang the backup).
                              A common example is something like <span class="command"><strong>/usr/bin/scp
                              -B</strong></span>.
                           </p><p>
                              This field is optional.  if it doesn't exist, the
                              backup will use the default rcp command from the
                              options section.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be non-empty.
                           </p></dd><dt><span class="term"><code class="literal">rsh_command</code></span></dt><dd><p>The rsh-compatible command for this peer.</p><p>
                              The rsh command should be the exact command used for
                              remote shells, including any required options.  
                           </p><p>
                              This value only applies if the peer is managed.
                           </p><p>
                              This field is optional.  if it doesn't exist, the
                              backup will use the default rsh command from the
                              options section.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be non-empty
                           </p></dd><dt><span class="term"><code class="literal">cback_command</code></span></dt><dd><p>The cback-compatible command for this peer.</p><p>
                              The cback command should be the exact command
                              used for for executing cback on the peer as part
                              of a managed backup.  This value must include any
                              required command-line options.  Do
                              <span class="emphasis"><em>not</em></span> list any actions in the
                              command line, and do <span class="emphasis"><em>not</em></span>
                              include the <span class="command"><strong>--full</strong></span>
                              command-line option.
                           </p><p>
                              This value only applies if the peer is managed.
                           </p><p>
                              This field is optional.  if it doesn't exist, the
                              backup will use the default cback command from the
                              options section.
                           </p><p>
                              Note: if this command-line is complicated, it is often
                              better to create a simple shell script on the remote host
                              to encapsulate all of the options.  Then, just reference
                              the shell script in configuration.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be non-empty
                           </p></dd><dt><span class="term"><code class="literal">managed_actions</code></span></dt><dd><p>Set of actions that are managed for this peer.</p><p>
                              This is a comma-separated list of actions that
                              the master will manage on behalf this peer.
                              Typically, it would include only collect-like
                              actions and purge.  
                           </p><p>
                              This value only applies if the peer is managed.
                           </p><p>
                              This field is optional.  if it doesn't exist, the
                              backup will use the default list of managed
                              actions from the options section.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be non-empty.  
                           </p></dd></dl></div></dd></dl></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="cedar-config-configfile-collect"></a>Collect Configuration</h3></div></div></div><p>
            The collect configuration section contains configuration options
            related the the collect action.  This section contains a variable
            number of elements, including an optional exclusion section and a
            repeating subsection used to specify which directories and/or files
            to collect.  You can also configure an ignore indicator file, which
            lets users mark their own directories as not backed up.
         </p><div class="sidebar"><div class="titlepage"><div><div><p class="title"><b>Using a Link Farm</b></p></div></div></div><p>
               Sometimes, it's not very convenient to list directories one by
               one in the Cedar Backup configuration file.  For instance, when
               backing up your home directory, you often exclude as many
               directories as you include.  The ignore file mechanism can be of
               some help, but it still isn't very convenient if there are a lot
               of directories to ignore (or if new directories pop up all of the
               time).
            </p><p>
               In this situation, one option is to use a <em class="firstterm">link
               farm</em> rather than listing all of the directories in
               configuration.  A link farm is a directory that contains nothing
               but a set of soft links to other files and directories.
               Normally, Cedar Backup does not follow soft links, but you can
               override this behavior for individual directories using the
               <code class="literal">link_depth</code> and <code class="literal">dereference</code> 
               options (see below).  
            </p><p>
               When using a link farm, you still have to deal with each
               backed-up directory individually, but you don't have to modify
               configuration.  Some users find that this works better for them.
            </p></div><p>
            In order to actually execute the collect action, you must have
            configured at least one collect directory or one collect file.
            However, if you are only including collect configuration for use by
            an extension, then it's OK to leave out these sections.  The
            validation will take place only when the collect action is
            executed.
         </p><p>
            This is an example collect configuration section:
         </p><pre class="programlisting">
&lt;collect&gt;
   &lt;collect_dir&gt;/opt/backup/collect&lt;/collect_dir&gt;
   &lt;collect_mode&gt;daily&lt;/collect_mode&gt;
   &lt;archive_mode&gt;targz&lt;/archive_mode&gt;
   &lt;ignore_file&gt;.cbignore&lt;/ignore_file&gt;
   &lt;exclude&gt;
      &lt;abs_path&gt;/etc&lt;/abs_path&gt;
      &lt;pattern&gt;.*\.conf&lt;/pattern&gt;
   &lt;/exclude&gt;
   &lt;file&gt;
      &lt;abs_path&gt;/home/root/.profile&lt;/abs_path&gt;
   &lt;/file&gt;
   &lt;dir&gt;
      &lt;abs_path&gt;/etc&lt;/abs_path&gt;
   &lt;/dir&gt;
   &lt;dir&gt;
      &lt;abs_path&gt;/var/log&lt;/abs_path&gt;
      &lt;collect_mode&gt;incr&lt;/collect_mode&gt;
   &lt;/dir&gt;
   &lt;dir&gt;
      &lt;abs_path&gt;/opt&lt;/abs_path&gt;
      &lt;collect_mode&gt;weekly&lt;/collect_mode&gt;
      &lt;exclude&gt;
         &lt;abs_path&gt;/opt/large&lt;/abs_path&gt;
         &lt;rel_path&gt;backup&lt;/rel_path&gt;
         &lt;pattern&gt;.*tmp&lt;/pattern&gt;
      &lt;/exclude&gt;
   &lt;/dir&gt;
&lt;/collect&gt;
         </pre><p>
            The following elements are part of the collect configuration
            section:
         </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">collect_dir</code></span></dt><dd><p>Directory to collect files into.</p><p>
                     On a client, this is the directory which tarfiles for
                     individual collect directories are written into.  The
                     master then stages files from this directory into its own
                     staging directory.
                  </p><p>
                     This field is always required.  It must contain enough
                     free space to collect all of the backed-up files on the
                     machine in a compressed form.
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> Must be an absolute path
                  </p></dd><dt><span class="term"><code class="literal">collect_mode</code></span></dt><dd><p>Default collect mode.</p><p>
                     The collect mode describes how frequently a directory is
                     backed up.   See <a class="xref" href="ch02s04.html#cedar-basic-process-collect" title="The Collect Action">the section called &#8220;The Collect Action&#8221;</a> (in <a class="xref" href="ch02.html" title="Chapter 2. Basic Concepts">Chapter 2, <i>Basic Concepts</i></a>) for more information.
                  </p><p>
                     This value is the collect mode that will be used by
                     default during the collect process.  Individual collect
                     directories (below) may override this value.  If
                     <span class="emphasis"><em>all</em></span> individual directories provide
                     their own value, then this default value may be omitted
                     from configuration.
                  </p><p>
                     Note: if your backup device does not suppport multisession
                     discs, then you should probably use the
                     <code class="literal">daily</code> collect mode to avoid losing
                     data.
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> Must be one of
                     <code class="literal">daily</code>, <code class="literal">weekly</code> or
                     <code class="literal">incr</code>.
                  </p></dd><dt><span class="term"><code class="literal">archive_mode</code></span></dt><dd><p>Default archive mode for collect files.</p><p>
                     The archive mode maps to the way that a backup file is
                     stored.  A value <code class="literal">tar</code> means just a
                     tarfile (<code class="filename">file.tar</code>); a value
                     <code class="literal">targz</code> means a gzipped tarfile
                     (<code class="filename">file.tar.gz</code>); and a value
                     <code class="literal">tarbz2</code> means a bzipped tarfile
                     (<code class="filename">file.tar.bz2</code>)
                  </p><p>
                     This value is the archive mode that will be used by
                     default during the collect process.  Individual collect
                     directories (below) may override this value.  If
                     <span class="emphasis"><em>all</em></span> individual directories provide
                     their own value, then this default value may be omitted
                     from configuration.
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> Must be one of
                     <code class="literal">tar</code>, <code class="literal">targz</code> or
                     <code class="literal">tarbz2</code>.
                  </p></dd><dt><span class="term"><code class="literal">ignore_file</code></span></dt><dd><p>Default ignore file name.</p><p>
                     The ignore file is an indicator file.  If it exists in a
                     given directory, then that directory will be recursively
                     excluded from the backup as if it were explicitly excluded
                     in configuration.  
                  </p><p>
                     The ignore file provides a way for individual users (who
                     might not have access to Cedar Backup configuration) to
                     control which of their own directories get backed up.  For
                     instance, users with a <code class="filename">~/tmp</code>
                     directory might not want it backed up.  If they create an
                     ignore file in their directory (e.g.
                     <code class="filename">~/tmp/.cbignore</code>), then Cedar Backup
                     will ignore it.
                  </p><p>
                     This value is the ignore file name that will be used by
                     default during the collect process.  Individual collect
                     directories (below) may override this value.  If
                     <span class="emphasis"><em>all</em></span> individual directories provide
                     their own value, then this default value may be omitted
                     from configuration.
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> Must be non-empty
                  </p></dd><dt><span class="term"><code class="literal">recursion_level</code></span></dt><dd><p>Recursion level to use when collecting directories.</p><p>
                     This is an integer value that Cedar Backup will consider
                     when generating archive files for a configured collect
                     directory.
                  </p><p>
                     Normally, Cedar Backup generates one archive file per
                     collect directory.  So, if you collect
                     <code class="literal">/etc</code> you get
                     <code class="literal">etc.tar.gz</code>.  Most of the time, this is
                     what you want.  However, you may sometimes wish to
                     generate multiple archive files for a single collect
                     directory.  
                  </p><p>
                     The most obvious example is for <code class="literal">/home</code>.
                     By default, Cedar Backup will generate
                     <code class="literal">home.tar.gz</code>. If instead, you want one
                     archive file per home directory you can set a recursion
                     level of <code class="literal">1</code>.  Cedar Backup will generate
                     <code class="literal">home-user1.tar.gz</code>,
                     <code class="literal">home-user2.tar.gz</code>, etc.
                  </p><p>
                     Higher recursion levels (<code class="literal">2</code>,
                     <code class="literal">3</code>, etc.) are legal, and it doesn't
                     matter if the configured recursion level is deeper than
                     the directory tree that is being collected.  You can use a
                     negative recursion level (like <code class="literal">-1</code>) to
                     specify an infinite level of recursion.  This will exhaust
                     the tree in the same way as if the recursion level is set
                     too high.
                  </p><p>
                     This field is optional.  if it doesn't exist, the backup
                     will use the default recursion level of zero.
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> Must be an integer.
                  </p></dd><dt><span class="term"><code class="literal">exclude</code></span></dt><dd><p>List of paths or patterns to exclude from the backup.</p><p>
                     This is a subsection which contains a set of absolute
                     paths and patterns to be excluded across all configured
                     directories.  For a given directory, the set of absolute
                     paths and patterns to exclude is built from this list and
                     any list that exists on the directory itself.  Directories
                     <span class="emphasis"><em>cannot</em></span> override or remove entries that
                     are in this list, however.
                  </p><p>
                     This section is optional, and if it exists can also be
                     empty.  
                  </p><p>
                     The exclude subsection can contain one or more of each of
                     the following fields:
                  </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">abs_path</code></span></dt><dd><p>
                              An absolute path to be recursively excluded from
                              the backup.
                           </p><p>
                              If a directory is excluded, then all of its children
                              are also recursively excluded.  For instance, a value
                              <code class="literal">/var/log/apache</code> would exclude any
                              files within <code class="filename">/var/log/apache</code> as
                              well as files within other directories under
                              <code class="filename">/var/log/apache</code>.
                           </p><p>
                              This field can be repeated as many times as is
                              necessary.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be an absolute path.
                           </p></dd><dt><span class="term"><code class="literal">pattern</code></span></dt><dd><p>
                              A pattern to be recursively excluded from the
                              backup.
                           </p><p>
                              The pattern must be a Python regular expression. 
                              <a href="#ftn.cedar-config-foot-regex" class="footnote" name="cedar-config-foot-regex"><sup class="footnote">[19]</sup></a>
                              It is assumed to be bounded at front and back by the beginning
                              and end of the string (i.e. it is treated as if it begins with
                              <code class="literal">^</code> and ends with <code class="literal">$</code>).
                           </p><p>
                              If the pattern causes a directory to be excluded,
                              then all of the children of that directory are
                              also recursively excluded.  For instance, a value
                              <code class="literal">.*apache.*</code> might match the
                              <code class="filename">/var/log/apache</code> directory.
                              This would exclude any files within
                              <code class="filename">/var/log/apache</code> as well as
                              files within other directories under
                              <code class="filename">/var/log/apache</code>.
                           </p><p>
                              This field can be repeated as many times as is
                              necessary.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be non-empty
                           </p></dd></dl></div></dd><dt><span class="term"><code class="literal">file</code></span></dt><dd><p>A file to be collected.</p><p>
                     This is a subsection which contains information about
                     a specific file to be collected (backed up).
                  </p><p>
                     This section can be repeated as many times as is
                     necessary.  At least one collect directory or collect file
                     must be configured when the collect action is executed.
                  </p><p>
                     The collect file subsection contains the following
                     fields:
                  </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">abs_path</code></span></dt><dd><p>
                              Absolute path of the file to collect.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be an absolute path.
                           </p></dd><dt><span class="term"><code class="literal">collect_mode</code></span></dt><dd><p>Collect mode for this file</p><p>
                              The collect mode describes how frequently a
                              file is backed up.   See <a class="xref" href="ch02s04.html#cedar-basic-process-collect" title="The Collect Action">the section called &#8220;The Collect Action&#8221;</a> (in <a class="xref" href="ch02.html" title="Chapter 2. Basic Concepts">Chapter 2, <i>Basic Concepts</i></a>) for more information.
                           </p><p>
                              This field is optional.  If it doesn't exist, the
                              backup will use the default collect mode.  
                           </p><p>
                              Note: if your backup device does not suppport
                              multisession discs, then you should probably
                              confine yourself to the <code class="literal">daily</code>
                              collect mode, to avoid losing data.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be one of
                              <code class="literal">daily</code>, <code class="literal">weekly</code> or
                              <code class="literal">incr</code>.
                           </p></dd><dt><span class="term"><code class="literal">archive_mode</code></span></dt><dd><p>Archive mode for this file.</p><p>
                              The archive mode maps to the way that a backup
                              file is stored.  A value <code class="literal">tar</code>
                              means just a tarfile
                              (<code class="filename">file.tar</code>); a value
                              <code class="literal">targz</code> means a gzipped tarfile
                              (<code class="filename">file.tar.gz</code>); and a value
                              <code class="literal">tarbz2</code> means a bzipped tarfile
                              (<code class="filename">file.tar.bz2</code>)
                           </p><p>
                              This field is optional.  if it doesn't exist, the
                              backup will use the default archive mode.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be one of
                              <code class="literal">tar</code>, <code class="literal">targz</code> or
                              <code class="literal">tarbz2</code>.
                           </p></dd></dl></div></dd><dt><span class="term"><code class="literal">dir</code></span></dt><dd><p>A directory to be collected.</p><p>
                     This is a subsection which contains information about
                     a specific directory to be collected (backed up).
                  </p><p>
                     This section can be repeated as many times as is
                     necessary.  At least one collect directory or collect file
                     must be configured when the collect action is executed.
                  </p><p>
                     The collect directory subsection contains the following
                     fields:
                  </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">abs_path</code></span></dt><dd><p>
                              Absolute path of the directory to collect.
                           </p><p>
                              The path may be either a directory, a soft link
                              to a directory, or a hard link to a directory.
                              All three are treated the same at this level.
                           </p><p>
                              The contents of the directory will be recursively
                              collected.  The backup will contain all of the
                              files in the directory, as well as the contents
                              of all of the subdirectories within the
                              directory, etc.  
                           </p><p>
                              Soft links <span class="emphasis"><em>within</em></span> the
                              directory are treated as files, i.e. they are
                              copied verbatim (as a link) and their contents
                              are not backed up.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be an absolute path.
                           </p></dd><dt><span class="term"><code class="literal">collect_mode</code></span></dt><dd><p>Collect mode for this directory</p><p>
                              The collect mode describes how frequently a
                              directory is backed up.   See <a class="xref" href="ch02s04.html#cedar-basic-process-collect" title="The Collect Action">the section called &#8220;The Collect Action&#8221;</a> (in <a class="xref" href="ch02.html" title="Chapter 2. Basic Concepts">Chapter 2, <i>Basic Concepts</i></a>) for more information.
                           </p><p>
                              This field is optional.  If it doesn't exist, the
                              backup will use the default collect mode.  
                           </p><p>
                              Note: if your backup device does not suppport
                              multisession discs, then you should probably
                              confine yourself to the <code class="literal">daily</code>
                              collect mode, to avoid losing data.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be one of
                              <code class="literal">daily</code>, <code class="literal">weekly</code> or
                              <code class="literal">incr</code>.
                           </p></dd><dt><span class="term"><code class="literal">archive_mode</code></span></dt><dd><p>Archive mode for this directory.</p><p>
                              The archive mode maps to the way that a backup
                              file is stored.  A value <code class="literal">tar</code>
                              means just a tarfile
                              (<code class="filename">file.tar</code>); a value
                              <code class="literal">targz</code> means a gzipped tarfile
                              (<code class="filename">file.tar.gz</code>); and a value
                              <code class="literal">tarbz2</code> means a bzipped tarfile
                              (<code class="filename">file.tar.bz2</code>)
                           </p><p>
                              This field is optional.  if it doesn't exist, the
                              backup will use the default archive mode.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be one of
                              <code class="literal">tar</code>, <code class="literal">targz</code> or
                              <code class="literal">tarbz2</code>.
                           </p></dd><dt><span class="term"><code class="literal">ignore_file</code></span></dt><dd><p>Ignore file name for this directory.</p><p>
                              The ignore file is an indicator file.  If it
                              exists in a given directory, then that directory
                              will be recursively excluded from the backup as
                              if it were explicitly excluded in configuration.  
                           </p><p>
                              The ignore file provides a way for individual
                              users (who might not have access to Cedar Backup
                              configuration) to control which of their own
                              directories get backed up.  For instance, users
                              with a <code class="filename">~/tmp</code> directory might
                              not want it backed up.  If they create an ignore
                              file in their directory (e.g.
                              <code class="filename">~/tmp/.cbignore</code>), then Cedar
                              Backup will ignore it.
                           </p><p>
                              This field is optional.  If it doesn't exist, the
                              backup will use the default ignore file name.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be non-empty
                           </p></dd><dt><span class="term"><code class="literal">link_depth</code></span></dt><dd><p>Link depth value to use for this directory.</p><p>
                              The link depth is maximum depth of the tree at
                              which soft links should be followed.  So, a depth
                              of 0 does not follow any soft links within the
                              collect directory, a depth of 1 follows only
                              links immediately within the collect directory, a
                              depth of 2 follows the links at the next level
                              down, etc.
                           </p><p>
                              This field is optional.  If it doesn't exist,
                              the backup will assume a value of zero, meaning
                              that soft links within the collect directory will
                              never be followed.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> If set, must
                              be an integer &#8805; 0.
                           </p></dd><dt><span class="term"><code class="literal">dereference</code></span></dt><dd><p>Whether to dereference soft links.</p><p>
                              If this flag is set, links that are being
                              followed will be dereferenced before being added
                              to the backup.  The link will be added (as a
                              link), and then the directory or file that the
                              link points at will be added as well.  
                           </p><p>
                              This value only applies to a directory where soft
                              links are being followed (per the
                              <code class="literal">link_depth</code> configuration
                              option).  It never applies to a configured
                              collect directory itself, only to other
                              directories within the collect directory.
                           </p><p>
                              This field is optional.  If it doesn't exist,
                              the backup will assume that links should never be
                              dereferenced.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be a
                              boolean (<code class="literal">Y</code> or
                              <code class="literal">N</code>).
                           </p></dd><dt><span class="term"><code class="literal">exclude</code></span></dt><dd><p>List of paths or patterns to exclude from the backup.</p><p>
                              This is a subsection which contains a set of
                              paths and patterns to be excluded within this
                              collect directory.  This list is combined with
                              the program-wide list to build a complete list
                              for the directory.
                           </p><p>
                              This section is entirely optional, and if it exists can
                              also be empty.  
                           </p><p>
                              The exclude subsection can contain one or more of each of
                              the following fields:
                           </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">abs_path</code></span></dt><dd><p>
                                       An absolute path to be recursively
                                       excluded from the backup.
                                    </p><p>
                                       If a directory is excluded, then all of
                                       its children are also recursively
                                       excluded.  For instance, a value
                                       <code class="literal">/var/log/apache</code> would
                                       exclude any files within
                                       <code class="filename">/var/log/apache</code> as
                                       well as files within other directories
                                       under
                                       <code class="filename">/var/log/apache</code>.
                                    </p><p>
                                       This field can be repeated as many times as is
                                       necessary.
                                    </p><p>
                                       <span class="emphasis"><em>Restrictions:</em></span> Must be an absolute path.
                                    </p></dd><dt><span class="term"><code class="literal">rel_path</code></span></dt><dd><p>
                                       A relative path to be recursively
                                       excluded from the backup.
                                    </p><p>
                                       The path is assumed to be relative to
                                       the collect directory itself.  For
                                       instance, if the configured directory is
                                       <code class="filename">/opt/web</code> a
                                       configured relative path of
                                       <code class="filename">something/else</code>
                                       would exclude the path
                                       <code class="filename">/opt/web/something/else</code>.
                                    </p><p>
                                       If a directory is excluded, then all of
                                       its children are also recursively
                                       excluded.  For instance, a value
                                       <code class="literal">something/else</code> would
                                       exclude any files within
                                       <code class="filename">something/else</code> as
                                       well as files within other directories
                                       under <code class="filename">something/else</code>.
                                    </p><p>
                                       This field can be repeated as many times as is
                                       necessary.
                                    </p><p>
                                       <span class="emphasis"><em>Restrictions:</em></span> Must be non-empty.
                                    </p></dd><dt><span class="term"><code class="literal">pattern</code></span></dt><dd><p>
                                       A pattern to be excluded from the backup.
                                    </p><p>
                                       The pattern must be a Python regular
                                       expression.  <a href="ch05s02.html#ftn.cedar-config-foot-regex" class="footnoteref"><sup class="footnoteref">[19]</sup></a> 
                                       It is assumed to be bounded at front and
                                       back by the beginning and end of the
                                       string (i.e. it is treated as if it
                                       begins with <code class="literal">^</code> and
                                       ends with <code class="literal">$</code>).
                                    </p><p>
                                       If the pattern causes a directory to be
                                       excluded, then all of the children of
                                       that directory are also recursively
                                       excluded.  For instance, a value
                                       <code class="literal">.*apache.*</code> might
                                       match the <code class="filename">/var/log/apache</code>
                                       directory.  This would exclude any files
                                       within <code class="filename">/var/log/apache</code> as
                                       well as files within other directories
                                       under <code class="filename">/var/log/apache</code>.
                                    </p><p>
                                       This field can be repeated as many times as is
                                       necessary.
                                    </p><p>
                                       <span class="emphasis"><em>Restrictions:</em></span> Must be non-empty
                                    </p></dd></dl></div></dd></dl></div></dd></dl></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="cedar-config-configfile-stage"></a>Stage Configuration</h3></div></div></div><p>
            The stage configuration section contains configuration options
            related the the stage action.  The section indicates where date
            from peers can be staged to.  
         </p><p>
            This section can also (optionally) override the list of peers so
            that not all peers are staged.  If you provide
            <span class="emphasis"><em>any</em></span> peers in this section, then the list of
            peers here completely replaces the list of peers in the peers
            configuration section for the purposes of staging.
         </p><p>
            This is an example stage configuration section for the simple case
            where the list of peers is taken from peers configuration:
         </p><pre class="programlisting">
&lt;stage&gt;
   &lt;staging_dir&gt;/opt/backup/stage&lt;/staging_dir&gt;
&lt;/stage&gt;
         </pre><p>
            This is an example stage configuration section that overrides the
            default list of peers:
         </p><pre class="programlisting">
&lt;stage&gt;
   &lt;staging_dir&gt;/opt/backup/stage&lt;/staging_dir&gt;
   &lt;peer&gt;
      &lt;name&gt;machine1&lt;/name&gt;
      &lt;type&gt;local&lt;/type&gt;
      &lt;collect_dir&gt;/opt/backup/collect&lt;/collect_dir&gt;
   &lt;/peer&gt;
   &lt;peer&gt;
      &lt;name&gt;machine2&lt;/name&gt;
      &lt;type&gt;remote&lt;/type&gt;
      &lt;backup_user&gt;backup&lt;/backup_user&gt;
      &lt;collect_dir&gt;/opt/backup/collect&lt;/collect_dir&gt;
   &lt;/peer&gt;
&lt;/stage&gt;
         </pre><p>
            The following elements are part of the stage configuration section:
         </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">staging_dir</code></span></dt><dd><p>Directory to stage files into.</p><p>
                     This is the directory into which the master stages collected
                     data from each of the clients.  Within the staging directory,
                     data is staged into date-based directories by peer name.  For
                     instance, peer <span class="quote">&#8220;<span class="quote">daystrom</span>&#8221;</span> backed up on 19 Feb 2005
                     would be staged into something like <code class="filename">2005/02/19/daystrom</code>
                     relative to the staging directory itself.
                  </p><p>
                     This field is always required.  The directory must contain
                     enough free space to stage all of the files collected from
                     all of the various machines in a backup pool.  Many
                     administrators set up purging to keep staging directories
                     around for a week or more, which requires even more space.
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> Must be an absolute path
                  </p></dd><dt><span class="term"><code class="literal">peer</code> (local version)</span></dt><dd><p>Local client peer in a backup pool.</p><p>
                     This is a subsection which contains information about a
                     specific local client peer to be staged (backed up).  A
                     local peer is one whose collect directory can be reached
                     without requiring any rsh-based network calls.  It is
                     possible that a remote peer might be staged as a local
                     peer if its collect directory is mounted to the master via
                     NFS, AFS or some other method.
                  </p><p>
                     This section can be repeated as many times as is
                     necessary.  At least one remote or local peer must be
                     configured.
                  </p><p>
                     <span class="emphasis"><em>Remember</em></span>, if you provide
                     <span class="emphasis"><em>any</em></span> local or remote peer in staging
                     configuration, the global peer configuration is completely
                     replaced by the staging peer configuration.
                  </p><p>
                     The local peer subsection must contain the following fields:
                  </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">name</code></span></dt><dd><p>Name of the peer, typically a valid hostname.</p><p>
                              For local peers, this value is only used for
                              reference.  However, it is good practice to list
                              the peer's hostname here, for consistency with
                              remote peers.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be non-empty,
                              and unique among all peers.
                           </p></dd><dt><span class="term"><code class="literal">type</code></span></dt><dd><p>Type of this peer.</p><p>
                              This value identifies the type of the peer.  For
                              a local peer, it must always be <code class="literal">local</code>.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be <code class="literal">local</code>.
                           </p></dd><dt><span class="term"><code class="literal">collect_dir</code></span></dt><dd><p>Collect directory to stage from for this peer.</p><p>
                              The master will copy all files in this directory
                              into the appropriate staging directory.  Since
                              this is a local peer, the directory is assumed to
                              be reachable via normal filesystem operations
                              (i.e. <span class="command"><strong>cp</strong></span>). 
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be an absolute path.
                           </p></dd></dl></div></dd><dt><span class="term"><code class="literal">peer</code> (remote version)</span></dt><dd><p>Remote client peer in a backup pool.</p><p>
                     This is a subsection which contains information about a
                     specific remote client peer to be staged (backed up).  A
                     remote peer is one whose collect directory can only be
                     reached via an rsh-based network call.
                  </p><p>
                     This section can be repeated as many times as is
                     necessary.  At least one remote or local peer must be
                     configured.
                  </p><p>
                     <span class="emphasis"><em>Remember</em></span>, if you provide
                     <span class="emphasis"><em>any</em></span> local or remote peer in staging
                     configuration, the global peer configuration is completely
                     replaced by the staging peer configuration.
                  </p><p>
                     The remote peer subsection must contain the following fields:
                  </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">name</code></span></dt><dd><p>Hostname of the peer.</p><p>
                              For remote peers, this must be a valid DNS
                              hostname or IP address which can be resolved
                              during an rsh-based network call.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be non-empty,
                              and unique among all peers.
                           </p></dd><dt><span class="term"><code class="literal">type</code></span></dt><dd><p>Type of this peer.</p><p>
                              This value identifies the type of the peer.  For
                              a remote peer, it must always be <code class="literal">remote</code>.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be <code class="literal">remote</code>.
                           </p></dd><dt><span class="term"><code class="literal">collect_dir</code></span></dt><dd><p>Collect directory to stage from for this peer.</p><p>
                              The master will copy all files in this directory
                              into the appropriate staging directory.  Since
                              this is a remote peer, the directory is assumed to
                              be reachable via rsh-based network operations
                              (i.e. <span class="command"><strong>scp</strong></span> or the configured
                              rcp command). 
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be an absolute path.
                           </p></dd><dt><span class="term"><code class="literal">backup_user</code></span></dt><dd><p>Name of backup user on the remote peer.</p><p>
                              This username will be used when copying files from
                              the remote peer via an rsh-based network connection.
                           </p><p>
                              This field is optional.  if it doesn't exist, the
                              backup will use the default backup user from the 
                              options section.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be non-empty.
                           </p></dd><dt><span class="term"><code class="literal">rcp_command</code></span></dt><dd><p>The rcp-compatible copy command for this peer.</p><p>
                              The rcp command should be the exact command used for
                              remote copies, including any required options.  If you are
                              using <span class="command"><strong>scp</strong></span>, you should pass it the
                              <code class="option">-B</code> option, so <span class="command"><strong>scp</strong></span> will
                              not ask for any user input (which could hang the backup).
                              A common example is something like <span class="command"><strong>/usr/bin/scp
                              -B</strong></span>.
                           </p><p>
                              This field is optional.  if it doesn't exist, the
                              backup will use the default rcp command from the
                              options section.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be non-empty.
                           </p></dd></dl></div></dd></dl></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="cedar-config-configfile-store"></a>Store Configuration</h3></div></div></div><p>
            The store configuration section contains configuration options
            related the the store action.  This section contains several
            optional fields.  Most fields control the way media is written
            using the writer device.
         </p><p>
            This is an example store configuration section:
         </p><pre class="programlisting">
&lt;store&gt;
   &lt;source_dir&gt;/opt/backup/stage&lt;/source_dir&gt;
   &lt;media_type&gt;cdrw-74&lt;/media_type&gt;
   &lt;device_type&gt;cdwriter&lt;/device_type&gt;
   &lt;target_device&gt;/dev/cdrw&lt;/target_device&gt;
   &lt;target_scsi_id&gt;0,0,0&lt;/target_scsi_id&gt;
   &lt;drive_speed&gt;4&lt;/drive_speed&gt;
   &lt;check_data&gt;Y&lt;/check_data&gt;
   &lt;check_media&gt;Y&lt;/check_media&gt;
   &lt;warn_midnite&gt;Y&lt;/warn_midnite&gt;
   &lt;no_eject&gt;N&lt;/no_eject&gt;
   &lt;refresh_media_delay&gt;15&lt;/refresh_media_delay&gt;
   &lt;eject_delay&gt;2&lt;/eject_delay&gt;
   &lt;blank_behavior&gt;
      &lt;mode&gt;weekly&lt;/mode&gt;
      &lt;factor&gt;1.3&lt;/factor&gt;
   &lt;/blank_behavior&gt;
&lt;/store&gt;
         </pre><p>
            The following elements are part of the store configuration section:
         </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">source_dir</code></span></dt><dd><p>Directory whose contents should be written to media.</p><p>
                     This directory <span class="emphasis"><em>must</em></span> be a Cedar Backup
                     staging directory, as configured in the staging configuration
                     section.  Only certain data from that directory (typically,
                     data from the current day) will be written to disc.
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> Must be an absolute path
                  </p></dd><dt><span class="term"><code class="literal">device_type</code></span></dt><dd><p>Type of the device used to write the media.</p><p>
                     This field controls which type of writer device will be
                     used by Cedar Backup.  Currently, Cedar Backup supports CD
                     writers (<code class="literal">cdwriter</code>) and DVD writers
                     (<code class="literal">dvdwriter</code>).
                  </p><p>
                     This field is optional.  If it doesn't exist, the
                     <code class="literal">cdwriter</code> device type is assumed.  
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> If set, must be either <code class="literal">cdwriter</code>
                     or <code class="literal">dvdwriter</code>.
                  </p></dd><dt><span class="term"><code class="literal">media_type</code></span></dt><dd><p>Type of the media in the device.</p><p>
                     Unless you want to throw away a backup disc every week,
                     you are probably best off using rewritable media.
                  </p><p>
                     You must choose a media type that is appropriate for the
                     device type you chose above.  For more information on
                     media types, see <a class="xref" href="ch02s07.html" title="Media and Device Types">the section called &#8220;Media and Device Types&#8221;</a>
                     (in <a class="xref" href="ch02.html" title="Chapter 2. Basic Concepts">Chapter 2, <i>Basic Concepts</i></a>).
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> Must be one of
                     <code class="literal">cdr-74</code>, <code class="literal">cdrw-74</code>, 
                     <code class="literal">cdr-80</code> or <code class="literal">cdrw-80</code>
                     if device type is <code class="literal">cdwriter</code>; or one
                     of <code class="literal">dvd+r</code> or <code class="literal">dvd+rw</code>
                     if device type is <code class="literal">dvdwriter</code>.
                  </p></dd><dt><span class="term"><code class="literal">target_device</code></span></dt><dd><p>Filesystem device name for writer device.</p><p>
                     This value is required for both CD writers and DVD
                     writers.  
                  </p><p>
                     This is the UNIX device name for the writer drive, for
                     instance <code class="filename">/dev/scd0</code> or a symlink
                     like <code class="filename">/dev/cdrw</code>.   
                  </p><p>
                     In some cases, this device name is used to directly write
                     to media.  This is true all of the time for DVD writers,
                     and is true for CD writers when a SCSI id (see below) has
                     not been specified.  
                  </p><p>
                     Besides this, the device name is also needed in order to
                     do several pre-write checks (such as whether the device
                     might already be mounted) as well as the post-write
                     consistency check, if enabled.
                  </p><p>
                     Note: some users have reported intermittent problems when
                     using a symlink as the target device on Linux, especially
                     with DVD media.  If you experience problems, try using the
                     real device name rather than the symlink.
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> Must be an absolute path.
                  </p></dd><dt><span class="term"><code class="literal">target_scsi_id</code></span></dt><dd><p>SCSI id for the writer device.</p><p>
                     This value is optional for CD writers and is ignored for
                     DVD writers.
                  </p><p>
                     If you have configured your CD writer hardware to work
                     through the normal filesystem device path, then you can
                     leave this parameter unset.  Cedar Backup will just use
                     the target device (above) when talking to
                     <span class="command"><strong>cdrecord</strong></span>.
                  </p><p>
                     Otherwise, if you have SCSI CD writer hardware or you have
                     configured your non-SCSI hardware to operate like a SCSI
                     device, then you need to provide Cedar Backup with a SCSI
                     id it can use when talking with
                     <span class="command"><strong>cdrecord</strong></span>.
                  </p><p>
                     For the purposes of Cedar Backup, a valid SCSI identifier
                     must either be in the standard SCSI identifier form
                     <code class="literal">scsibus,target,lun</code> or in the
                     specialized-method form
                     <code class="literal">&lt;method&gt;:scsibus,target,lun</code>.
                  </p><p>
                     An example of a standard SCSI identifier is
                     <code class="literal">1,6,2</code>. Today, the two most common examples
                     of the specialized-method form are
                     <code class="literal">ATA:scsibus,target,lun</code> and
                     <code class="literal">ATAPI:scsibus,target,lun</code>, but you may
                     occassionally see other values (like
                     <code class="literal">OLDATAPI</code> in some forks of
                     <span class="command"><strong>cdrecord</strong></span>).
                  </p><p>
                     See <a class="xref" href="ch05s06.html" title="Configuring your Writer Device">the section called &#8220;Configuring your Writer Device&#8221;</a> for more
                     information on writer devices and how they are configured.
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> If set, must be a valid SCSI identifier.
                  </p></dd><dt><span class="term"><code class="literal">drive_speed</code></span></dt><dd><p>Speed of the drive, i.e. <code class="literal">2</code> for a 2x device.</p><p>
                     This field is optional.  If it doesn't exist, the
                     underlying device-related functionality will use the
                     default drive speed.  
                  </p><p>
                     For DVD writers, it is best to leave this value unset, so
                     <span class="command"><strong>growisofs</strong></span> can pick an appropriate
                     speed.  For CD writers, since media can be
                     speed-sensitive, it is probably best to set a sensible
                     value based on your specific writer and media.
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> If set, must be an integer &#8805; 1.
                  </p></dd><dt><span class="term"><code class="literal">check_data</code></span></dt><dd><p>Whether the media should be validated.</p><p>
                     This field indicates whether a resulting image on the
                     media should be validated after the write completes, by
                     running a consistency check against it.  If this check is
                     enabled, the contents of the staging directory are
                     directly compared to the media, and an error is reported
                     if there is a mismatch.
                  </p><p>
                     Practice shows that some drives can encounter an error
                     when writing a multisession disc, but not report any problems.
                     This consistency check allows us to catch the problem.
                     By default, the consistency check is disabled, but most
                     users should choose to enable it unless they have a good
                     reason not to.
                  </p><p>
                     This field is optional.  If it doesn't exist, then
                     <code class="literal">N</code> will be assumed.
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> Must be a boolean (<code class="literal">Y</code> or <code class="literal">N</code>).
                  </p></dd><dt><span class="term"><code class="literal">check_media</code></span></dt><dd><p>Whether the media should be checked before writing to it.</p><p>
                     By default, Cedar Backup does not check its media before
                     writing to it.  It will write to any media in the backup
                     device.  If you set this flag to Y, Cedar Backup will make
                     sure that the media has been initialized before writing to
                     it.  (Rewritable media is initialized using the initialize
                     action.)
                  </p><p>
                     If the configured media is not rewritable (like CD-R),
                     then this behavior is modified slightly.  For this kind of
                     media, the check passes either if the media has been
                     initialized <span class="emphasis"><em>or</em></span> if the media appears
                     unused.
                  </p><p>
                     This field is optional.  If it doesn't exist, then
                     <code class="literal">N</code> will be assumed.
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> Must be a boolean (<code class="literal">Y</code> or <code class="literal">N</code>).
                  </p></dd><dt><span class="term"><code class="literal">warn_midnite</code></span></dt><dd><p>Whether to generate warnings for crossing midnite.</p><p>
                     This field indicates whether warnings should be generated
                     if the store operation has to cross a midnite boundary in
                     order to find data to write to disc.  For instance, a
                     warning would be generated if valid store data was only
                     found in the day before or day after the current day.
                  </p><p>
                     Configuration for some users is such that the store
                     operation will always cross a midnite boundary, so they
                     will not care about this warning.  Other users will expect
                     to never cross a boundary, and want to be notified that
                     something <span class="quote">&#8220;<span class="quote">strange</span>&#8221;</span> might have happened.
                  </p><p>
                     This field is optional.  If it doesn't exist, then
                     <code class="literal">N</code> will be assumed.
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> Must be a boolean (<code class="literal">Y</code> or <code class="literal">N</code>).
                  </p></dd><dt><span class="term"><code class="literal">no_eject</code></span></dt><dd><p>Indicates that the writer device should not be ejected.</p><p>
                     Under some circumstances, Cedar Backup ejects (opens and
                     closes) the writer device.  This is done because some
                     writer devices need to re-load the media before noticing a
                     media state change (like a new session).
                  </p><p>
                     For most writer devices this is safe, because they have a
                     tray that can be opened and closed.  If your writer device
                     does not have a tray <span class="emphasis"><em>and</em></span> Cedar Backup
                     does not properly detect this, then set this flag.  Cedar
                     Backup will not ever issue an eject command to your
                     writer.
                  </p><p>
                     Note: this could cause problems with your backup.  For
                     instance, with many writers, the check data step may fail
                     if the media is not reloaded first.  If this happens to
                     you, you may need to get a different writer device.
                  </p><p>
                     This field is optional.  If it doesn't exist, then
                     <code class="literal">N</code> will be assumed.
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> Must be a boolean (<code class="literal">Y</code> or <code class="literal">N</code>).
                  </p></dd><dt><span class="term"><code class="literal">refresh_media_delay</code></span></dt><dd><p>Number of seconds to delay after refreshing media</p><p>
                     This field is optional.  If it doesn't exist, no delay
                     will occur.
                  </p><p>
                     Some devices seem to take a little while to stablize after
                     refreshing the media (i.e. closing and opening the tray).
                     During this period, operations on the media may fail.  If
                     your device behaves like this, you can try setting a delay
                     of 10-15 seconds.
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> If set, must be an integer &#8805; 1.
                  </p></dd><dt><span class="term"><code class="literal">eject_delay</code></span></dt><dd><p>Number of seconds to delay after ejecting the tray</p><p>
                     This field is optional.  If it doesn't exist, no delay
                     will occur.
                  </p><p>
                     If your system seems to have problems opening and closing the tray,
                     one possibility is that the open/close sequence is happening too
                     quickly &#8212; either the tray isn't fully open when Cedar Backup
                     tries to close it, or it doesn't report being open.  To work around
                     that problem, set an eject delay of a few seconds.
                  </p><p>
                     <span class="emphasis"><em>Restrictions:</em></span> If set, must be an integer &#8805; 1.
                  </p></dd><dt><span class="term"><code class="literal">blank_behavior</code></span></dt><dd><p>Optimized blanking strategy.</p><p>
                     For more information about Cedar Backup's optimized
                     blanking strategy, see <a class="xref" href="ch05s07.html" title="Optimized Blanking Stategy">the section called &#8220;Optimized Blanking Stategy&#8221;</a>.
                  </p><p>
                     This entire configuration section is optional.  However,
                     if you choose to provide it, you must configure both a
                     blanking mode and a blanking factor.
                  </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">blank_mode</code></span></dt><dd><p>Blanking mode.</p><p>
                              <span class="emphasis"><em>Restrictions:</em></span>Must be one of "daily" or "weekly".
                           </p></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">blank_factor</code></span></dt><dd><p>Blanking factor.</p><p>
                              <span class="emphasis"><em>Restrictions:</em></span>Must be a floating point number &#8805; 0.
                           </p></dd></dl></div></dd></dl></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="cedar-config-configfile-purge"></a>Purge Configuration</h3></div></div></div><p>
            The purge configuration section contains configuration options
            related the the purge action.  This section contains a set of
            directories to be purged, along with information about the schedule
            at which they should be purged.
         </p><p>
            Typically, Cedar Backup should be configured to purge collect
            directories daily (retain days of <code class="literal">0</code>).
         </p><p>
            If you are tight on space, staging directories can also be purged
            daily.  However, if you have space to spare, you should consider
            purging about once per week.  That way, if your backup media is
            damaged, you will be able to recreate the week's backup using the
            rebuild action.
         </p><p>
            You should also purge the working directory periodically, once
            every few weeks or once per month.  This way, if any unneeded files
            are left around, perhaps because a backup was interrupted or
            because configuration changed, they will eventually be removed.
            <span class="emphasis"><em>The working directory should not be purged any more
            frequently than once per week, otherwise you will risk destroying
            data used for incremental backups.</em></span>
         </p><p>
            This is an example purge configuration section:
         </p><pre class="programlisting">
&lt;purge&gt;
   &lt;dir&gt;
      &lt;abs_path&gt;/opt/backup/stage&lt;/abs_path&gt;
      &lt;retain_days&gt;7&lt;/retain_days&gt;
   &lt;/dir&gt;
   &lt;dir&gt;
      &lt;abs_path&gt;/opt/backup/collect&lt;/abs_path&gt;
      &lt;retain_days&gt;0&lt;/retain_days&gt;
   &lt;/dir&gt;
&lt;/purge&gt;
         </pre><p>
            The following elements are part of the purge configuration section:
         </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">dir</code></span></dt><dd><p>A directory to purge within.</p><p>
                     This is a subsection which contains information about
                     a specific directory to purge within.
                  </p><p>
                     This section can be repeated as many times as is
                     necessary.  At least one purge directory must be
                     configured.
                  </p><p>
                     The purge directory subsection contains the following fields:
                  </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">abs_path</code></span></dt><dd><p>
                              Absolute path of the directory to purge within.
                           </p><p>
                              The contents of the directory will be purged
                              based on age.  The purge will remove any files
                              that were last modified more than <span class="quote">&#8220;<span class="quote">retain
                              days</span>&#8221;</span> days ago.  Empty directories will
                              also eventually be removed.  The purge directory
                              itself will never be removed.
                           </p><p>
                              The path may be either a directory, a soft link
                              to a directory, or a hard link to a directory.
                              Soft links <span class="emphasis"><em>within</em></span> the
                              directory (if any) are treated as files.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be an absolute path.
                           </p></dd><dt><span class="term"><code class="literal">retain_days</code></span></dt><dd><p>
                              Number of days to retain old files.
                           </p><p>
                              Once it has been more than this many days since a file
                              was last modified, it is a candidate for removal.
                           </p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be an integer &#8805; 0.
                           </p></dd></dl></div></dd></dl></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="cedar-config-configfile-extensions"></a>Extensions Configuration</h3></div></div></div><p>
            The extensions configuration section is used to configure
            third-party extensions to Cedar Backup.  If you don't intend to use
            any extensions, or don't know what extensions are, then you can
            safely leave this section out of your configuration file.  It is
            optional.
         </p><p>
            Extensions configuration is used to specify <span class="quote">&#8220;<span class="quote">extended
            actions</span>&#8221;</span> implemented by code external to Cedar Backup.  An
            administrator can use this section to map command-line Cedar
            Backup actions to third-party extension functions.
         </p><p>
            Each extended action has a name, which is mapped to a Python
            function within a particular module.  Each action also has an index
            associated with it.  This index is used to properly order execution
            when more than one action is specified on the command line.
            The standard actions have predefined indexes, and extended actions
            are interleaved into the normal order of execution using those
            indexes.  The collect action has index 100, the stage index
            has action 200, the store action has index 300 and the purge
            action has index 400.
         </p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
               Extended actions should always be configured to run
               <span class="emphasis"><em>before</em></span> the standard action they are
               associated with.  This is because of the way indicator files are
               used in Cedar Backup.  For instance, the staging process
               considers the collect action to be complete for a peer if the
               file <code class="filename">cback.collect</code> can be found in that
               peer's collect directory.  
            </p><p>
               If you were to run the standard collect action before your other
               collect-like actions, the indicator file would be written after
               the collect action completes but <span class="emphasis"><em>before</em></span> all
               of the other actions even run.  Because of this, there's a
               chance the stage process might back up the collect directory
               before the entire set of collect-like actions have completed
               &#8212; and you would get no warning about this in your email!
            </p></div><p>
            So, imagine that a third-party developer provided a Cedar
            Backup extension to back up a certain kind of database repository,
            and you wanted to map that extension to the <span class="quote">&#8220;<span class="quote">database</span>&#8221;</span>
            command-line action.  You have been told that this function is
            called <span class="quote">&#8220;<span class="quote">foo.bar()</span>&#8221;</span>.  You think of this backup as a
            <span class="quote">&#8220;<span class="quote">collect</span>&#8221;</span> kind of action, so you want it to be
            performed immediately before the collect action.
         </p><p>
            To configure this extension, you would list an action with a name
            <span class="quote">&#8220;<span class="quote">database</span>&#8221;</span>, a module <span class="quote">&#8220;<span class="quote">foo</span>&#8221;</span>,
            a function name <span class="quote">&#8220;<span class="quote">bar</span>&#8221;</span> and an index of
            <span class="quote">&#8220;<span class="quote">99</span>&#8221;</span>.
         </p><p>
            This is how the hypothetical action would be configured:
         </p><pre class="programlisting">
&lt;extensions&gt;
   &lt;action&gt;
      &lt;name&gt;database&lt;/name&gt;
      &lt;module&gt;foo&lt;/module&gt;
      &lt;function&gt;bar&lt;/function&gt;
      &lt;index&gt;99&lt;/index&gt;
   &lt;/action&gt;
&lt;/extensions&gt;
         </pre><p>
            The following elements are part of the extensions configuration
            section:
         </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">action</code></span></dt><dd><p>
                     This is a subsection that contains configuration
                     related to a single extended action.
                  </p><p>
                     This section can be repeated as many times as is
                     necessary.  
                  </p><p>
                     The action subsection contains the following fields:
                  </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">name</code></span></dt><dd><p>Name of the extended action.</p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be a non-empty
                              string consisting of only lower-case letters and digits.
                           </p></dd><dt><span class="term"><code class="literal">module</code></span></dt><dd><p>Name of the Python module associated with the extension function.</p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be a non-empty string
                              and a valid Python identifier.
                           </p></dd><dt><span class="term"><code class="literal">function</code></span></dt><dd><p>Name of the Python extension function within the module.</p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be a non-empty string
                              and a valid Python identifier.
                           </p></dd><dt><span class="term"><code class="literal">index</code></span></dt><dd><p>Index of action, for execution ordering.</p><p>
                              <span class="emphasis"><em>Restrictions:</em></span> Must be an integer &#8805; 0.
                           </p></dd></dl></div></dd></dl></div></div><div class="footnotes"><br><hr style="width:100; text-align:left;margin-left: 0"><div id="ftn.idm968" class="footnote"><p><a href="#idm968" class="para"><sup class="para">[17] </sup></a>See 
         <a class="ulink" href="http://www.xml.com/pub/a/98/10/guide0.html" target="_top">http://www.xml.com/pub/a/98/10/guide0.html</a>
         for a basic introduction to XML.</p></div><div id="ftn.idm980" class="footnote"><p><a href="#idm980" class="para"><sup class="para">[18] </sup></a>See <a class="xref" href="ch02s04.html" title="The Backup Process">the section called &#8220;The Backup Process&#8221;</a>, in <a class="xref" href="ch02.html" title="Chapter 2. Basic Concepts">Chapter 2, <i>Basic Concepts</i></a>.</p></div><div id="ftn.cedar-config-foot-regex" class="footnote"><p><a href="#cedar-config-foot-regex" class="para"><sup class="para">[19] </sup></a>See <a class="ulink" href="http://docs.python.org/lib/re-syntax.html" target="_top">http://docs.python.org/lib/re-syntax.html</a></p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch05.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch05.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch05s03.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 5. Configuration </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Setting up a Pool of One</td></tr></table></div></body></html>
