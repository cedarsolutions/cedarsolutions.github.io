<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>CedarBackup3.config &#8212; Cedar Backup v3  documentation</title>
    
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="top" title="Cedar Backup v3  documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Cedar Backup v3  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for CedarBackup3.config</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: iso-8859-1 -*-</span>
<span class="c1"># vim: set ft=python ts=3 sw=3 expandtab:</span>
<span class="c1"># # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #</span>
<span class="c1">#</span>
<span class="c1">#              C E D A R</span>
<span class="c1">#          S O L U T I O N S       &quot;Software done right.&quot;</span>
<span class="c1">#           S O F T W A R E</span>
<span class="c1">#</span>
<span class="c1"># # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2004-2008,2010,2015 Kenneth J. Pronovici.</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># This program is free software; you can redistribute it and/or</span>
<span class="c1"># modify it under the terms of the GNU General Public License,</span>
<span class="c1"># Version 2, as published by the Free Software Foundation.</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
<span class="c1">#</span>
<span class="c1"># Copies of the GNU General Public License are available from</span>
<span class="c1"># the Free Software Foundation website, http://www.gnu.org/.</span>
<span class="c1">#</span>
<span class="c1"># # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #</span>
<span class="c1">#</span>
<span class="c1"># Author   : Kenneth J. Pronovici &lt;pronovic@ieee.org&gt;</span>
<span class="c1"># Language : Python 3 (&gt;= 3.4)</span>
<span class="c1"># Project  : Cedar Backup, release 3</span>
<span class="c1"># Purpose  : Provides configuration-related objects.</span>
<span class="c1">#</span>
<span class="c1"># # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #</span>

<span class="c1">########################################################################</span>
<span class="c1"># Module documentation</span>
<span class="c1">########################################################################</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Provides configuration-related objects.</span>

<span class="sd">Summary</span>
<span class="sd">=======</span>

<span class="sd">   Cedar Backup stores all of its configuration in an XML document typically</span>
<span class="sd">   called ``cback3.conf``.  The standard location for this document is in</span>
<span class="sd">   ``/etc``, but users can specify a different location if they want to.</span>

<span class="sd">   The ``Config`` class is a Python object representation of a Cedar Backup XML</span>
<span class="sd">   configuration file.  The representation is two-way: XML data can be used to</span>
<span class="sd">   create a ``Config`` object, and then changes to the object can be propogated</span>
<span class="sd">   back to disk.  A ``Config`` object can even be used to create a configuration</span>
<span class="sd">   file from scratch programmatically.</span>

<span class="sd">   The ``Config`` class is intended to be the only Python-language interface to</span>
<span class="sd">   Cedar Backup configuration on disk.  Cedar Backup will use the class as its</span>
<span class="sd">   internal representation of configuration, and applications external to Cedar</span>
<span class="sd">   Backup itself (such as a hypothetical third-party configuration tool written</span>
<span class="sd">   in Python or a third party extension module) should also use the class when</span>
<span class="sd">   they need to read and write configuration files.</span>

<span class="sd">Backwards Compatibility</span>
<span class="sd">=======================</span>

<span class="sd">   The configuration file format has changed between Cedar Backup 1.x and Cedar</span>
<span class="sd">   Backup 2.x.  Any Cedar Backup 1.x configuration file is also a valid Cedar</span>
<span class="sd">   Backup 2.x configuration file.  However, it doesn&#39;t work to go the other</span>
<span class="sd">   direction, as the 2.x configuration files contains additional configuration</span>
<span class="sd">   is not accepted by older versions of the software.</span>

<span class="sd">XML Configuration Structure</span>
<span class="sd">===========================</span>

<span class="sd">   A ``Config`` object can either be created &quot;empty&quot;, or can be created based on</span>
<span class="sd">   XML input (either in the form of a string or read in from a file on disk).</span>
<span class="sd">   Generally speaking, the XML input *must* result in a ``Config`` object which</span>
<span class="sd">   passes the validations laid out below in the *Validation* section.</span>

<span class="sd">   An XML configuration file is composed of seven sections:</span>

<span class="sd">      - *reference*: specifies reference information about the file (author, revision, etc)</span>
<span class="sd">      - *extensions*: specifies mappings to Cedar Backup extensions (external code)</span>
<span class="sd">      - *options*: specifies global configuration options</span>
<span class="sd">      - *peers*: specifies the set of peers in a master&#39;s backup pool</span>
<span class="sd">      - *collect*: specifies configuration related to the collect action</span>
<span class="sd">      - *stage*: specifies configuration related to the stage action</span>
<span class="sd">      - *store*: specifies configuration related to the store action</span>
<span class="sd">      - *purge*: specifies configuration related to the purge action</span>

<span class="sd">   Each section is represented by an class in this module, and then the overall</span>
<span class="sd">   ``Config`` class is a composition of the various other classes.</span>

<span class="sd">   Any configuration section that is missing in the XML document (or has not</span>
<span class="sd">   been filled into an &quot;empty&quot; document) will just be set to ``None`` in the</span>
<span class="sd">   object representation.  The same goes for individual fields within each</span>
<span class="sd">   configuration section.  Keep in mind that the document might not be</span>
<span class="sd">   completely valid if some sections or fields aren&#39;t filled in - but that</span>
<span class="sd">   won&#39;t matter until validation takes place (see the *Validation* section</span>
<span class="sd">   below).</span>

<span class="sd">Unicode vs. String Data</span>
<span class="sd">=======================</span>

<span class="sd">   By default, all string data that comes out of XML documents in Python is</span>
<span class="sd">   unicode data (i.e. ``u&quot;whatever&quot;``).  This is fine for many things, but when</span>
<span class="sd">   it comes to filesystem paths, it can cause us some problems.  We really want</span>
<span class="sd">   strings to be encoded in the filesystem encoding rather than being unicode.</span>
<span class="sd">   So, most elements in configuration which represent filesystem paths are</span>
<span class="sd">   coverted to plain strings using :any:`util.encodePath`.  The main exception is</span>
<span class="sd">   the various ``absoluteExcludePath`` and ``relativeExcludePath`` lists.  These</span>
<span class="sd">   are *not* converted, because they are generally only used for filtering,</span>
<span class="sd">   not for filesystem operations.</span>

<span class="sd">Validation</span>
<span class="sd">==========</span>

<span class="sd">   There are two main levels of validation in the ``Config`` class and its</span>
<span class="sd">   children.  The first is field-level validation.  Field-level validation</span>
<span class="sd">   comes into play when a given field in an object is assigned to or updated.</span>
<span class="sd">   We use Python&#39;s ``property`` functionality to enforce specific validations on</span>
<span class="sd">   field values, and in some places we even use customized list classes to</span>
<span class="sd">   enforce validations on list members.  You should expect to catch a</span>
<span class="sd">   ``ValueError`` exception when making assignments to configuration class</span>
<span class="sd">   fields.</span>

<span class="sd">   The second level of validation is post-completion validation.  Certain</span>
<span class="sd">   validations don&#39;t make sense until a document is fully &quot;complete&quot;.  We don&#39;t</span>
<span class="sd">   want these validations to apply all of the time, because it would make</span>
<span class="sd">   building up a document from scratch a real pain.  For instance, we might</span>
<span class="sd">   have to do things in the right order to keep from throwing exceptions, etc.</span>

<span class="sd">   All of these post-completion validations are encapsulated in the</span>
<span class="sd">   :any:`Config.validate` method.  This method can be called at any time by a</span>
<span class="sd">   client, and will always be called immediately after creating a ``Config``</span>
<span class="sd">   object from XML data and before exporting a ``Config`` object to XML.  This</span>
<span class="sd">   way, we get decent ease-of-use but we also don&#39;t accept or emit invalid</span>
<span class="sd">   configuration files.</span>

<span class="sd">   The :any:`Config.validate` implementation actually takes two passes to</span>
<span class="sd">   completely validate a configuration document.  The first pass at validation</span>
<span class="sd">   is to ensure that the proper sections are filled into the document.  There</span>
<span class="sd">   are default requirements, but the caller has the opportunity to override</span>
<span class="sd">   these defaults.</span>

<span class="sd">   The second pass at validation ensures that any filled-in section contains</span>
<span class="sd">   valid data.  Any section which is not set to ``None`` is validated according</span>
<span class="sd">   to the rules for that section (see below).</span>

<span class="sd">   *Reference Validations*</span>

<span class="sd">   No validations.</span>

<span class="sd">   *Extensions Validations*</span>

<span class="sd">   The list of actions may be either ``None`` or an empty list ``[]`` if desired.</span>
<span class="sd">   Each extended action must include a name, a module and a function.  Then, an</span>
<span class="sd">   extended action must include either an index or dependency information.</span>
<span class="sd">   Which one is required depends on which order mode is configured.</span>

<span class="sd">   *Options Validations*</span>

<span class="sd">   All fields must be filled in except the rsh command.  The rcp and rsh</span>
<span class="sd">   commands are used as default values for all remote peers.  Remote peers can</span>
<span class="sd">   also rely on the backup user as the default remote user name if they choose.</span>

<span class="sd">   *Peers Validations*</span>

<span class="sd">   Local peers must be completely filled in, including both name and collect</span>
<span class="sd">   directory.  Remote peers must also fill in the name and collect directory,</span>
<span class="sd">   but can leave the remote user and rcp command unset.  In this case, the</span>
<span class="sd">   remote user is assumed to match the backup user from the options section and</span>
<span class="sd">   rcp command is taken directly from the options section.</span>

<span class="sd">   *Collect Validations*</span>

<span class="sd">   The target directory must be filled in.  The collect mode, archive mode and</span>
<span class="sd">   ignore file are all optional.  The list of absolute paths to exclude and</span>
<span class="sd">   patterns to exclude may be either ``None`` or an empty list ``[]`` if desired.</span>

<span class="sd">   Each collect directory entry must contain an absolute path to collect, and</span>
<span class="sd">   then must either be able to take collect mode, archive mode and ignore file</span>
<span class="sd">   configuration from the parent ``CollectConfig`` object, or must set each</span>
<span class="sd">   value on its own.  The list of absolute paths to exclude, relative paths to</span>
<span class="sd">   exclude and patterns to exclude may be either ``None`` or an empty list ``[]``</span>
<span class="sd">   if desired.  Any list of absolute paths to exclude or patterns to exclude</span>
<span class="sd">   will be combined with the same list in the ``CollectConfig`` object to make</span>
<span class="sd">   the complete list for a given directory.</span>

<span class="sd">   *Stage Validations*</span>

<span class="sd">   The target directory must be filled in.  There must be at least one peer</span>
<span class="sd">   (remote or local) between the two lists of peers.  A list with no entries</span>
<span class="sd">   can be either ``None`` or an empty list ``[]`` if desired.</span>

<span class="sd">   If a set of peers is provided, this configuration completely overrides</span>
<span class="sd">   configuration in the peers configuration section, and the same validations</span>
<span class="sd">   apply.</span>

<span class="sd">   *Store Validations*</span>

<span class="sd">   The device type and drive speed are optional, and all other values are</span>
<span class="sd">   required (missing booleans will be set to defaults, which is OK).</span>

<span class="sd">   The image writer functionality in the ``writer`` module is supposed to be</span>
<span class="sd">   able to handle a device speed of ``None``.  Any caller which needs a &quot;real&quot;</span>
<span class="sd">   (non-``None``) value for the device type can use ``DEFAULT_DEVICE_TYPE``,</span>
<span class="sd">   which is guaranteed to be sensible.</span>

<span class="sd">   *Purge Validations*</span>

<span class="sd">   The list of purge directories may be either ``None`` or an empty list ``[]``</span>
<span class="sd">   if desired.  All purge directories must contain a path and a retain days</span>
<span class="sd">   value.</span>

<span class="sd">Module Attributes</span>
<span class="sd">=================</span>

<span class="sd">Attributes:</span>
<span class="sd">   DEFAULT_DEVICE_TYPE: The default device type</span>
<span class="sd">   DEFAULT_MEDIA_TYPE: The default media type</span>
<span class="sd">   VALID_DEVICE_TYPES: List of valid device types</span>
<span class="sd">   VALID_MEDIA_TYPES: List of valid media types</span>
<span class="sd">   VALID_COLLECT_MODES: List of valid collect modes</span>
<span class="sd">   VALID_COMPRESS_MODES: List of valid compress modes</span>
<span class="sd">   VALID_ARCHIVE_MODES: List of valid archive modes</span>
<span class="sd">   VALID_ORDER_MODES: List of valid extension order modes</span>

<span class="sd">:author: Kenneth J. Pronovici &lt;pronovic@ieee.org&gt;</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1">########################################################################</span>
<span class="c1"># Imported modules</span>
<span class="c1">########################################################################</span>

<span class="c1"># System modules</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">total_ordering</span>

<span class="c1"># Cedar Backup modules</span>
<span class="kn">from</span> <span class="nn">CedarBackup3.writers.util</span> <span class="k">import</span> <span class="n">validateScsiId</span><span class="p">,</span> <span class="n">validateDriveSpeed</span>
<span class="kn">from</span> <span class="nn">CedarBackup3.util</span> <span class="k">import</span> <span class="n">UnorderedList</span><span class="p">,</span> <span class="n">AbsolutePathList</span><span class="p">,</span> <span class="n">ObjectTypeList</span><span class="p">,</span> <span class="n">parseCommaSeparatedString</span>
<span class="kn">from</span> <span class="nn">CedarBackup3.util</span> <span class="k">import</span> <span class="n">RegexMatchList</span><span class="p">,</span> <span class="n">RegexList</span><span class="p">,</span> <span class="n">encodePath</span><span class="p">,</span> <span class="n">checkUnique</span>
<span class="kn">from</span> <span class="nn">CedarBackup3.util</span> <span class="k">import</span> <span class="n">convertSize</span><span class="p">,</span> <span class="n">displayBytes</span><span class="p">,</span> <span class="n">UNIT_BYTES</span><span class="p">,</span> <span class="n">UNIT_KBYTES</span><span class="p">,</span> <span class="n">UNIT_MBYTES</span><span class="p">,</span> <span class="n">UNIT_GBYTES</span>
<span class="kn">from</span> <span class="nn">CedarBackup3.xmlutil</span> <span class="k">import</span> <span class="n">isElement</span><span class="p">,</span> <span class="n">readChildren</span><span class="p">,</span> <span class="n">readFirstChild</span>
<span class="kn">from</span> <span class="nn">CedarBackup3.xmlutil</span> <span class="k">import</span> <span class="n">readStringList</span><span class="p">,</span> <span class="n">readString</span><span class="p">,</span> <span class="n">readInteger</span><span class="p">,</span> <span class="n">readBoolean</span>
<span class="kn">from</span> <span class="nn">CedarBackup3.xmlutil</span> <span class="k">import</span> <span class="n">addContainerNode</span><span class="p">,</span> <span class="n">addStringNode</span><span class="p">,</span> <span class="n">addIntegerNode</span><span class="p">,</span> <span class="n">addBooleanNode</span>
<span class="kn">from</span> <span class="nn">CedarBackup3.xmlutil</span> <span class="k">import</span> <span class="n">createInputDom</span><span class="p">,</span> <span class="n">createOutputDom</span><span class="p">,</span> <span class="n">serializeDom</span>


<span class="c1">########################################################################</span>
<span class="c1"># Module-wide constants and variables</span>
<span class="c1">########################################################################</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;CedarBackup3.log.config&quot;</span><span class="p">)</span>

<span class="n">DEFAULT_DEVICE_TYPE</span>   <span class="o">=</span> <span class="s2">&quot;cdwriter&quot;</span>
<span class="n">DEFAULT_MEDIA_TYPE</span>    <span class="o">=</span> <span class="s2">&quot;cdrw-74&quot;</span>

<span class="n">VALID_DEVICE_TYPES</span>    <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;cdwriter&quot;</span><span class="p">,</span> <span class="s2">&quot;dvdwriter&quot;</span><span class="p">,</span> <span class="p">]</span>
<span class="n">VALID_CD_MEDIA_TYPES</span>  <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;cdr-74&quot;</span><span class="p">,</span> <span class="s2">&quot;cdrw-74&quot;</span><span class="p">,</span> <span class="s2">&quot;cdr-80&quot;</span><span class="p">,</span> <span class="s2">&quot;cdrw-80&quot;</span><span class="p">,</span> <span class="p">]</span>
<span class="n">VALID_DVD_MEDIA_TYPES</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;dvd+r&quot;</span><span class="p">,</span> <span class="s2">&quot;dvd+rw&quot;</span><span class="p">,</span> <span class="p">]</span>
<span class="n">VALID_MEDIA_TYPES</span>     <span class="o">=</span> <span class="n">VALID_CD_MEDIA_TYPES</span> <span class="o">+</span> <span class="n">VALID_DVD_MEDIA_TYPES</span>
<span class="n">VALID_COLLECT_MODES</span>   <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;daily&quot;</span><span class="p">,</span> <span class="s2">&quot;weekly&quot;</span><span class="p">,</span> <span class="s2">&quot;incr&quot;</span><span class="p">,</span> <span class="p">]</span>
<span class="n">VALID_ARCHIVE_MODES</span>   <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;tar&quot;</span><span class="p">,</span> <span class="s2">&quot;targz&quot;</span><span class="p">,</span> <span class="s2">&quot;tarbz2&quot;</span><span class="p">,</span> <span class="p">]</span>
<span class="n">VALID_COMPRESS_MODES</span>  <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="s2">&quot;gzip&quot;</span><span class="p">,</span> <span class="s2">&quot;bzip2&quot;</span><span class="p">,</span> <span class="p">]</span>
<span class="n">VALID_ORDER_MODES</span>     <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;dependency&quot;</span><span class="p">,</span> <span class="p">]</span>
<span class="n">VALID_BLANK_MODES</span>     <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;daily&quot;</span><span class="p">,</span> <span class="s2">&quot;weekly&quot;</span><span class="p">,</span> <span class="p">]</span>
<span class="n">VALID_BYTE_UNITS</span>      <span class="o">=</span> <span class="p">[</span> <span class="n">UNIT_BYTES</span><span class="p">,</span> <span class="n">UNIT_KBYTES</span><span class="p">,</span> <span class="n">UNIT_MBYTES</span><span class="p">,</span> <span class="n">UNIT_GBYTES</span><span class="p">,</span> <span class="p">]</span>
<span class="n">VALID_FAILURE_MODES</span>   <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="s2">&quot;daily&quot;</span><span class="p">,</span> <span class="s2">&quot;weekly&quot;</span><span class="p">,</span> <span class="p">]</span>

<span class="n">REWRITABLE_MEDIA_TYPES</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;cdrw-74&quot;</span><span class="p">,</span> <span class="s2">&quot;cdrw-80&quot;</span><span class="p">,</span> <span class="s2">&quot;dvd+rw&quot;</span><span class="p">,</span> <span class="p">]</span>

<span class="n">ACTION_NAME_REGEX</span>     <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;^[a-z0-9]*$&quot;</span>


<span class="c1">########################################################################</span>
<span class="c1"># ByteQuantity class definition</span>
<span class="c1">########################################################################</span>

<span class="nd">@total_ordering</span>
<div class="viewcode-block" id="ByteQuantity"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.ByteQuantity">[docs]</a><span class="k">class</span> <span class="nc">ByteQuantity</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Class representing a byte quantity.</span>

<span class="sd">   A byte quantity has both a quantity and a byte-related unit.  Units are</span>
<span class="sd">   maintained using the constants from util.py.  If no units are provided,</span>
<span class="sd">   ``UNIT_BYTES`` is assumed.</span>

<span class="sd">   The quantity is maintained internally as a string so that issues of</span>
<span class="sd">   precision can be avoided.  It really isn&#39;t possible to store a floating</span>
<span class="sd">   point number here while being able to losslessly translate back and forth</span>
<span class="sd">   between XML and object representations.  (Perhaps the Python 2.4 Decimal</span>
<span class="sd">   class would have been an option, but I originally wanted to stay compatible</span>
<span class="sd">   with Python 2.3.)</span>

<span class="sd">   Even though the quantity is maintained as a string, the string must be in a</span>
<span class="sd">   valid floating point positive number.  Technically, any floating point</span>
<span class="sd">   string format supported by Python is allowble.  However, it does not make</span>
<span class="sd">   sense to have a negative quantity of bytes in this context.</span>

<span class="sd">   &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ByteQuantity.__init__"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.ByteQuantity.__init__">[docs]</a>   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quantity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Constructor for the ``ByteQuantity`` class.</span>

<span class="sd">      Args:</span>
<span class="sd">         quantity: Quantity of bytes, something interpretable as a float</span>
<span class="sd">         units: Unit of bytes, one of VALID_BYTE_UNITS</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If one of the values is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_quantity</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_units</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">quantity</span> <span class="o">=</span> <span class="n">quantity</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span></div>

   <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Official string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s2">&quot;ByteQuantity(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quantity</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Informal string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">displayBytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bytes</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Equals operator, implemented in terms of Python 2-style compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Less-than operator, implemented in terms of Python 2-style compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Greater-than operator, implemented in terms of Python 2-style compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Python 2-style comparison operator.</span>
<span class="sd">      Args:</span>
<span class="sd">         other: Other object to compare to</span>
<span class="sd">      Returns:</span>
<span class="sd">          -1/0/1 depending on whether self is ``&lt;``, ``=`` or ``&gt;`` other</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="mi">1</span>
      <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ByteQuantity</span><span class="p">):</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bytes</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">bytes</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bytes</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">bytes</span><span class="p">:</span>
               <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
               <span class="k">return</span> <span class="mi">1</span>
         <span class="k">return</span> <span class="mi">0</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">ByteQuantity</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">UNIT_BYTES</span><span class="p">))</span> <span class="c1"># will fail if other can&#39;t be coverted to float</span>

   <span class="k">def</span> <span class="nf">_setQuantity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the quantity</span>
<span class="sd">      The value must be interpretable as a float if it is not None</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is an empty string</span>
<span class="sd">         ValueError: If the value is not a valid floating point number</span>
<span class="sd">         ValueError: If the value is less than zero</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_quantity</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">floatValue</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># allow integer, float, string, etc.</span>
         <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Quantity must be interpretable as a float&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">floatValue</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Quantity cannot be negative.&quot;</span><span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_quantity</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="c1"># keep around string</span>

   <span class="k">def</span> <span class="nf">_getQuantity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the quantity.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_quantity</span>

   <span class="k">def</span> <span class="nf">_setUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the units value.</span>
<span class="sd">      If not ``None``, the units value must be one of the values in :any:`VALID_BYTE_UNITS`.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not valid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_units</span> <span class="o">=</span> <span class="n">UNIT_BYTES</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">VALID_BYTE_UNITS</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Units value must be one of </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">VALID_BYTE_UNITS</span><span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_units</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the units value.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_units</span>

   <span class="k">def</span> <span class="nf">_getBytes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to return the byte quantity as a floating point number.</span>
<span class="sd">      If there is no quantity set, then a value of 0.0 is returned.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantity</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="n">convertSize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quantity</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="n">UNIT_BYTES</span><span class="p">)</span>
      <span class="k">return</span> <span class="mf">0.0</span>

   <span class="n">quantity</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getQuantity</span><span class="p">,</span> <span class="n">_setQuantity</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Byte quantity, as a string&quot;</span><span class="p">)</span>
   <span class="n">units</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getUnits</span><span class="p">,</span> <span class="n">_setUnits</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Units for byte quantity, for instance UNIT_BYTES&quot;</span><span class="p">)</span>
   <span class="nb">bytes</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getBytes</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Byte quantity, as a floating point number.&quot;</span><span class="p">)</span></div>


<span class="c1">########################################################################</span>
<span class="c1"># ActionDependencies class definition</span>
<span class="c1">########################################################################</span>

<span class="nd">@total_ordering</span>
<div class="viewcode-block" id="ActionDependencies"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.ActionDependencies">[docs]</a><span class="k">class</span> <span class="nc">ActionDependencies</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Class representing dependencies associated with an extended action.</span>

<span class="sd">   Execution ordering for extended actions is done in one of two ways: either by using</span>
<span class="sd">   index values (lower index gets run first) or by having the extended action specify</span>
<span class="sd">   dependencies in terms of other named actions.  This class encapsulates the dependency</span>
<span class="sd">   information for an extended action.</span>

<span class="sd">   The following restrictions exist on data in this class:</span>

<span class="sd">      - Any action name must be a non-empty string matching ``ACTION_NAME_REGEX``</span>

<span class="sd">   &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ActionDependencies.__init__"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.ActionDependencies.__init__">[docs]</a>   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">beforeList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">afterList</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Constructor for the ``ActionDependencies`` class.</span>

<span class="sd">      Args:</span>
<span class="sd">         beforeList: List of named actions that this action must be run before</span>
<span class="sd">         afterList: List of named actions that this action must be run after</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If one of the values is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_beforeList</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_afterList</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">beforeList</span> <span class="o">=</span> <span class="n">beforeList</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">afterList</span> <span class="o">=</span> <span class="n">afterList</span></div>

   <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Official string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s2">&quot;ActionDependencies(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beforeList</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">afterList</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Informal string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

   <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Equals operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Less-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Greater-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Original Python 2 comparison operator.</span>
<span class="sd">      Args:</span>
<span class="sd">         other: Other object to compare to</span>
<span class="sd">      Returns:</span>
<span class="sd">          -1/0/1 depending on whether self is ``&lt;``, ``=`` or ``&gt;`` other</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">beforeList</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">beforeList</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">beforeList</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">beforeList</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">afterList</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">afterList</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">afterList</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">afterList</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">return</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">_setBeforeList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the &quot;run before&quot; list.</span>
<span class="sd">      Either the value must be ``None`` or each element must be a string matching ACTION_NAME_REGEX.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value does not match the regular expression</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_beforeList</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">saved</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beforeList</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_beforeList</span> <span class="o">=</span> <span class="n">RegexMatchList</span><span class="p">(</span><span class="n">ACTION_NAME_REGEX</span><span class="p">,</span> <span class="n">emptyAllowed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;Action name&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_beforeList</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_beforeList</span> <span class="o">=</span> <span class="n">saved</span>
            <span class="k">raise</span> <span class="n">e</span>

   <span class="k">def</span> <span class="nf">_getBeforeList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the &quot;run before&quot; list.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beforeList</span>

   <span class="k">def</span> <span class="nf">_setAfterList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the &quot;run after&quot; list.</span>
<span class="sd">      Either the value must be ``None`` or each element must be a string matching ACTION_NAME_REGEX.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value does not match the regular expression</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_afterList</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">saved</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_afterList</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_afterList</span> <span class="o">=</span> <span class="n">RegexMatchList</span><span class="p">(</span><span class="n">ACTION_NAME_REGEX</span><span class="p">,</span> <span class="n">emptyAllowed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;Action name&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_afterList</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_afterList</span> <span class="o">=</span> <span class="n">saved</span>
            <span class="k">raise</span> <span class="n">e</span>

   <span class="k">def</span> <span class="nf">_getAfterList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the &quot;run after&quot; list.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_afterList</span>

   <span class="n">beforeList</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getBeforeList</span><span class="p">,</span> <span class="n">_setBeforeList</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;List of named actions that this action must be run before.&quot;</span><span class="p">)</span>
   <span class="n">afterList</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getAfterList</span><span class="p">,</span> <span class="n">_setAfterList</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;List of named actions that this action must be run after.&quot;</span><span class="p">)</span></div>


<span class="c1">########################################################################</span>
<span class="c1"># ActionHook class definition</span>
<span class="c1">########################################################################</span>

<span class="nd">@total_ordering</span>
<div class="viewcode-block" id="ActionHook"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.ActionHook">[docs]</a><span class="k">class</span> <span class="nc">ActionHook</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Class representing a hook associated with an action.</span>

<span class="sd">   A hook associated with an action is a shell command to be executed either</span>
<span class="sd">   before or after a named action is executed.</span>

<span class="sd">   The following restrictions exist on data in this class:</span>

<span class="sd">      - The action name must be a non-empty string matching ``ACTION_NAME_REGEX``</span>
<span class="sd">      - The shell command must be a non-empty string.</span>

<span class="sd">   The internal ``before`` and ``after`` instance variables are always set to</span>
<span class="sd">   False in this parent class.</span>

<span class="sd">   &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ActionHook.__init__"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.ActionHook.__init__">[docs]</a>   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Constructor for the ``ActionHook`` class.</span>

<span class="sd">      Args:</span>
<span class="sd">         action: Action this hook is associated with</span>
<span class="sd">         command: Shell command to execute</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If one of the values is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_action</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_command</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_before</span> <span class="o">=</span> <span class="kc">False</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_after</span> <span class="o">=</span> <span class="kc">False</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">action</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span></div>

   <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Official string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s2">&quot;ActionHook(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">action</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">before</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">after</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Informal string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

   <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Equals operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Less-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Greater-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Original Python 2 comparison operator.</span>
<span class="sd">      Args:</span>
<span class="sd">         other: Other object to compare to</span>
<span class="sd">      Returns:</span>
<span class="sd">          -1/0/1 depending on whether self is ``&lt;``, ``=`` or ``&gt;`` other</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">action</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">action</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">command</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">command</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">before</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">before</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">before</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">before</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">after</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">after</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">after</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">after</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">return</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">_setAction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the action name.</span>
<span class="sd">      The value must be a non-empty string if it is not ``None``.</span>
<span class="sd">      It must also consist only of lower-case letters and digits.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is an empty string</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">ACTION_NAME_REGEX</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The action name must be a non-empty string.&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The action name must consist of only lower-case letters and digits.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_action</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getAction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the action name.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_action</span>

   <span class="k">def</span> <span class="nf">_setCommand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the command.</span>
<span class="sd">      The value must be a non-empty string if it is not ``None``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is an empty string</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The command must be a non-empty string.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_command</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getCommand</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the command.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_command</span>

   <span class="k">def</span> <span class="nf">_getBefore</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the before flag.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_before</span>

   <span class="k">def</span> <span class="nf">_getAfter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the after flag.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_after</span>

   <span class="n">action</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getAction</span><span class="p">,</span> <span class="n">_setAction</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Action this hook is associated with.&quot;</span><span class="p">)</span>
   <span class="n">command</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getCommand</span><span class="p">,</span> <span class="n">_setCommand</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Shell command to execute.&quot;</span><span class="p">)</span>
   <span class="n">before</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getBefore</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Indicates whether command should be executed before action.&quot;</span><span class="p">)</span>
   <span class="n">after</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getAfter</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Indicates whether command should be executed after action.&quot;</span><span class="p">)</span></div>

<span class="nd">@total_ordering</span>
<div class="viewcode-block" id="PreActionHook"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.PreActionHook">[docs]</a><span class="k">class</span> <span class="nc">PreActionHook</span><span class="p">(</span><span class="n">ActionHook</span><span class="p">):</span>

   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Class representing a pre-action hook associated with an action.</span>

<span class="sd">   A hook associated with an action is a shell command to be executed either</span>
<span class="sd">   before or after a named action is executed.  In this case, a pre-action hook</span>
<span class="sd">   is executed before the named action.</span>

<span class="sd">   The following restrictions exist on data in this class:</span>

<span class="sd">      - The action name must be a non-empty string consisting of lower-case letters and digits.</span>
<span class="sd">      - The shell command must be a non-empty string.</span>

<span class="sd">   The internal ``before`` instance variable is always set to True in this</span>
<span class="sd">   class.</span>

<span class="sd">   &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PreActionHook.__init__"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.PreActionHook.__init__">[docs]</a>   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Constructor for the ``PreActionHook`` class.</span>

<span class="sd">      Args:</span>
<span class="sd">         action: Action this hook is associated with</span>
<span class="sd">         command: Shell command to execute</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If one of the values is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">ActionHook</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_before</span> <span class="o">=</span> <span class="kc">True</span></div>

   <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Official string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s2">&quot;PreActionHook(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">action</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">before</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">after</span><span class="p">)</span></div>

<span class="nd">@total_ordering</span>
<div class="viewcode-block" id="PostActionHook"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.PostActionHook">[docs]</a><span class="k">class</span> <span class="nc">PostActionHook</span><span class="p">(</span><span class="n">ActionHook</span><span class="p">):</span>

   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Class representing a pre-action hook associated with an action.</span>

<span class="sd">   A hook associated with an action is a shell command to be executed either</span>
<span class="sd">   before or after a named action is executed.  In this case, a post-action hook</span>
<span class="sd">   is executed after the named action.</span>

<span class="sd">   The following restrictions exist on data in this class:</span>

<span class="sd">      - The action name must be a non-empty string consisting of lower-case letters and digits.</span>
<span class="sd">      - The shell command must be a non-empty string.</span>

<span class="sd">   The internal ``before`` instance variable is always set to True in this</span>
<span class="sd">   class.</span>

<span class="sd">   &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PostActionHook.__init__"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.PostActionHook.__init__">[docs]</a>   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Constructor for the ``PostActionHook`` class.</span>

<span class="sd">      Args:</span>
<span class="sd">         action: Action this hook is associated with</span>
<span class="sd">         command: Shell command to execute</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If one of the values is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">ActionHook</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_after</span> <span class="o">=</span> <span class="kc">True</span></div>

   <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Official string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s2">&quot;PostActionHook(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">action</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">before</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">after</span><span class="p">)</span></div>


<span class="c1">########################################################################</span>
<span class="c1"># BlankBehavior class definition</span>
<span class="c1">########################################################################</span>

<span class="nd">@total_ordering</span>
<div class="viewcode-block" id="BlankBehavior"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.BlankBehavior">[docs]</a><span class="k">class</span> <span class="nc">BlankBehavior</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Class representing optimized store-action media blanking behavior.</span>

<span class="sd">   The following restrictions exist on data in this class:</span>

<span class="sd">      - The blanking mode must be a one of the values in ``VALID_BLANK_MODES``</span>
<span class="sd">      - The blanking factor must be a positive floating point number</span>

<span class="sd">   &quot;&quot;&quot;</span>

<div class="viewcode-block" id="BlankBehavior.__init__"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.BlankBehavior.__init__">[docs]</a>   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">blankMode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">blankFactor</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Constructor for the ``BlankBehavior`` class.</span>

<span class="sd">      Args:</span>
<span class="sd">         blankMode: Blanking mode</span>
<span class="sd">         blankFactor: Blanking factor</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If one of the values is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_blankMode</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_blankFactor</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">blankMode</span> <span class="o">=</span> <span class="n">blankMode</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">blankFactor</span> <span class="o">=</span> <span class="n">blankFactor</span></div>

   <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Official string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s2">&quot;BlankBehavior(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">blankMode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">blankFactor</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Informal string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

   <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Equals operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Less-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Greater-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Original Python 2 comparison operator.</span>
<span class="sd">      Args:</span>
<span class="sd">         other: Other object to compare to</span>
<span class="sd">      Returns:</span>
<span class="sd">          -1/0/1 depending on whether self is ``&lt;``, ``=`` or ``&gt;`` other</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">blankMode</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">blankMode</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">blankMode</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">blankMode</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">blankFactor</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">blankFactor</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">blankFactor</span> <span class="ow">or</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">float</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">blankFactor</span> <span class="ow">or</span> <span class="mf">0.0</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">return</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">_setBlankMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the blanking mode.</span>
<span class="sd">      The value must be one of ``VALID_BLANK_MODES``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not valid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">VALID_BLANK_MODES</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Blanking mode must be one of </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">VALID_BLANK_MODES</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_blankMode</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getBlankMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the blanking mode.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blankMode</span>

   <span class="k">def</span> <span class="nf">_setBlankFactor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the blanking factor.</span>
<span class="sd">      The value must be a non-empty string if it is not ``None``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is an empty string</span>
<span class="sd">         ValueError: If the value is not a valid floating point number</span>
<span class="sd">         ValueError: If the value is less than zero</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Blanking factor must be a non-empty string.&quot;</span><span class="p">)</span>
         <span class="n">floatValue</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">floatValue</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Blanking factor cannot be negative.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_blankFactor</span> <span class="o">=</span> <span class="n">value</span> <span class="c1"># keep around string</span>

   <span class="k">def</span> <span class="nf">_getBlankFactor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the blanking factor.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blankFactor</span>

   <span class="n">blankMode</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getBlankMode</span><span class="p">,</span> <span class="n">_setBlankMode</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Blanking mode&quot;</span><span class="p">)</span>
   <span class="n">blankFactor</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getBlankFactor</span><span class="p">,</span> <span class="n">_setBlankFactor</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Blanking factor&quot;</span><span class="p">)</span></div>


<span class="c1">########################################################################</span>
<span class="c1"># ExtendedAction class definition</span>
<span class="c1">########################################################################</span>

<span class="nd">@total_ordering</span>
<div class="viewcode-block" id="ExtendedAction"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.ExtendedAction">[docs]</a><span class="k">class</span> <span class="nc">ExtendedAction</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Class representing an extended action.</span>

<span class="sd">   Essentially, an extended action needs to allow the following to happen::</span>

<span class="sd">      exec(&quot;from %s import %s&quot; % (module, function))</span>
<span class="sd">      exec(&quot;%s(action, configPath&quot;)&quot; % function)</span>

<span class="sd">   The following restrictions exist on data in this class:</span>

<span class="sd">      - The action name must be a non-empty string consisting of lower-case letters and digits.</span>
<span class="sd">      - The module must be a non-empty string and a valid Python identifier.</span>
<span class="sd">      - The function must be an on-empty string and a valid Python identifier.</span>
<span class="sd">      - If set, the index must be a positive integer.</span>
<span class="sd">      - If set, the dependencies attribute must be an ``ActionDependencies`` object.</span>

<span class="sd">   &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ExtendedAction.__init__"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.ExtendedAction.__init__">[docs]</a>   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dependencies</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Constructor for the ``ExtendedAction`` class.</span>

<span class="sd">      Args:</span>
<span class="sd">         name: Name of the extended action</span>
<span class="sd">         module: Name of the module containing the extended action function</span>
<span class="sd">         function: Name of the extended action function</span>
<span class="sd">         index: Index of action, used for execution ordering</span>
<span class="sd">         dependencies: Dependencies for action, used for execution ordering</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If one of the values is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_module</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_function</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_dependencies</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">=</span> <span class="n">module</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">function</span> <span class="o">=</span> <span class="n">function</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">dependencies</span> <span class="o">=</span> <span class="n">dependencies</span></div>

   <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Official string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s2">&quot;ExtendedAction(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependencies</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Informal string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

   <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Equals operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Less-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Greater-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Original Python 2 comparison operator.</span>
<span class="sd">      Args:</span>
<span class="sd">         other: Other object to compare to</span>
<span class="sd">      Returns:</span>
<span class="sd">          -1/0/1 depending on whether self is ``&lt;``, ``=`` or ``&gt;`` other</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">module</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">module</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">function</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">function</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">function</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">int</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">index</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependencies</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">dependencies</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependencies</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">dependencies</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">return</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">_setName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the action name.</span>
<span class="sd">      The value must be a non-empty string if it is not ``None``.</span>
<span class="sd">      It must also consist only of lower-case letters and digits.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is an empty string</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">ACTION_NAME_REGEX</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The action name must be a non-empty string.&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The action name must consist of only lower-case letters and digits.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the action name.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

   <span class="k">def</span> <span class="nf">_setModule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the module name.</span>
<span class="sd">      The value must be a non-empty string if it is not ``None``.</span>
<span class="sd">      It must also be a valid Python identifier.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is an empty string</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^([A-Za-z_][A-Za-z0-9_]*)(\.[A-Za-z_][A-Za-z0-9_]*)*$&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The module name must be a non-empty string.&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The module name must be a valid Python identifier.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_module</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getModule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the module name.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_module</span>

   <span class="k">def</span> <span class="nf">_setFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the function name.</span>
<span class="sd">      The value must be a non-empty string if it is not ``None``.</span>
<span class="sd">      It must also be a valid Python identifier.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is an empty string</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^[A-Za-z_][A-Za-z0-9_]*$&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The function name must be a non-empty string.&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The function name must be a valid Python identifier.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_function</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the function name.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_function</span>

   <span class="k">def</span> <span class="nf">_setIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the action index.</span>
<span class="sd">      The value must be an integer &gt;= 0.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not valid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Action index value must be an integer &gt;= 0.&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Action index value must be an integer &gt;= 0.&quot;</span><span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the action index.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span>

   <span class="k">def</span> <span class="nf">_setDependencies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the action dependencies information.</span>
<span class="sd">      If not ``None``, the value must be a ``ActionDependecies`` object.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not a ``ActionDependencies`` object</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_dependencies</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ActionDependencies</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value must be a ``ActionDependencies`` object.&quot;</span><span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_dependencies</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getDependencies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get action dependencies information.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dependencies</span>

   <span class="n">name</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getName</span><span class="p">,</span> <span class="n">_setName</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Name of the extended action.&quot;</span><span class="p">)</span>
   <span class="n">module</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getModule</span><span class="p">,</span> <span class="n">_setModule</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Name of the module containing the extended action function.&quot;</span><span class="p">)</span>
   <span class="n">function</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getFunction</span><span class="p">,</span> <span class="n">_setFunction</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Name of the extended action function.&quot;</span><span class="p">)</span>
   <span class="n">index</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getIndex</span><span class="p">,</span> <span class="n">_setIndex</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Index of action, used for execution ordering.&quot;</span><span class="p">)</span>
   <span class="n">dependencies</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getDependencies</span><span class="p">,</span> <span class="n">_setDependencies</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Dependencies for action, used for execution ordering.&quot;</span><span class="p">)</span></div>


<span class="c1">########################################################################</span>
<span class="c1"># CommandOverride class definition</span>
<span class="c1">########################################################################</span>

<span class="nd">@total_ordering</span>
<div class="viewcode-block" id="CommandOverride"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.CommandOverride">[docs]</a><span class="k">class</span> <span class="nc">CommandOverride</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Class representing a piece of Cedar Backup command override configuration.</span>

<span class="sd">   The following restrictions exist on data in this class:</span>

<span class="sd">      - The absolute path must be absolute</span>

<span class="sd">   *Note:* Lists within this class are &quot;unordered&quot; for equality comparisons.</span>

<span class="sd">   &quot;&quot;&quot;</span>

<div class="viewcode-block" id="CommandOverride.__init__"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.CommandOverride.__init__">[docs]</a>   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">absolutePath</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Constructor for the ``CommandOverride`` class.</span>

<span class="sd">      Args:</span>
<span class="sd">         command: Name of command to be overridden</span>
<span class="sd">         absolutePath: Absolute path of the overrridden command</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If one of the values is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_command</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_absolutePath</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">absolutePath</span> <span class="o">=</span> <span class="n">absolutePath</span></div>

   <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Official string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s2">&quot;CommandOverride(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">absolutePath</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Informal string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

   <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Equals operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Less-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Greater-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Original Python 2 comparison operator.</span>
<span class="sd">      Args:</span>
<span class="sd">         other: Other object to compare to</span>
<span class="sd">      Returns:</span>
<span class="sd">          -1/0/1 depending on whether self is ``&lt;``, ``=`` or ``&gt;`` other</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">command</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">command</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">absolutePath</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">absolutePath</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">absolutePath</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">absolutePath</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">return</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">_setCommand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the command.</span>
<span class="sd">      The value must be a non-empty string if it is not ``None``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is an empty string</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The command must be a non-empty string.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_command</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getCommand</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the command.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_command</span>

   <span class="k">def</span> <span class="nf">_setAbsolutePath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the absolute path.</span>
<span class="sd">      The value must be an absolute path if it is not ``None``.</span>
<span class="sd">      It does not have to exist on disk at the time of assignment.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not an absolute path</span>
<span class="sd">         ValueError: If the value cannot be encoded properly</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Not an absolute path: [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">value</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_absolutePath</span> <span class="o">=</span> <span class="n">encodePath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">_getAbsolutePath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the absolute path.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_absolutePath</span>

   <span class="n">command</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getCommand</span><span class="p">,</span> <span class="n">_setCommand</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Name of command to be overridden.&quot;</span><span class="p">)</span>
   <span class="n">absolutePath</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getAbsolutePath</span><span class="p">,</span> <span class="n">_setAbsolutePath</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Absolute path of the overrridden command.&quot;</span><span class="p">)</span></div>


<span class="c1">########################################################################</span>
<span class="c1"># CollectFile class definition</span>
<span class="c1">########################################################################</span>

<span class="nd">@total_ordering</span>
<div class="viewcode-block" id="CollectFile"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.CollectFile">[docs]</a><span class="k">class</span> <span class="nc">CollectFile</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Class representing a Cedar Backup collect file.</span>

<span class="sd">   The following restrictions exist on data in this class:</span>

<span class="sd">      - Absolute paths must be absolute</span>
<span class="sd">      - The collect mode must be one of the values in :any:`VALID_COLLECT_MODES`.</span>
<span class="sd">      - The archive mode must be one of the values in :any:`VALID_ARCHIVE_MODES`.</span>

<span class="sd">   &quot;&quot;&quot;</span>

<div class="viewcode-block" id="CollectFile.__init__"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.CollectFile.__init__">[docs]</a>   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">absolutePath</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">collectMode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">archiveMode</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Constructor for the ``CollectFile`` class.</span>

<span class="sd">      Args:</span>
<span class="sd">         absolutePath: Absolute path of the file to collect</span>
<span class="sd">         collectMode: Overridden collect mode for this file</span>
<span class="sd">         archiveMode: Overridden archive mode for this file</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If one of the values is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_absolutePath</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_collectMode</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_archiveMode</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">absolutePath</span> <span class="o">=</span> <span class="n">absolutePath</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">collectMode</span> <span class="o">=</span> <span class="n">collectMode</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">archiveMode</span> <span class="o">=</span> <span class="n">archiveMode</span></div>

   <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Official string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s2">&quot;CollectFile(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">absolutePath</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">collectMode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">archiveMode</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Informal string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

   <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Equals operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Less-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Greater-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Original Python 2 comparison operator.</span>
<span class="sd">      Args:</span>
<span class="sd">         other: Other object to compare to</span>
<span class="sd">      Returns:</span>
<span class="sd">          -1/0/1 depending on whether self is ``&lt;``, ``=`` or ``&gt;`` other</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">absolutePath</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">absolutePath</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">absolutePath</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">absolutePath</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collectMode</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">collectMode</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">collectMode</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">collectMode</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">archiveMode</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">archiveMode</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">archiveMode</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">archiveMode</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">return</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">_setAbsolutePath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the absolute path.</span>
<span class="sd">      The value must be an absolute path if it is not ``None``.</span>
<span class="sd">      It does not have to exist on disk at the time of assignment.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not an absolute path</span>
<span class="sd">         ValueError: If the value cannot be encoded properly</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Not an absolute path: [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">value</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_absolutePath</span> <span class="o">=</span> <span class="n">encodePath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">_getAbsolutePath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the absolute path.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_absolutePath</span>

   <span class="k">def</span> <span class="nf">_setCollectMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the collect mode.</span>
<span class="sd">      If not ``None``, the mode must be one of the values in :any:`VALID_COLLECT_MODES`.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not valid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">VALID_COLLECT_MODES</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Collect mode must be one of </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">VALID_COLLECT_MODES</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_collectMode</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getCollectMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the collect mode.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collectMode</span>

   <span class="k">def</span> <span class="nf">_setArchiveMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the archive mode.</span>
<span class="sd">      If not ``None``, the mode must be one of the values in :any:`VALID_ARCHIVE_MODES`.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not valid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">VALID_ARCHIVE_MODES</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Archive mode must be one of </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">VALID_ARCHIVE_MODES</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_archiveMode</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getArchiveMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the archive mode.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_archiveMode</span>

   <span class="n">absolutePath</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getAbsolutePath</span><span class="p">,</span> <span class="n">_setAbsolutePath</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Absolute path of the file to collect.&quot;</span><span class="p">)</span>
   <span class="n">collectMode</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getCollectMode</span><span class="p">,</span> <span class="n">_setCollectMode</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Overridden collect mode for this file.&quot;</span><span class="p">)</span>
   <span class="n">archiveMode</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getArchiveMode</span><span class="p">,</span> <span class="n">_setArchiveMode</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Overridden archive mode for this file.&quot;</span><span class="p">)</span></div>


<span class="c1">########################################################################</span>
<span class="c1"># CollectDir class definition</span>
<span class="c1">########################################################################</span>

<span class="nd">@total_ordering</span>
<div class="viewcode-block" id="CollectDir"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.CollectDir">[docs]</a><span class="k">class</span> <span class="nc">CollectDir</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Class representing a Cedar Backup collect directory.</span>

<span class="sd">   The following restrictions exist on data in this class:</span>

<span class="sd">      - Absolute paths must be absolute</span>
<span class="sd">      - The collect mode must be one of the values in :any:`VALID_COLLECT_MODES`.</span>
<span class="sd">      - The archive mode must be one of the values in :any:`VALID_ARCHIVE_MODES`.</span>
<span class="sd">      - The ignore file must be a non-empty string.</span>

<span class="sd">   For the ``absoluteExcludePaths`` list, validation is accomplished through the</span>
<span class="sd">   :any:`util.AbsolutePathList` list implementation that overrides common list</span>
<span class="sd">   methods and transparently does the absolute path validation for us.</span>

<span class="sd">   *Note:* Lists within this class are &quot;unordered&quot; for equality comparisons.</span>

<span class="sd">   &quot;&quot;&quot;</span>

<div class="viewcode-block" id="CollectDir.__init__"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.CollectDir.__init__">[docs]</a>   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">absolutePath</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">collectMode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">archiveMode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignoreFile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">absoluteExcludePaths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">relativeExcludePaths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">excludePatterns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">linkDepth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dereference</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">recursionLevel</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Constructor for the ``CollectDir`` class.</span>

<span class="sd">      Args:</span>
<span class="sd">         absolutePath: Absolute path of the directory to collect</span>
<span class="sd">         collectMode: Overridden collect mode for this directory</span>
<span class="sd">         archiveMode: Overridden archive mode for this directory</span>
<span class="sd">         ignoreFile: Overidden ignore file name for this directory</span>
<span class="sd">         linkDepth: Maximum at which soft links should be followed</span>
<span class="sd">         dereference: Whether to dereference links that are followed</span>
<span class="sd">         absoluteExcludePaths: List of absolute paths to exclude</span>
<span class="sd">         relativeExcludePaths: List of relative paths to exclude</span>
<span class="sd">         excludePatterns: List of regular expression patterns to exclude</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If one of the values is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_absolutePath</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_collectMode</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_archiveMode</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_ignoreFile</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_linkDepth</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_dereference</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_recursionLevel</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_absoluteExcludePaths</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_relativeExcludePaths</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_excludePatterns</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">absolutePath</span> <span class="o">=</span> <span class="n">absolutePath</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">collectMode</span> <span class="o">=</span> <span class="n">collectMode</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">archiveMode</span> <span class="o">=</span> <span class="n">archiveMode</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">ignoreFile</span> <span class="o">=</span> <span class="n">ignoreFile</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">linkDepth</span> <span class="o">=</span> <span class="n">linkDepth</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">dereference</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">recursionLevel</span> <span class="o">=</span> <span class="n">recursionLevel</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">absoluteExcludePaths</span> <span class="o">=</span> <span class="n">absoluteExcludePaths</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">relativeExcludePaths</span> <span class="o">=</span> <span class="n">relativeExcludePaths</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">excludePatterns</span> <span class="o">=</span> <span class="n">excludePatterns</span></div>

   <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Official string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s2">&quot;CollectDir(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">absolutePath</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">collectMode</span><span class="p">,</span>
                                                                     <span class="bp">self</span><span class="o">.</span><span class="n">archiveMode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignoreFile</span><span class="p">,</span>
                                                                     <span class="bp">self</span><span class="o">.</span><span class="n">absoluteExcludePaths</span><span class="p">,</span>
                                                                     <span class="bp">self</span><span class="o">.</span><span class="n">relativeExcludePaths</span><span class="p">,</span>
                                                                     <span class="bp">self</span><span class="o">.</span><span class="n">excludePatterns</span><span class="p">,</span>
                                                                     <span class="bp">self</span><span class="o">.</span><span class="n">linkDepth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span><span class="p">,</span>
                                                                     <span class="bp">self</span><span class="o">.</span><span class="n">recursionLevel</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Informal string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

   <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Equals operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Less-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Greater-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Original Python 2 comparison operator.</span>
<span class="sd">      Lists within this class are &quot;unordered&quot; for equality comparisons.</span>
<span class="sd">      Args:</span>
<span class="sd">         other: Other object to compare to</span>
<span class="sd">      Returns:</span>
<span class="sd">          -1/0/1 depending on whether self is ``&lt;``, ``=`` or ``&gt;`` other</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">absolutePath</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">absolutePath</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">absolutePath</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">absolutePath</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collectMode</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">collectMode</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">collectMode</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">collectMode</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">archiveMode</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">archiveMode</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">archiveMode</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">archiveMode</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignoreFile</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">ignoreFile</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ignoreFile</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">ignoreFile</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">linkDepth</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">linkDepth</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linkDepth</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">int</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">linkDepth</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">dereference</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dereference</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">dereference</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursionLevel</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">recursionLevel</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recursionLevel</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">int</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">recursionLevel</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">absoluteExcludePaths</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">absoluteExcludePaths</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">absoluteExcludePaths</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">absoluteExcludePaths</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">relativeExcludePaths</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">relativeExcludePaths</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">relativeExcludePaths</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">relativeExcludePaths</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludePatterns</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">excludePatterns</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludePatterns</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">excludePatterns</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">return</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">_setAbsolutePath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the absolute path.</span>
<span class="sd">      The value must be an absolute path if it is not ``None``.</span>
<span class="sd">      It does not have to exist on disk at the time of assignment.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not an absolute path</span>
<span class="sd">         ValueError: If the value cannot be encoded properly</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Not an absolute path: [</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">value</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_absolutePath</span> <span class="o">=</span> <span class="n">encodePath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">_getAbsolutePath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the absolute path.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_absolutePath</span>

   <span class="k">def</span> <span class="nf">_setCollectMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the collect mode.</span>
<span class="sd">      If not ``None``, the mode must be one of the values in :any:`VALID_COLLECT_MODES`.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not valid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">VALID_COLLECT_MODES</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Collect mode must be one of </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">VALID_COLLECT_MODES</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_collectMode</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getCollectMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the collect mode.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collectMode</span>

   <span class="k">def</span> <span class="nf">_setArchiveMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the archive mode.</span>
<span class="sd">      If not ``None``, the mode must be one of the values in :any:`VALID_ARCHIVE_MODES`.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not valid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">VALID_ARCHIVE_MODES</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Archive mode must be one of </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">VALID_ARCHIVE_MODES</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_archiveMode</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getArchiveMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the archive mode.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_archiveMode</span>

   <span class="k">def</span> <span class="nf">_setIgnoreFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the ignore file.</span>
<span class="sd">      The value must be a non-empty string if it is not ``None``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is an empty string</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The ignore file must be a non-empty string.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_ignoreFile</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getIgnoreFile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the ignore file.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ignoreFile</span>

   <span class="k">def</span> <span class="nf">_setLinkDepth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the link depth.</span>
<span class="sd">      The value must be an integer &gt;= 0.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not valid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_linkDepth</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Link depth value must be an integer &gt;= 0.&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Link depth value must be an integer &gt;= 0.&quot;</span><span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_linkDepth</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getLinkDepth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the action linkDepth.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_linkDepth</span>

   <span class="k">def</span> <span class="nf">_setDereference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the dereference flag.</span>
<span class="sd">      No validations, but we normalize the value to ``True`` or ``False``.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_dereference</span> <span class="o">=</span> <span class="kc">True</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_dereference</span> <span class="o">=</span> <span class="kc">False</span>

   <span class="k">def</span> <span class="nf">_getDereference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the dereference flag.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dereference</span>

   <span class="k">def</span> <span class="nf">_setRecursionLevel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the recursionLevel.</span>
<span class="sd">      The value must be an integer.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not valid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_recursionLevel</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Recusion level value must be an integer.&quot;</span><span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_recursionLevel</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getRecursionLevel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the action recursionLevel.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recursionLevel</span>

   <span class="k">def</span> <span class="nf">_setAbsoluteExcludePaths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the absolute exclude paths list.</span>
<span class="sd">      Either the value must be ``None`` or each element must be an absolute path.</span>
<span class="sd">      Elements do not have to exist on disk at the time of assignment.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not an absolute path</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_absoluteExcludePaths</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">saved</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_absoluteExcludePaths</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_absoluteExcludePaths</span> <span class="o">=</span> <span class="n">AbsolutePathList</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_absoluteExcludePaths</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_absoluteExcludePaths</span> <span class="o">=</span> <span class="n">saved</span>
            <span class="k">raise</span> <span class="n">e</span>

   <span class="k">def</span> <span class="nf">_getAbsoluteExcludePaths</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the absolute exclude paths list.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_absoluteExcludePaths</span>

   <span class="k">def</span> <span class="nf">_setRelativeExcludePaths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the relative exclude paths list.</span>
<span class="sd">      Elements do not have to exist on disk at the time of assignment.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_relativeExcludePaths</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">saved</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_relativeExcludePaths</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_relativeExcludePaths</span> <span class="o">=</span> <span class="n">UnorderedList</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_relativeExcludePaths</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_relativeExcludePaths</span> <span class="o">=</span> <span class="n">saved</span>
            <span class="k">raise</span> <span class="n">e</span>

   <span class="k">def</span> <span class="nf">_getRelativeExcludePaths</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the relative exclude paths list.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_relativeExcludePaths</span>

   <span class="k">def</span> <span class="nf">_setExcludePatterns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the exclude patterns list.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_excludePatterns</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">saved</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_excludePatterns</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_excludePatterns</span> <span class="o">=</span> <span class="n">RegexList</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_excludePatterns</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_excludePatterns</span> <span class="o">=</span> <span class="n">saved</span>
            <span class="k">raise</span> <span class="n">e</span>

   <span class="k">def</span> <span class="nf">_getExcludePatterns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the exclude patterns list.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_excludePatterns</span>

   <span class="n">absolutePath</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getAbsolutePath</span><span class="p">,</span> <span class="n">_setAbsolutePath</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Absolute path of the directory to collect.&quot;</span><span class="p">)</span>
   <span class="n">collectMode</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getCollectMode</span><span class="p">,</span> <span class="n">_setCollectMode</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Overridden collect mode for this directory.&quot;</span><span class="p">)</span>
   <span class="n">archiveMode</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getArchiveMode</span><span class="p">,</span> <span class="n">_setArchiveMode</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Overridden archive mode for this directory.&quot;</span><span class="p">)</span>
   <span class="n">ignoreFile</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getIgnoreFile</span><span class="p">,</span> <span class="n">_setIgnoreFile</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Overridden ignore file name for this directory.&quot;</span><span class="p">)</span>
   <span class="n">linkDepth</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getLinkDepth</span><span class="p">,</span> <span class="n">_setLinkDepth</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Maximum at which soft links should be followed.&quot;</span><span class="p">)</span>
   <span class="n">dereference</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getDereference</span><span class="p">,</span> <span class="n">_setDereference</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Whether to dereference links that are followed.&quot;</span><span class="p">)</span>
   <span class="n">recursionLevel</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getRecursionLevel</span><span class="p">,</span> <span class="n">_setRecursionLevel</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Recursion level to use for recursive directory collection&quot;</span><span class="p">)</span>
   <span class="n">absoluteExcludePaths</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getAbsoluteExcludePaths</span><span class="p">,</span> <span class="n">_setAbsoluteExcludePaths</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;List of absolute paths to exclude.&quot;</span><span class="p">)</span>
   <span class="n">relativeExcludePaths</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getRelativeExcludePaths</span><span class="p">,</span> <span class="n">_setRelativeExcludePaths</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;List of relative paths to exclude.&quot;</span><span class="p">)</span>
   <span class="n">excludePatterns</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getExcludePatterns</span><span class="p">,</span> <span class="n">_setExcludePatterns</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;List of regular expression patterns to exclude.&quot;</span><span class="p">)</span></div>


<span class="c1">########################################################################</span>
<span class="c1"># PurgeDir class definition</span>
<span class="c1">########################################################################</span>

<span class="nd">@total_ordering</span>
<div class="viewcode-block" id="PurgeDir"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.PurgeDir">[docs]</a><span class="k">class</span> <span class="nc">PurgeDir</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Class representing a Cedar Backup purge directory.</span>

<span class="sd">   The following restrictions exist on data in this class:</span>

<span class="sd">      - The absolute path must be an absolute path</span>
<span class="sd">      - The retain days value must be an integer &gt;= 0.</span>

<span class="sd">   &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PurgeDir.__init__"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.PurgeDir.__init__">[docs]</a>   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">absolutePath</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">retainDays</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Constructor for the ``PurgeDir`` class.</span>

<span class="sd">      Args:</span>
<span class="sd">         absolutePath: Absolute path of the directory to be purged</span>
<span class="sd">         retainDays: Number of days content within directory should be retained</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If one of the values is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_absolutePath</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_retainDays</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">absolutePath</span> <span class="o">=</span> <span class="n">absolutePath</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">retainDays</span> <span class="o">=</span> <span class="n">retainDays</span></div>

   <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Official string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s2">&quot;PurgeDir(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">absolutePath</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">retainDays</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Informal string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

   <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Equals operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Less-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Greater-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Original Python 2 comparison operator.</span>
<span class="sd">      Args:</span>
<span class="sd">         other: Other object to compare to</span>
<span class="sd">      Returns:</span>
<span class="sd">          -1/0/1 depending on whether self is ``&lt;``, ``=`` or ``&gt;`` other</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">absolutePath</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">absolutePath</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">absolutePath</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">absolutePath</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">retainDays</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">retainDays</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">retainDays</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">int</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">retainDays</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">return</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">_setAbsolutePath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the absolute path.</span>
<span class="sd">      The value must be an absolute path if it is not ``None``.</span>
<span class="sd">      It does not have to exist on disk at the time of assignment.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not an absolute path</span>
<span class="sd">         ValueError: If the value cannot be encoded properly</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Absolute path must, er, be an absolute path.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_absolutePath</span> <span class="o">=</span> <span class="n">encodePath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">_getAbsolutePath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the absolute path.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_absolutePath</span>

   <span class="k">def</span> <span class="nf">_setRetainDays</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the retain days value.</span>
<span class="sd">      The value must be an integer &gt;= 0.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not valid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_retainDays</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Retain days value must be an integer &gt;= 0.&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Retain days value must be an integer &gt;= 0.&quot;</span><span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_retainDays</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getRetainDays</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the absolute path.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_retainDays</span>

   <span class="n">absolutePath</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getAbsolutePath</span><span class="p">,</span> <span class="n">_setAbsolutePath</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Absolute path of directory to purge.&quot;</span><span class="p">)</span>
   <span class="n">retainDays</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getRetainDays</span><span class="p">,</span> <span class="n">_setRetainDays</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Number of days content within directory should be retained.&quot;</span><span class="p">)</span></div>


<span class="c1">########################################################################</span>
<span class="c1"># LocalPeer class definition</span>
<span class="c1">########################################################################</span>

<span class="nd">@total_ordering</span>
<div class="viewcode-block" id="LocalPeer"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.LocalPeer">[docs]</a><span class="k">class</span> <span class="nc">LocalPeer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Class representing a Cedar Backup peer.</span>

<span class="sd">   The following restrictions exist on data in this class:</span>

<span class="sd">      - The peer name must be a non-empty string.</span>
<span class="sd">      - The collect directory must be an absolute path.</span>
<span class="sd">      - The ignore failure mode must be one of the values in ``VALID_FAILURE_MODES``.</span>

<span class="sd">   &quot;&quot;&quot;</span>

<div class="viewcode-block" id="LocalPeer.__init__"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.LocalPeer.__init__">[docs]</a>   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">collectDir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignoreFailureMode</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Constructor for the ``LocalPeer`` class.</span>

<span class="sd">      Args:</span>
<span class="sd">         name: Name of the peer, typically a valid hostname</span>
<span class="sd">         collectDir: Collect directory to stage files from on peer</span>
<span class="sd">         ignoreFailureMode: Ignore failure mode for peer</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If one of the values is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_collectDir</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_ignoreFailureMode</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">collectDir</span> <span class="o">=</span> <span class="n">collectDir</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">ignoreFailureMode</span> <span class="o">=</span> <span class="n">ignoreFailureMode</span></div>

   <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Official string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s2">&quot;LocalPeer(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">collectDir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignoreFailureMode</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Informal string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

   <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Equals operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Less-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Greater-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Original Python 2 comparison operator.</span>
<span class="sd">      Args:</span>
<span class="sd">         other: Other object to compare to</span>
<span class="sd">      Returns:</span>
<span class="sd">          -1/0/1 depending on whether self is ``&lt;``, ``=`` or ``&gt;`` other</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collectDir</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">collectDir</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">collectDir</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">collectDir</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignoreFailureMode</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">ignoreFailureMode</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ignoreFailureMode</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">ignoreFailureMode</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">return</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">_setName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the peer name.</span>
<span class="sd">      The value must be a non-empty string if it is not ``None``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is an empty string</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The peer name must be a non-empty string.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the peer name.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

   <span class="k">def</span> <span class="nf">_setCollectDir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the collect directory.</span>
<span class="sd">      The value must be an absolute path if it is not ``None``.</span>
<span class="sd">      It does not have to exist on disk at the time of assignment.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not an absolute path</span>
<span class="sd">         ValueError: If the value cannot be encoded properly</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Collect directory must be an absolute path.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_collectDir</span> <span class="o">=</span> <span class="n">encodePath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">_getCollectDir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the collect directory.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collectDir</span>

   <span class="k">def</span> <span class="nf">_setIgnoreFailureMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the ignoreFailure mode.</span>
<span class="sd">      If not ``None``, the mode must be one of the values in ``VALID_FAILURE_MODES``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not valid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">VALID_FAILURE_MODES</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Ignore failure mode must be one of </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">VALID_FAILURE_MODES</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_ignoreFailureMode</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getIgnoreFailureMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the ignoreFailure mode.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ignoreFailureMode</span>

   <span class="n">name</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getName</span><span class="p">,</span> <span class="n">_setName</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Name of the peer, typically a valid hostname.&quot;</span><span class="p">)</span>
   <span class="n">collectDir</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getCollectDir</span><span class="p">,</span> <span class="n">_setCollectDir</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Collect directory to stage files from on peer.&quot;</span><span class="p">)</span>
   <span class="n">ignoreFailureMode</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getIgnoreFailureMode</span><span class="p">,</span> <span class="n">_setIgnoreFailureMode</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Ignore failure mode for peer.&quot;</span><span class="p">)</span></div>


<span class="c1">########################################################################</span>
<span class="c1"># RemotePeer class definition</span>
<span class="c1">########################################################################</span>

<span class="nd">@total_ordering</span>
<div class="viewcode-block" id="RemotePeer"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.RemotePeer">[docs]</a><span class="k">class</span> <span class="nc">RemotePeer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Class representing a Cedar Backup peer.</span>

<span class="sd">   The following restrictions exist on data in this class:</span>

<span class="sd">      - The peer name must be a non-empty string.</span>
<span class="sd">      - The collect directory must be an absolute path.</span>
<span class="sd">      - The remote user must be a non-empty string.</span>
<span class="sd">      - The rcp command must be a non-empty string.</span>
<span class="sd">      - The rsh command must be a non-empty string.</span>
<span class="sd">      - The cback command must be a non-empty string.</span>
<span class="sd">      - Any managed action name must be a non-empty string matching ``ACTION_NAME_REGEX``</span>
<span class="sd">      - The ignore failure mode must be one of the values in ``VALID_FAILURE_MODES``.</span>

<span class="sd">   &quot;&quot;&quot;</span>

<div class="viewcode-block" id="RemotePeer.__init__"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.RemotePeer.__init__">[docs]</a>   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">collectDir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remoteUser</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">rcpCommand</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rshCommand</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cbackCommand</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">managed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">managedActions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignoreFailureMode</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Constructor for the ``RemotePeer`` class.</span>

<span class="sd">      Args:</span>
<span class="sd">         name: Name of the peer, must be a valid hostname</span>
<span class="sd">         collectDir: Collect directory to stage files from on peer</span>
<span class="sd">         remoteUser: Name of backup user on remote peer</span>
<span class="sd">         rcpCommand: Overridden rcp-compatible copy command for peer</span>
<span class="sd">         rshCommand: Overridden rsh-compatible remote shell command for peer</span>
<span class="sd">         cbackCommand: Overridden cback-compatible command to use on remote peer</span>
<span class="sd">         managed: Indicates whether this is a managed peer</span>
<span class="sd">         managedActions: Overridden set of actions that are managed on the peer</span>
<span class="sd">         ignoreFailureMode: Ignore failure mode for peer</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If one of the values is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_collectDir</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_remoteUser</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_rcpCommand</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_rshCommand</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_cbackCommand</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_managed</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_managedActions</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_ignoreFailureMode</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">collectDir</span> <span class="o">=</span> <span class="n">collectDir</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">remoteUser</span> <span class="o">=</span> <span class="n">remoteUser</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">rcpCommand</span> <span class="o">=</span> <span class="n">rcpCommand</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">rshCommand</span> <span class="o">=</span> <span class="n">rshCommand</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">cbackCommand</span> <span class="o">=</span> <span class="n">cbackCommand</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">managed</span> <span class="o">=</span> <span class="n">managed</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">managedActions</span> <span class="o">=</span> <span class="n">managedActions</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">ignoreFailureMode</span> <span class="o">=</span> <span class="n">ignoreFailureMode</span></div>

   <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Official string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s2">&quot;RemotePeer(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">collectDir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">remoteUser</span><span class="p">,</span>
                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">rcpCommand</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rshCommand</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cbackCommand</span><span class="p">,</span>
                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">managed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">managedActions</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignoreFailureMode</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Informal string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

   <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Equals operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Less-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Greater-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Original Python 2 comparison operator.</span>
<span class="sd">      Args:</span>
<span class="sd">         other: Other object to compare to</span>
<span class="sd">      Returns:</span>
<span class="sd">          -1/0/1 depending on whether self is ``&lt;``, ``=`` or ``&gt;`` other</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collectDir</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">collectDir</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">collectDir</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">collectDir</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">remoteUser</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">remoteUser</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">remoteUser</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">remoteUser</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rcpCommand</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">rcpCommand</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rcpCommand</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">rcpCommand</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rshCommand</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">rshCommand</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rshCommand</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">rshCommand</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cbackCommand</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">cbackCommand</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cbackCommand</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">cbackCommand</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">managed</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">managed</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">managed</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">managed</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">managedActions</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">managedActions</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">managedActions</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">managedActions</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignoreFailureMode</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">ignoreFailureMode</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ignoreFailureMode</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">ignoreFailureMode</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">return</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">_setName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the peer name.</span>
<span class="sd">      The value must be a non-empty string if it is not ``None``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is an empty string</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The peer name must be a non-empty string.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the peer name.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

   <span class="k">def</span> <span class="nf">_setCollectDir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the collect directory.</span>
<span class="sd">      The value must be an absolute path if it is not ``None``.</span>
<span class="sd">      It does not have to exist on disk at the time of assignment.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not an absolute path</span>
<span class="sd">         ValueError: If the value cannot be encoded properly</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Collect directory must be an absolute path.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_collectDir</span> <span class="o">=</span> <span class="n">encodePath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">_getCollectDir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the collect directory.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collectDir</span>

   <span class="k">def</span> <span class="nf">_setRemoteUser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the remote user.</span>
<span class="sd">      The value must be a non-empty string if it is not ``None``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is an empty string</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The remote user must be a non-empty string.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_remoteUser</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getRemoteUser</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the remote user.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_remoteUser</span>

   <span class="k">def</span> <span class="nf">_setRcpCommand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the rcp command.</span>
<span class="sd">      The value must be a non-empty string if it is not ``None``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is an empty string</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The rcp command must be a non-empty string.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_rcpCommand</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getRcpCommand</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the rcp command.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rcpCommand</span>

   <span class="k">def</span> <span class="nf">_setRshCommand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the rsh command.</span>
<span class="sd">      The value must be a non-empty string if it is not ``None``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is an empty string</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The rsh command must be a non-empty string.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_rshCommand</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getRshCommand</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the rsh command.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rshCommand</span>

   <span class="k">def</span> <span class="nf">_setCbackCommand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the cback command.</span>
<span class="sd">      The value must be a non-empty string if it is not ``None``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is an empty string</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The cback command must be a non-empty string.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_cbackCommand</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getCbackCommand</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the cback command.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbackCommand</span>

   <span class="k">def</span> <span class="nf">_setManaged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the managed flag.</span>
<span class="sd">      No validations, but we normalize the value to ``True`` or ``False``.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_managed</span> <span class="o">=</span> <span class="kc">True</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_managed</span> <span class="o">=</span> <span class="kc">False</span>

   <span class="k">def</span> <span class="nf">_getManaged</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the managed flag.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_managed</span>

   <span class="k">def</span> <span class="nf">_setManagedActions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the managed actions list.</span>
<span class="sd">      Elements do not have to exist on disk at the time of assignment.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_managedActions</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">saved</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_managedActions</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_managedActions</span> <span class="o">=</span> <span class="n">RegexMatchList</span><span class="p">(</span><span class="n">ACTION_NAME_REGEX</span><span class="p">,</span> <span class="n">emptyAllowed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;Action name&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_managedActions</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_managedActions</span> <span class="o">=</span> <span class="n">saved</span>
            <span class="k">raise</span> <span class="n">e</span>

   <span class="k">def</span> <span class="nf">_getManagedActions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the managed actions list.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_managedActions</span>

   <span class="k">def</span> <span class="nf">_setIgnoreFailureMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the ignoreFailure mode.</span>
<span class="sd">      If not ``None``, the mode must be one of the values in ``VALID_FAILURE_MODES``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not valid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">VALID_FAILURE_MODES</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Ignore failure mode must be one of </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">VALID_FAILURE_MODES</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_ignoreFailureMode</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getIgnoreFailureMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the ignoreFailure mode.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ignoreFailureMode</span>

   <span class="n">name</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getName</span><span class="p">,</span> <span class="n">_setName</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Name of the peer, must be a valid hostname.&quot;</span><span class="p">)</span>
   <span class="n">collectDir</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getCollectDir</span><span class="p">,</span> <span class="n">_setCollectDir</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Collect directory to stage files from on peer.&quot;</span><span class="p">)</span>
   <span class="n">remoteUser</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getRemoteUser</span><span class="p">,</span> <span class="n">_setRemoteUser</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Name of backup user on remote peer.&quot;</span><span class="p">)</span>
   <span class="n">rcpCommand</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getRcpCommand</span><span class="p">,</span> <span class="n">_setRcpCommand</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Overridden rcp-compatible copy command for peer.&quot;</span><span class="p">)</span>
   <span class="n">rshCommand</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getRshCommand</span><span class="p">,</span> <span class="n">_setRshCommand</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Overridden rsh-compatible remote shell command for peer.&quot;</span><span class="p">)</span>
   <span class="n">cbackCommand</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getCbackCommand</span><span class="p">,</span> <span class="n">_setCbackCommand</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Overridden cback-compatible command to use on remote peer.&quot;</span><span class="p">)</span>
   <span class="n">managed</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getManaged</span><span class="p">,</span> <span class="n">_setManaged</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Indicates whether this is a managed peer.&quot;</span><span class="p">)</span>
   <span class="n">managedActions</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getManagedActions</span><span class="p">,</span> <span class="n">_setManagedActions</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Overridden set of actions that are managed on the peer.&quot;</span><span class="p">)</span>
   <span class="n">ignoreFailureMode</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getIgnoreFailureMode</span><span class="p">,</span> <span class="n">_setIgnoreFailureMode</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Ignore failure mode for peer.&quot;</span><span class="p">)</span></div>


<span class="c1">########################################################################</span>
<span class="c1"># ReferenceConfig class definition</span>
<span class="c1">########################################################################</span>

<span class="nd">@total_ordering</span>
<div class="viewcode-block" id="ReferenceConfig"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.ReferenceConfig">[docs]</a><span class="k">class</span> <span class="nc">ReferenceConfig</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Class representing a Cedar Backup reference configuration.</span>

<span class="sd">   The reference information is just used for saving off metadata about</span>
<span class="sd">   configuration and exists mostly for backwards-compatibility with Cedar</span>
<span class="sd">   Backup 1.x.</span>

<span class="sd">   &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ReferenceConfig.__init__"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.ReferenceConfig.__init__">[docs]</a>   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">revision</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">generator</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Constructor for the ``ReferenceConfig`` class.</span>

<span class="sd">      Args:</span>
<span class="sd">         author: Author of the configuration file</span>
<span class="sd">         revision: Revision of the configuration file</span>
<span class="sd">         description: Description of the configuration file</span>
<span class="sd">         generator: Tool that generated the configuration file</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_author</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_revision</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_description</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">author</span> <span class="o">=</span> <span class="n">author</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">revision</span> <span class="o">=</span> <span class="n">revision</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">description</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="n">generator</span></div>

   <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Official string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s2">&quot;ReferenceConfig(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">author</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">revision</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Informal string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

   <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Equals operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Less-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Greater-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Original Python 2 comparison operator.</span>
<span class="sd">      Args:</span>
<span class="sd">         other: Other object to compare to</span>
<span class="sd">      Returns:</span>
<span class="sd">          -1/0/1 depending on whether self is ``&lt;``, ``=`` or ``&gt;`` other</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">author</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">author</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">author</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">author</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">revision</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">revision</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">revision</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">revision</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">description</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">description</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">generator</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">generator</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">return</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">_setAuthor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the author value.</span>
<span class="sd">      No validations.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_author</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getAuthor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the author value.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_author</span>

   <span class="k">def</span> <span class="nf">_setRevision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the revision value.</span>
<span class="sd">      No validations.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_revision</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getRevision</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the revision value.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_revision</span>

   <span class="k">def</span> <span class="nf">_setDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the description value.</span>
<span class="sd">      No validations.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_description</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the description value.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_description</span>

   <span class="k">def</span> <span class="nf">_setGenerator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the generator value.</span>
<span class="sd">      No validations.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getGenerator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the generator value.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span>

   <span class="n">author</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getAuthor</span><span class="p">,</span> <span class="n">_setAuthor</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Author of the configuration file.&quot;</span><span class="p">)</span>
   <span class="n">revision</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getRevision</span><span class="p">,</span> <span class="n">_setRevision</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Revision of the configuration file.&quot;</span><span class="p">)</span>
   <span class="n">description</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getDescription</span><span class="p">,</span> <span class="n">_setDescription</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Description of the configuration file.&quot;</span><span class="p">)</span>
   <span class="n">generator</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getGenerator</span><span class="p">,</span> <span class="n">_setGenerator</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Tool that generated the configuration file.&quot;</span><span class="p">)</span></div>


<span class="c1">########################################################################</span>
<span class="c1"># ExtensionsConfig class definition</span>
<span class="c1">########################################################################</span>

<span class="nd">@total_ordering</span>
<div class="viewcode-block" id="ExtensionsConfig"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.ExtensionsConfig">[docs]</a><span class="k">class</span> <span class="nc">ExtensionsConfig</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Class representing Cedar Backup extensions configuration.</span>

<span class="sd">   Extensions configuration is used to specify &quot;extended actions&quot; implemented</span>
<span class="sd">   by code external to Cedar Backup.  For instance, a hypothetical third party</span>
<span class="sd">   might write extension code to collect database repository data.  If they</span>
<span class="sd">   write a properly-formatted extension function, they can use the extension</span>
<span class="sd">   configuration to map a command-line Cedar Backup action (i.e. &quot;database&quot;)</span>
<span class="sd">   to their function.</span>

<span class="sd">   The following restrictions exist on data in this class:</span>

<span class="sd">      - If set, the order mode must be one of the values in ``VALID_ORDER_MODES``</span>
<span class="sd">      - The actions list must be a list of ``ExtendedAction`` objects.</span>

<span class="sd">   &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ExtensionsConfig.__init__"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.ExtensionsConfig.__init__">[docs]</a>   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">orderMode</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Constructor for the ``ExtensionsConfig`` class.</span>
<span class="sd">      Args:</span>
<span class="sd">         actions: List of extended actions</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_orderMode</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_actions</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">orderMode</span> <span class="o">=</span> <span class="n">orderMode</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">actions</span></div>

   <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Official string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s2">&quot;ExtensionsConfig(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">orderMode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Informal string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

   <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Equals operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Less-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Greater-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Original Python 2 comparison operator.</span>
<span class="sd">      Args:</span>
<span class="sd">         other: Other object to compare to</span>
<span class="sd">      Returns:</span>
<span class="sd">          -1/0/1 depending on whether self is ``&lt;``, ``=`` or ``&gt;`` other</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderMode</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">orderMode</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">orderMode</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">orderMode</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">return</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">_setOrderMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the order mode.</span>
<span class="sd">      The value must be one of :any:`VALID_ORDER_MODES`.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not valid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">VALID_ORDER_MODES</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Order mode must be one of </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">VALID_ORDER_MODES</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_orderMode</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getOrderMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the order mode.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orderMode</span>

   <span class="k">def</span> <span class="nf">_setActions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the actions list.</span>
<span class="sd">      Either the value must be ``None`` or each element must be an ``ExtendedAction``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not a ``ExtendedAction``</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_actions</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">saved</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actions</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_actions</span> <span class="o">=</span> <span class="n">ObjectTypeList</span><span class="p">(</span><span class="n">ExtendedAction</span><span class="p">,</span> <span class="s2">&quot;ExtendedAction&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_actions</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_actions</span> <span class="o">=</span> <span class="n">saved</span>
            <span class="k">raise</span> <span class="n">e</span>

   <span class="k">def</span> <span class="nf">_getActions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the actions list.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actions</span>

   <span class="n">orderMode</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getOrderMode</span><span class="p">,</span> <span class="n">_setOrderMode</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Order mode for extensions, to control execution ordering.&quot;</span><span class="p">)</span>
   <span class="n">actions</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getActions</span><span class="p">,</span> <span class="n">_setActions</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;List of extended actions.&quot;</span><span class="p">)</span></div>


<span class="c1">########################################################################</span>
<span class="c1"># OptionsConfig class definition</span>
<span class="c1">########################################################################</span>

<span class="nd">@total_ordering</span>
<div class="viewcode-block" id="OptionsConfig"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.OptionsConfig">[docs]</a><span class="k">class</span> <span class="nc">OptionsConfig</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Class representing a Cedar Backup global options configuration.</span>

<span class="sd">   The options section is used to store global configuration options and</span>
<span class="sd">   defaults that can be applied to other sections.</span>

<span class="sd">   The following restrictions exist on data in this class:</span>

<span class="sd">      - The working directory must be an absolute path.</span>
<span class="sd">      - The starting day must be a day of the week in English, i.e. ``&quot;monday&quot;``, ``&quot;tuesday&quot;``, etc.</span>
<span class="sd">      - All of the other values must be non-empty strings if they are set to something other than ``None``.</span>
<span class="sd">      - The overrides list must be a list of ``CommandOverride`` objects.</span>
<span class="sd">      - The hooks list must be a list of ``ActionHook`` objects.</span>
<span class="sd">      - The cback command must be a non-empty string.</span>
<span class="sd">      - Any managed action name must be a non-empty string matching ``ACTION_NAME_REGEX``</span>

<span class="sd">   &quot;&quot;&quot;</span>

<div class="viewcode-block" id="OptionsConfig.__init__"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.OptionsConfig.__init__">[docs]</a>   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">startingDay</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">workingDir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">backupUser</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">backupGroup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rcpCommand</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overrides</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">hooks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rshCommand</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cbackCommand</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">managedActions</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Constructor for the ``OptionsConfig`` class.</span>

<span class="sd">      Args:</span>
<span class="sd">         startingDay: Day that starts the week</span>
<span class="sd">         workingDir: Working (temporary) directory to use for backups</span>
<span class="sd">         backupUser: Effective user that backups should run as</span>
<span class="sd">         backupGroup: Effective group that backups should run as</span>
<span class="sd">         rcpCommand: Default rcp-compatible copy command for staging</span>
<span class="sd">         rshCommand: Default rsh-compatible command to use for remote shells</span>
<span class="sd">         cbackCommand: Default cback-compatible command to use on managed remote peers</span>
<span class="sd">         overrides: List of configured command path overrides, if any</span>
<span class="sd">         hooks: List of configured pre- and post-action hooks</span>
<span class="sd">         managedActions: Default set of actions that are managed on remote peers</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If one of the values is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_startingDay</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_workingDir</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_backupUser</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_backupGroup</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_rcpCommand</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_rshCommand</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_cbackCommand</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_overrides</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_managedActions</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">startingDay</span> <span class="o">=</span> <span class="n">startingDay</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">workingDir</span> <span class="o">=</span> <span class="n">workingDir</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">backupUser</span> <span class="o">=</span> <span class="n">backupUser</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">backupGroup</span> <span class="o">=</span> <span class="n">backupGroup</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">rcpCommand</span> <span class="o">=</span> <span class="n">rcpCommand</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">rshCommand</span> <span class="o">=</span> <span class="n">rshCommand</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">cbackCommand</span> <span class="o">=</span> <span class="n">cbackCommand</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">overrides</span> <span class="o">=</span> <span class="n">overrides</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">hooks</span> <span class="o">=</span> <span class="n">hooks</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">managedActions</span> <span class="o">=</span> <span class="n">managedActions</span></div>

   <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Official string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s2">&quot;OptionsConfig(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">startingDay</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">workingDir</span><span class="p">,</span>
                                                                        <span class="bp">self</span><span class="o">.</span><span class="n">backupUser</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">backupGroup</span><span class="p">,</span>
                                                                        <span class="bp">self</span><span class="o">.</span><span class="n">rcpCommand</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">overrides</span><span class="p">,</span>
                                                                        <span class="bp">self</span><span class="o">.</span><span class="n">hooks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rshCommand</span><span class="p">,</span>
                                                                        <span class="bp">self</span><span class="o">.</span><span class="n">cbackCommand</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">managedActions</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Informal string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

   <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Equals operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Less-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Greater-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Original Python 2 comparison operator.</span>
<span class="sd">      Args:</span>
<span class="sd">         other: Other object to compare to</span>
<span class="sd">      Returns:</span>
<span class="sd">          -1/0/1 depending on whether self is ``&lt;``, ``=`` or ``&gt;`` other</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">startingDay</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">startingDay</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">startingDay</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">startingDay</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">workingDir</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">workingDir</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workingDir</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">workingDir</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">backupUser</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">backupUser</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">backupUser</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">backupUser</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">backupGroup</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">backupGroup</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">backupGroup</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">backupGroup</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rcpCommand</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">rcpCommand</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rcpCommand</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">rcpCommand</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rshCommand</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">rshCommand</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rshCommand</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">rshCommand</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cbackCommand</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">cbackCommand</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cbackCommand</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">cbackCommand</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">overrides</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">overrides</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">overrides</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">overrides</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hooks</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">hooks</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hooks</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">hooks</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">managedActions</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">managedActions</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">managedActions</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">managedActions</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">return</span> <span class="mi">0</span>

<div class="viewcode-block" id="OptionsConfig.addOverride"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.OptionsConfig.addOverride">[docs]</a>   <span class="k">def</span> <span class="nf">addOverride</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">absolutePath</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      If no override currently exists for the command, add one.</span>
<span class="sd">      Args:</span>
<span class="sd">         command: Name of command to be overridden</span>
<span class="sd">         absolutePath: Absolute path of the overrridden command</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">override</span> <span class="o">=</span> <span class="n">CommandOverride</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">absolutePath</span><span class="p">)</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">overrides</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">overrides</span> <span class="o">=</span> <span class="p">[</span> <span class="n">override</span><span class="p">,</span> <span class="p">]</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="n">exists</span> <span class="o">=</span> <span class="kc">False</span>
         <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">overrides</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="n">override</span><span class="o">.</span><span class="n">command</span><span class="p">:</span>
               <span class="n">exists</span> <span class="o">=</span> <span class="kc">True</span>
               <span class="k">break</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">overrides</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">override</span><span class="p">)</span></div>

<div class="viewcode-block" id="OptionsConfig.replaceOverride"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.OptionsConfig.replaceOverride">[docs]</a>   <span class="k">def</span> <span class="nf">replaceOverride</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">absolutePath</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      If override currently exists for the command, replace it; otherwise add it.</span>
<span class="sd">      Args:</span>
<span class="sd">         command: Name of command to be overridden</span>
<span class="sd">         absolutePath: Absolute path of the overrridden command</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">override</span> <span class="o">=</span> <span class="n">CommandOverride</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">absolutePath</span><span class="p">)</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">overrides</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">overrides</span> <span class="o">=</span> <span class="p">[</span> <span class="n">override</span><span class="p">,</span> <span class="p">]</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="n">exists</span> <span class="o">=</span> <span class="kc">False</span>
         <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">overrides</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="n">override</span><span class="o">.</span><span class="n">command</span><span class="p">:</span>
               <span class="n">exists</span> <span class="o">=</span> <span class="kc">True</span>
               <span class="n">obj</span><span class="o">.</span><span class="n">absolutePath</span> <span class="o">=</span> <span class="n">override</span><span class="o">.</span><span class="n">absolutePath</span>
               <span class="k">break</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">overrides</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">override</span><span class="p">)</span></div>

   <span class="k">def</span> <span class="nf">_setStartingDay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the starting day.</span>
<span class="sd">      If it is not ``None``, the value must be a valid English day of the week,</span>
<span class="sd">      one of ``&quot;monday&quot;``, ``&quot;tuesday&quot;``, ``&quot;wednesday&quot;``, etc.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not a valid day of the week</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;monday&quot;</span><span class="p">,</span> <span class="s2">&quot;tuesday&quot;</span><span class="p">,</span> <span class="s2">&quot;wednesday&quot;</span><span class="p">,</span> <span class="s2">&quot;thursday&quot;</span><span class="p">,</span> <span class="s2">&quot;friday&quot;</span><span class="p">,</span> <span class="s2">&quot;saturday&quot;</span><span class="p">,</span> <span class="s2">&quot;sunday&quot;</span><span class="p">,</span> <span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Starting day must be an English day of the week, i.e. </span><span class="se">\&quot;</span><span class="s2">monday</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_startingDay</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getStartingDay</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the starting day.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_startingDay</span>

   <span class="k">def</span> <span class="nf">_setWorkingDir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the working directory.</span>
<span class="sd">      The value must be an absolute path if it is not ``None``.</span>
<span class="sd">      It does not have to exist on disk at the time of assignment.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not an absolute path</span>
<span class="sd">         ValueError: If the value cannot be encoded properly</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Working directory must be an absolute path.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_workingDir</span> <span class="o">=</span> <span class="n">encodePath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">_getWorkingDir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the working directory.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_workingDir</span>

   <span class="k">def</span> <span class="nf">_setBackupUser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the backup user.</span>
<span class="sd">      The value must be a non-empty string if it is not ``None``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is an empty string</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Backup user must be a non-empty string.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_backupUser</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getBackupUser</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the backup user.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backupUser</span>

   <span class="k">def</span> <span class="nf">_setBackupGroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the backup group.</span>
<span class="sd">      The value must be a non-empty string if it is not ``None``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is an empty string</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Backup group must be a non-empty string.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_backupGroup</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getBackupGroup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the backup group.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backupGroup</span>

   <span class="k">def</span> <span class="nf">_setRcpCommand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the rcp command.</span>
<span class="sd">      The value must be a non-empty string if it is not ``None``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is an empty string</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The rcp command must be a non-empty string.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_rcpCommand</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getRcpCommand</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the rcp command.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rcpCommand</span>

   <span class="k">def</span> <span class="nf">_setRshCommand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the rsh command.</span>
<span class="sd">      The value must be a non-empty string if it is not ``None``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is an empty string</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The rsh command must be a non-empty string.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_rshCommand</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getRshCommand</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the rsh command.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rshCommand</span>

   <span class="k">def</span> <span class="nf">_setCbackCommand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the cback command.</span>
<span class="sd">      The value must be a non-empty string if it is not ``None``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is an empty string</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The cback command must be a non-empty string.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_cbackCommand</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getCbackCommand</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the cback command.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbackCommand</span>

   <span class="k">def</span> <span class="nf">_setOverrides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the command path overrides list.</span>
<span class="sd">      Either the value must be ``None`` or each element must be a ``CommandOverride``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not a ``CommandOverride``</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_overrides</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">saved</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_overrides</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_overrides</span> <span class="o">=</span> <span class="n">ObjectTypeList</span><span class="p">(</span><span class="n">CommandOverride</span><span class="p">,</span> <span class="s2">&quot;CommandOverride&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_overrides</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_overrides</span> <span class="o">=</span> <span class="n">saved</span>
            <span class="k">raise</span> <span class="n">e</span>

   <span class="k">def</span> <span class="nf">_getOverrides</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the command path overrides list.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_overrides</span>

   <span class="k">def</span> <span class="nf">_setHooks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the pre- and post-action hooks list.</span>
<span class="sd">      Either the value must be ``None`` or each element must be an ``ActionHook``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not a ``CommandOverride``</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">saved</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="n">ObjectTypeList</span><span class="p">(</span><span class="n">ActionHook</span><span class="p">,</span> <span class="s2">&quot;ActionHook&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span> <span class="o">=</span> <span class="n">saved</span>
            <span class="k">raise</span> <span class="n">e</span>

   <span class="k">def</span> <span class="nf">_getHooks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the command path hooks list.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hooks</span>

   <span class="k">def</span> <span class="nf">_setManagedActions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the managed actions list.</span>
<span class="sd">      Elements do not have to exist on disk at the time of assignment.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_managedActions</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">saved</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_managedActions</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_managedActions</span> <span class="o">=</span> <span class="n">RegexMatchList</span><span class="p">(</span><span class="n">ACTION_NAME_REGEX</span><span class="p">,</span> <span class="n">emptyAllowed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;Action name&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_managedActions</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_managedActions</span> <span class="o">=</span> <span class="n">saved</span>
            <span class="k">raise</span> <span class="n">e</span>

   <span class="k">def</span> <span class="nf">_getManagedActions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the managed actions list.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_managedActions</span>

   <span class="n">startingDay</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getStartingDay</span><span class="p">,</span> <span class="n">_setStartingDay</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Day that starts the week.&quot;</span><span class="p">)</span>
   <span class="n">workingDir</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getWorkingDir</span><span class="p">,</span> <span class="n">_setWorkingDir</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Working (temporary) directory to use for backups.&quot;</span><span class="p">)</span>
   <span class="n">backupUser</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getBackupUser</span><span class="p">,</span> <span class="n">_setBackupUser</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Effective user that backups should run as.&quot;</span><span class="p">)</span>
   <span class="n">backupGroup</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getBackupGroup</span><span class="p">,</span> <span class="n">_setBackupGroup</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Effective group that backups should run as.&quot;</span><span class="p">)</span>
   <span class="n">rcpCommand</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getRcpCommand</span><span class="p">,</span> <span class="n">_setRcpCommand</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Default rcp-compatible copy command for staging.&quot;</span><span class="p">)</span>
   <span class="n">rshCommand</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getRshCommand</span><span class="p">,</span> <span class="n">_setRshCommand</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Default rsh-compatible command to use for remote shells.&quot;</span><span class="p">)</span>
   <span class="n">cbackCommand</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getCbackCommand</span><span class="p">,</span> <span class="n">_setCbackCommand</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Default cback-compatible command to use on managed remote peers.&quot;</span><span class="p">)</span>
   <span class="n">overrides</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getOverrides</span><span class="p">,</span> <span class="n">_setOverrides</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;List of configured command path overrides, if any.&quot;</span><span class="p">)</span>
   <span class="n">hooks</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getHooks</span><span class="p">,</span> <span class="n">_setHooks</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;List of configured pre- and post-action hooks.&quot;</span><span class="p">)</span>
   <span class="n">managedActions</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getManagedActions</span><span class="p">,</span> <span class="n">_setManagedActions</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Default set of actions that are managed on remote peers.&quot;</span><span class="p">)</span></div>


<span class="c1">########################################################################</span>
<span class="c1"># PeersConfig class definition</span>
<span class="c1">########################################################################</span>

<span class="nd">@total_ordering</span>
<div class="viewcode-block" id="PeersConfig"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.PeersConfig">[docs]</a><span class="k">class</span> <span class="nc">PeersConfig</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Class representing Cedar Backup global peer configuration.</span>

<span class="sd">   This section contains a list of local and remote peers in a master&#39;s backup</span>
<span class="sd">   pool.  The section is optional.  If a master does not define this section,</span>
<span class="sd">   then all peers are unmanaged, and the stage configuration section must</span>
<span class="sd">   explicitly list any peer that is to be staged.  If this section is</span>
<span class="sd">   configured, then peers may be managed or unmanaged, and the stage section</span>
<span class="sd">   peer configuration (if any) completely overrides this configuration.</span>

<span class="sd">   The following restrictions exist on data in this class:</span>

<span class="sd">      - The list of local peers must contain only ``LocalPeer`` objects</span>
<span class="sd">      - The list of remote peers must contain only ``RemotePeer`` objects</span>

<span class="sd">   *Note:* Lists within this class are &quot;unordered&quot; for equality comparisons.</span>

<span class="sd">   &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PeersConfig.__init__"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.PeersConfig.__init__">[docs]</a>   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">localPeers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remotePeers</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Constructor for the ``PeersConfig`` class.</span>

<span class="sd">      Args:</span>
<span class="sd">         localPeers: List of local peers</span>
<span class="sd">         remotePeers: List of remote peers</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If one of the values is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_localPeers</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_remotePeers</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">localPeers</span> <span class="o">=</span> <span class="n">localPeers</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">remotePeers</span> <span class="o">=</span> <span class="n">remotePeers</span></div>

   <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Official string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s2">&quot;PeersConfig(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">localPeers</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">remotePeers</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Informal string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

   <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Equals operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Less-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Greater-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Original Python 2 comparison operator.</span>
<span class="sd">      Lists within this class are &quot;unordered&quot; for equality comparisons.</span>
<span class="sd">      Args:</span>
<span class="sd">         other: Other object to compare to</span>
<span class="sd">      Returns:</span>
<span class="sd">          -1/0/1 depending on whether self is ``&lt;``, ``=`` or ``&gt;`` other</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">localPeers</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">localPeers</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">localPeers</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">localPeers</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">remotePeers</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">remotePeers</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">remotePeers</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">remotePeers</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">return</span> <span class="mi">0</span>

<div class="viewcode-block" id="PeersConfig.hasPeers"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.PeersConfig.hasPeers">[docs]</a>   <span class="k">def</span> <span class="nf">hasPeers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Indicates whether any peers are filled into this object.</span>
<span class="sd">      Returns:</span>
<span class="sd">          Boolean true if any local or remote peers are filled in, false otherwise</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">localPeers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">localPeers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span>
              <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">remotePeers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">remotePeers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span></div>

   <span class="k">def</span> <span class="nf">_setLocalPeers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the local peers list.</span>
<span class="sd">      Either the value must be ``None`` or each element must be a ``LocalPeer``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not an absolute path</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_localPeers</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">saved</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_localPeers</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_localPeers</span> <span class="o">=</span> <span class="n">ObjectTypeList</span><span class="p">(</span><span class="n">LocalPeer</span><span class="p">,</span> <span class="s2">&quot;LocalPeer&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_localPeers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_localPeers</span> <span class="o">=</span> <span class="n">saved</span>
            <span class="k">raise</span> <span class="n">e</span>

   <span class="k">def</span> <span class="nf">_getLocalPeers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the local peers list.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_localPeers</span>

   <span class="k">def</span> <span class="nf">_setRemotePeers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the remote peers list.</span>
<span class="sd">      Either the value must be ``None`` or each element must be a ``RemotePeer``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not a ``RemotePeer``</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_remotePeers</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">saved</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_remotePeers</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remotePeers</span> <span class="o">=</span> <span class="n">ObjectTypeList</span><span class="p">(</span><span class="n">RemotePeer</span><span class="p">,</span> <span class="s2">&quot;RemotePeer&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remotePeers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remotePeers</span> <span class="o">=</span> <span class="n">saved</span>
            <span class="k">raise</span> <span class="n">e</span>

   <span class="k">def</span> <span class="nf">_getRemotePeers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the remote peers list.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_remotePeers</span>

   <span class="n">localPeers</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getLocalPeers</span><span class="p">,</span> <span class="n">_setLocalPeers</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;List of local peers.&quot;</span><span class="p">)</span>
   <span class="n">remotePeers</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getRemotePeers</span><span class="p">,</span> <span class="n">_setRemotePeers</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;List of remote peers.&quot;</span><span class="p">)</span></div>


<span class="c1">########################################################################</span>
<span class="c1"># CollectConfig class definition</span>
<span class="c1">########################################################################</span>

<span class="nd">@total_ordering</span>
<div class="viewcode-block" id="CollectConfig"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.CollectConfig">[docs]</a><span class="k">class</span> <span class="nc">CollectConfig</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Class representing a Cedar Backup collect configuration.</span>

<span class="sd">   The following restrictions exist on data in this class:</span>

<span class="sd">      - The target directory must be an absolute path.</span>
<span class="sd">      - The collect mode must be one of the values in :any:`VALID_COLLECT_MODES`.</span>
<span class="sd">      - The archive mode must be one of the values in :any:`VALID_ARCHIVE_MODES`.</span>
<span class="sd">      - The ignore file must be a non-empty string.</span>
<span class="sd">      - Each of the paths in ``absoluteExcludePaths`` must be an absolute path</span>
<span class="sd">      - The collect file list must be a list of ``CollectFile`` objects.</span>
<span class="sd">      - The collect directory list must be a list of ``CollectDir`` objects.</span>

<span class="sd">   For the ``absoluteExcludePaths`` list, validation is accomplished through the</span>
<span class="sd">   :any:`util.AbsolutePathList` list implementation that overrides common list</span>
<span class="sd">   methods and transparently does the absolute path validation for us.</span>

<span class="sd">   For the ``collectFiles`` and ``collectDirs`` list, validation is accomplished</span>
<span class="sd">   through the :any:`util.ObjectTypeList` list implementation that overrides common</span>
<span class="sd">   list methods and transparently ensures that each element has an appropriate</span>
<span class="sd">   type.</span>

<span class="sd">   *Note:* Lists within this class are &quot;unordered&quot; for equality comparisons.</span>

<span class="sd">   &quot;&quot;&quot;</span>

<div class="viewcode-block" id="CollectConfig.__init__"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.CollectConfig.__init__">[docs]</a>   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">targetDir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">collectMode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">archiveMode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignoreFile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">absoluteExcludePaths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">excludePatterns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">collectFiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">collectDirs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Constructor for the ``CollectConfig`` class.</span>

<span class="sd">      Args:</span>
<span class="sd">         targetDir: Directory to collect files into</span>
<span class="sd">         collectMode: Default collect mode</span>
<span class="sd">         archiveMode: Default archive mode for collect files</span>
<span class="sd">         ignoreFile: Default ignore file name</span>
<span class="sd">         absoluteExcludePaths: List of absolute paths to exclude</span>
<span class="sd">         excludePatterns: List of regular expression patterns to exclude</span>
<span class="sd">         collectFiles: List of collect files</span>
<span class="sd">         collectDirs: List of collect directories</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If one of the values is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_targetDir</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_collectMode</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_archiveMode</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_ignoreFile</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_absoluteExcludePaths</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_excludePatterns</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_collectFiles</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_collectDirs</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">targetDir</span> <span class="o">=</span> <span class="n">targetDir</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">collectMode</span> <span class="o">=</span> <span class="n">collectMode</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">archiveMode</span> <span class="o">=</span> <span class="n">archiveMode</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">ignoreFile</span> <span class="o">=</span> <span class="n">ignoreFile</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">absoluteExcludePaths</span> <span class="o">=</span> <span class="n">absoluteExcludePaths</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">excludePatterns</span> <span class="o">=</span> <span class="n">excludePatterns</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">collectFiles</span> <span class="o">=</span> <span class="n">collectFiles</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">collectDirs</span> <span class="o">=</span> <span class="n">collectDirs</span></div>

   <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Official string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s2">&quot;CollectConfig(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">targetDir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">collectMode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">archiveMode</span><span class="p">,</span>
                                                                <span class="bp">self</span><span class="o">.</span><span class="n">ignoreFile</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">absoluteExcludePaths</span><span class="p">,</span>
                                                                <span class="bp">self</span><span class="o">.</span><span class="n">excludePatterns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">collectFiles</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">collectDirs</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Informal string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

   <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Equals operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Less-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Greater-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Original Python 2 comparison operator.</span>
<span class="sd">      Lists within this class are &quot;unordered&quot; for equality comparisons.</span>
<span class="sd">      Args:</span>
<span class="sd">         other: Other object to compare to</span>
<span class="sd">      Returns:</span>
<span class="sd">          -1/0/1 depending on whether self is ``&lt;``, ``=`` or ``&gt;`` other</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">targetDir</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">targetDir</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">targetDir</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">targetDir</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collectMode</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">collectMode</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">collectMode</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">collectMode</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">archiveMode</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">archiveMode</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">archiveMode</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">archiveMode</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignoreFile</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">ignoreFile</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ignoreFile</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">ignoreFile</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">absoluteExcludePaths</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">absoluteExcludePaths</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">absoluteExcludePaths</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">absoluteExcludePaths</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludePatterns</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">excludePatterns</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">excludePatterns</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">excludePatterns</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collectFiles</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">collectFiles</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collectFiles</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">collectFiles</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collectDirs</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">collectDirs</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collectDirs</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">collectDirs</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">return</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">_setTargetDir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the target directory.</span>
<span class="sd">      The value must be an absolute path if it is not ``None``.</span>
<span class="sd">      It does not have to exist on disk at the time of assignment.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not an absolute path</span>
<span class="sd">         ValueError: If the value cannot be encoded properly</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Target directory must be an absolute path.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_targetDir</span> <span class="o">=</span> <span class="n">encodePath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">_getTargetDir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the target directory.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_targetDir</span>

   <span class="k">def</span> <span class="nf">_setCollectMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the collect mode.</span>
<span class="sd">      If not ``None``, the mode must be one of :any:`VALID_COLLECT_MODES`.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not valid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">VALID_COLLECT_MODES</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Collect mode must be one of </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">VALID_COLLECT_MODES</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_collectMode</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getCollectMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the collect mode.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collectMode</span>

   <span class="k">def</span> <span class="nf">_setArchiveMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the archive mode.</span>
<span class="sd">      If not ``None``, the mode must be one of :any:`VALID_ARCHIVE_MODES`.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not valid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">VALID_ARCHIVE_MODES</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Archive mode must be one of </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">VALID_ARCHIVE_MODES</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_archiveMode</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getArchiveMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the archive mode.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_archiveMode</span>

   <span class="k">def</span> <span class="nf">_setIgnoreFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the ignore file.</span>
<span class="sd">      The value must be a non-empty string if it is not ``None``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is an empty string</span>
<span class="sd">         ValueError: If the value cannot be encoded properly</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The ignore file must be a non-empty string.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_ignoreFile</span> <span class="o">=</span> <span class="n">encodePath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">_getIgnoreFile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the ignore file.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ignoreFile</span>

   <span class="k">def</span> <span class="nf">_setAbsoluteExcludePaths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the absolute exclude paths list.</span>
<span class="sd">      Either the value must be ``None`` or each element must be an absolute path.</span>
<span class="sd">      Elements do not have to exist on disk at the time of assignment.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not an absolute path</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_absoluteExcludePaths</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">saved</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_absoluteExcludePaths</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_absoluteExcludePaths</span> <span class="o">=</span> <span class="n">AbsolutePathList</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_absoluteExcludePaths</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_absoluteExcludePaths</span> <span class="o">=</span> <span class="n">saved</span>
            <span class="k">raise</span> <span class="n">e</span>

   <span class="k">def</span> <span class="nf">_getAbsoluteExcludePaths</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the absolute exclude paths list.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_absoluteExcludePaths</span>

   <span class="k">def</span> <span class="nf">_setExcludePatterns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the exclude patterns list.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_excludePatterns</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">saved</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_excludePatterns</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_excludePatterns</span> <span class="o">=</span> <span class="n">RegexList</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_excludePatterns</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_excludePatterns</span> <span class="o">=</span> <span class="n">saved</span>
            <span class="k">raise</span> <span class="n">e</span>

   <span class="k">def</span> <span class="nf">_getExcludePatterns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the exclude patterns list.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_excludePatterns</span>

   <span class="k">def</span> <span class="nf">_setCollectFiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the collect files list.</span>
<span class="sd">      Either the value must be ``None`` or each element must be a ``CollectFile``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not a ``CollectFile``</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_collectFiles</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">saved</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collectFiles</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_collectFiles</span> <span class="o">=</span> <span class="n">ObjectTypeList</span><span class="p">(</span><span class="n">CollectFile</span><span class="p">,</span> <span class="s2">&quot;CollectFile&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_collectFiles</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_collectFiles</span> <span class="o">=</span> <span class="n">saved</span>
            <span class="k">raise</span> <span class="n">e</span>

   <span class="k">def</span> <span class="nf">_getCollectFiles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the collect files list.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collectFiles</span>

   <span class="k">def</span> <span class="nf">_setCollectDirs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the collect dirs list.</span>
<span class="sd">      Either the value must be ``None`` or each element must be a ``CollectDir``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not a ``CollectDir``</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_collectDirs</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">saved</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collectDirs</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_collectDirs</span> <span class="o">=</span> <span class="n">ObjectTypeList</span><span class="p">(</span><span class="n">CollectDir</span><span class="p">,</span> <span class="s2">&quot;CollectDir&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_collectDirs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_collectDirs</span> <span class="o">=</span> <span class="n">saved</span>
            <span class="k">raise</span> <span class="n">e</span>

   <span class="k">def</span> <span class="nf">_getCollectDirs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the collect dirs list.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collectDirs</span>

   <span class="n">targetDir</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getTargetDir</span><span class="p">,</span> <span class="n">_setTargetDir</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Directory to collect files into.&quot;</span><span class="p">)</span>
   <span class="n">collectMode</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getCollectMode</span><span class="p">,</span> <span class="n">_setCollectMode</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Default collect mode.&quot;</span><span class="p">)</span>
   <span class="n">archiveMode</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getArchiveMode</span><span class="p">,</span> <span class="n">_setArchiveMode</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Default archive mode for collect files.&quot;</span><span class="p">)</span>
   <span class="n">ignoreFile</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getIgnoreFile</span><span class="p">,</span> <span class="n">_setIgnoreFile</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Default ignore file name.&quot;</span><span class="p">)</span>
   <span class="n">absoluteExcludePaths</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getAbsoluteExcludePaths</span><span class="p">,</span> <span class="n">_setAbsoluteExcludePaths</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;List of absolute paths to exclude.&quot;</span><span class="p">)</span>
   <span class="n">excludePatterns</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getExcludePatterns</span><span class="p">,</span> <span class="n">_setExcludePatterns</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;List of regular expressions patterns to exclude.&quot;</span><span class="p">)</span>
   <span class="n">collectFiles</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getCollectFiles</span><span class="p">,</span> <span class="n">_setCollectFiles</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;List of collect files.&quot;</span><span class="p">)</span>
   <span class="n">collectDirs</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getCollectDirs</span><span class="p">,</span> <span class="n">_setCollectDirs</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;List of collect directories.&quot;</span><span class="p">)</span></div>


<span class="c1">########################################################################</span>
<span class="c1"># StageConfig class definition</span>
<span class="c1">########################################################################</span>

<span class="nd">@total_ordering</span>
<div class="viewcode-block" id="StageConfig"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.StageConfig">[docs]</a><span class="k">class</span> <span class="nc">StageConfig</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Class representing a Cedar Backup stage configuration.</span>

<span class="sd">   The following restrictions exist on data in this class:</span>

<span class="sd">      - The target directory must be an absolute path</span>
<span class="sd">      - The list of local peers must contain only ``LocalPeer`` objects</span>
<span class="sd">      - The list of remote peers must contain only ``RemotePeer`` objects</span>

<span class="sd">   *Note:* Lists within this class are &quot;unordered&quot; for equality comparisons.</span>

<span class="sd">   &quot;&quot;&quot;</span>

<div class="viewcode-block" id="StageConfig.__init__"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.StageConfig.__init__">[docs]</a>   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">targetDir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">localPeers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remotePeers</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Constructor for the ``StageConfig`` class.</span>

<span class="sd">      Args:</span>
<span class="sd">         targetDir: Directory to stage files into, by peer name</span>
<span class="sd">         localPeers: List of local peers</span>
<span class="sd">         remotePeers: List of remote peers</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If one of the values is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_targetDir</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_localPeers</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_remotePeers</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">targetDir</span> <span class="o">=</span> <span class="n">targetDir</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">localPeers</span> <span class="o">=</span> <span class="n">localPeers</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">remotePeers</span> <span class="o">=</span> <span class="n">remotePeers</span></div>

   <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Official string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s2">&quot;StageConfig(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">targetDir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">localPeers</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">remotePeers</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Informal string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

   <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Equals operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Less-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Greater-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Original Python 2 comparison operator.</span>
<span class="sd">      Lists within this class are &quot;unordered&quot; for equality comparisons.</span>
<span class="sd">      Args:</span>
<span class="sd">         other: Other object to compare to</span>
<span class="sd">      Returns:</span>
<span class="sd">          -1/0/1 depending on whether self is ``&lt;``, ``=`` or ``&gt;`` other</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">targetDir</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">targetDir</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">targetDir</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">targetDir</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">localPeers</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">localPeers</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">localPeers</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">localPeers</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">remotePeers</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">remotePeers</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">remotePeers</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">remotePeers</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">return</span> <span class="mi">0</span>

<div class="viewcode-block" id="StageConfig.hasPeers"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.StageConfig.hasPeers">[docs]</a>   <span class="k">def</span> <span class="nf">hasPeers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Indicates whether any peers are filled into this object.</span>
<span class="sd">      Returns:</span>
<span class="sd">          Boolean true if any local or remote peers are filled in, false otherwise</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">localPeers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">localPeers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span>
              <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">remotePeers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">remotePeers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span></div>

   <span class="k">def</span> <span class="nf">_setTargetDir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the target directory.</span>
<span class="sd">      The value must be an absolute path if it is not ``None``.</span>
<span class="sd">      It does not have to exist on disk at the time of assignment.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not an absolute path</span>
<span class="sd">         ValueError: If the value cannot be encoded properly</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Target directory must be an absolute path.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_targetDir</span> <span class="o">=</span> <span class="n">encodePath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">_getTargetDir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the target directory.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_targetDir</span>

   <span class="k">def</span> <span class="nf">_setLocalPeers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the local peers list.</span>
<span class="sd">      Either the value must be ``None`` or each element must be a ``LocalPeer``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not an absolute path</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_localPeers</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">saved</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_localPeers</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_localPeers</span> <span class="o">=</span> <span class="n">ObjectTypeList</span><span class="p">(</span><span class="n">LocalPeer</span><span class="p">,</span> <span class="s2">&quot;LocalPeer&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_localPeers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_localPeers</span> <span class="o">=</span> <span class="n">saved</span>
            <span class="k">raise</span> <span class="n">e</span>

   <span class="k">def</span> <span class="nf">_getLocalPeers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the local peers list.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_localPeers</span>

   <span class="k">def</span> <span class="nf">_setRemotePeers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the remote peers list.</span>
<span class="sd">      Either the value must be ``None`` or each element must be a ``RemotePeer``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not a ``RemotePeer``</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_remotePeers</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">saved</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_remotePeers</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remotePeers</span> <span class="o">=</span> <span class="n">ObjectTypeList</span><span class="p">(</span><span class="n">RemotePeer</span><span class="p">,</span> <span class="s2">&quot;RemotePeer&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remotePeers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remotePeers</span> <span class="o">=</span> <span class="n">saved</span>
            <span class="k">raise</span> <span class="n">e</span>

   <span class="k">def</span> <span class="nf">_getRemotePeers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the remote peers list.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_remotePeers</span>

   <span class="n">targetDir</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getTargetDir</span><span class="p">,</span> <span class="n">_setTargetDir</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Directory to stage files into, by peer name.&quot;</span><span class="p">)</span>
   <span class="n">localPeers</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getLocalPeers</span><span class="p">,</span> <span class="n">_setLocalPeers</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;List of local peers.&quot;</span><span class="p">)</span>
   <span class="n">remotePeers</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getRemotePeers</span><span class="p">,</span> <span class="n">_setRemotePeers</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;List of remote peers.&quot;</span><span class="p">)</span></div>


<span class="c1">########################################################################</span>
<span class="c1"># StoreConfig class definition</span>
<span class="c1">########################################################################</span>

<span class="nd">@total_ordering</span>
<div class="viewcode-block" id="StoreConfig"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.StoreConfig">[docs]</a><span class="k">class</span> <span class="nc">StoreConfig</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Class representing a Cedar Backup store configuration.</span>

<span class="sd">   The following restrictions exist on data in this class:</span>

<span class="sd">      - The source directory must be an absolute path.</span>
<span class="sd">      - The media type must be one of the values in :any:`VALID_MEDIA_TYPES`.</span>
<span class="sd">      - The device type must be one of the values in :any:`VALID_DEVICE_TYPES`.</span>
<span class="sd">      - The device path must be an absolute path.</span>
<span class="sd">      - The SCSI id, if provided, must be in the form specified by :any:`validateScsiId`.</span>
<span class="sd">      - The drive speed must be an integer &gt;= 1</span>
<span class="sd">      - The blanking behavior must be a ``BlankBehavior`` object</span>
<span class="sd">      - The refresh media delay must be an integer &gt;= 0</span>
<span class="sd">      - The eject delay must be an integer &gt;= 0</span>

<span class="sd">   Note that although the blanking factor must be a positive floating point</span>
<span class="sd">   number, it is stored as a string. This is done so that we can losslessly go</span>
<span class="sd">   back and forth between XML and object representations of configuration.</span>

<span class="sd">   &quot;&quot;&quot;</span>

<div class="viewcode-block" id="StoreConfig.__init__"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.StoreConfig.__init__">[docs]</a>   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sourceDir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mediaType</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">deviceType</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">devicePath</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">deviceScsiId</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">driveSpeed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">checkData</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">warnMidnite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">noEject</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">checkMedia</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">blankBehavior</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">refreshMediaDelay</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">ejectDelay</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Constructor for the ``StoreConfig`` class.</span>

<span class="sd">      Args:</span>
<span class="sd">         sourceDir: Directory whose contents should be written to media</span>
<span class="sd">         mediaType: Type of the media (see notes above)</span>
<span class="sd">         deviceType: Type of the device (optional, see notes above)</span>
<span class="sd">         devicePath: Filesystem device name for writer device, i.e. ``/dev/cdrw``</span>
<span class="sd">         deviceScsiId: SCSI id for writer device, i.e. ``[&lt;method&gt;:]scsibus,target,lun``</span>
<span class="sd">         driveSpeed: Speed of the drive, i.e. ``2`` for 2x drive, etc</span>
<span class="sd">         checkData: Whether resulting image should be validated</span>
<span class="sd">         checkMedia: Whether media should be checked before being written to</span>
<span class="sd">         warnMidnite: Whether to generate warnings for crossing midnite</span>
<span class="sd">         noEject: Indicates that the writer device should not be ejected</span>
<span class="sd">         blankBehavior: Controls optimized blanking behavior</span>
<span class="sd">         refreshMediaDelay: Delay, in seconds, to add after refreshing media</span>
<span class="sd">         ejectDelay: Delay, in seconds, to add after ejecting media before closing the tray</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If one of the values is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_sourceDir</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_mediaType</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_deviceType</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_devicePath</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_deviceScsiId</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_driveSpeed</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_checkData</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_checkMedia</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_warnMidnite</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_noEject</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_blankBehavior</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_refreshMediaDelay</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_ejectDelay</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">sourceDir</span> <span class="o">=</span> <span class="n">sourceDir</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">mediaType</span> <span class="o">=</span> <span class="n">mediaType</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">deviceType</span> <span class="o">=</span> <span class="n">deviceType</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">devicePath</span> <span class="o">=</span> <span class="n">devicePath</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">deviceScsiId</span> <span class="o">=</span> <span class="n">deviceScsiId</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">driveSpeed</span> <span class="o">=</span> <span class="n">driveSpeed</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">checkData</span> <span class="o">=</span> <span class="n">checkData</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">checkMedia</span> <span class="o">=</span> <span class="n">checkMedia</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">warnMidnite</span> <span class="o">=</span> <span class="n">warnMidnite</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">noEject</span> <span class="o">=</span> <span class="n">noEject</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">blankBehavior</span> <span class="o">=</span> <span class="n">blankBehavior</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">refreshMediaDelay</span> <span class="o">=</span> <span class="n">refreshMediaDelay</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">ejectDelay</span> <span class="o">=</span> <span class="n">ejectDelay</span></div>

   <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Official string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s2">&quot;StoreConfig(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">sourceDir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mediaType</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">deviceType</span><span class="p">,</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">devicePath</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">deviceScsiId</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">driveSpeed</span><span class="p">,</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">checkData</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">warnMidnite</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">noEject</span><span class="p">,</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">checkMedia</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">blankBehavior</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">refreshMediaDelay</span><span class="p">,</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">ejectDelay</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Informal string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

   <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Equals operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Less-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Greater-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Original Python 2 comparison operator.</span>
<span class="sd">      Args:</span>
<span class="sd">         other: Other object to compare to</span>
<span class="sd">      Returns:</span>
<span class="sd">          -1/0/1 depending on whether self is ``&lt;``, ``=`` or ``&gt;`` other</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sourceDir</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">sourceDir</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sourceDir</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">sourceDir</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mediaType</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">mediaType</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mediaType</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">mediaType</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deviceType</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">deviceType</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deviceType</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">deviceType</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">devicePath</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">devicePath</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">devicePath</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">devicePath</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deviceScsiId</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">deviceScsiId</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deviceScsiId</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">deviceScsiId</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">driveSpeed</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">driveSpeed</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">driveSpeed</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">driveSpeed</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkData</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">checkData</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkData</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">checkData</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkMedia</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">checkMedia</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkMedia</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">checkMedia</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">warnMidnite</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">warnMidnite</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">warnMidnite</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">warnMidnite</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noEject</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">noEject</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noEject</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">noEject</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">blankBehavior</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">blankBehavior</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">blankBehavior</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">blankBehavior</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refreshMediaDelay</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">refreshMediaDelay</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refreshMediaDelay</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">int</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">refreshMediaDelay</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ejectDelay</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">ejectDelay</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ejectDelay</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">int</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">ejectDelay</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">return</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">_setSourceDir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the source directory.</span>
<span class="sd">      The value must be an absolute path if it is not ``None``.</span>
<span class="sd">      It does not have to exist on disk at the time of assignment.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not an absolute path</span>
<span class="sd">         ValueError: If the value cannot be encoded properly</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Source directory must be an absolute path.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_sourceDir</span> <span class="o">=</span> <span class="n">encodePath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">_getSourceDir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the source directory.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sourceDir</span>

   <span class="k">def</span> <span class="nf">_setMediaType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the media type.</span>
<span class="sd">      The value must be one of :any:`VALID_MEDIA_TYPES`.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not valid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">VALID_MEDIA_TYPES</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Media type must be one of </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">VALID_MEDIA_TYPES</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_mediaType</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getMediaType</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the media type.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mediaType</span>

   <span class="k">def</span> <span class="nf">_setDeviceType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the device type.</span>
<span class="sd">      The value must be one of :any:`VALID_DEVICE_TYPES`.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not valid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">VALID_DEVICE_TYPES</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Device type must be one of </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">VALID_DEVICE_TYPES</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_deviceType</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getDeviceType</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the device type.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_deviceType</span>

   <span class="k">def</span> <span class="nf">_setDevicePath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the device path.</span>
<span class="sd">      The value must be an absolute path if it is not ``None``.</span>
<span class="sd">      It does not have to exist on disk at the time of assignment.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not an absolute path</span>
<span class="sd">         ValueError: If the value cannot be encoded properly</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Device path must be an absolute path.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_devicePath</span> <span class="o">=</span> <span class="n">encodePath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">_getDevicePath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the device path.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_devicePath</span>

   <span class="k">def</span> <span class="nf">_setDeviceScsiId</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the SCSI id</span>
<span class="sd">      The SCSI id must be valid per :any:`validateScsiId`.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not valid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_deviceScsiId</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_deviceScsiId</span> <span class="o">=</span> <span class="n">validateScsiId</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">_getDeviceScsiId</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the SCSI id.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_deviceScsiId</span>

   <span class="k">def</span> <span class="nf">_setDriveSpeed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the drive speed.</span>
<span class="sd">      The drive speed must be valid per :any:`validateDriveSpeed`.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not valid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_driveSpeed</span> <span class="o">=</span> <span class="n">validateDriveSpeed</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">_getDriveSpeed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the drive speed.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_driveSpeed</span>

   <span class="k">def</span> <span class="nf">_setCheckData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the check data flag.</span>
<span class="sd">      No validations, but we normalize the value to ``True`` or ``False``.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_checkData</span> <span class="o">=</span> <span class="kc">True</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_checkData</span> <span class="o">=</span> <span class="kc">False</span>

   <span class="k">def</span> <span class="nf">_getCheckData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the check data flag.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkData</span>

   <span class="k">def</span> <span class="nf">_setCheckMedia</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the check media flag.</span>
<span class="sd">      No validations, but we normalize the value to ``True`` or ``False``.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_checkMedia</span> <span class="o">=</span> <span class="kc">True</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_checkMedia</span> <span class="o">=</span> <span class="kc">False</span>

   <span class="k">def</span> <span class="nf">_getCheckMedia</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the check media flag.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkMedia</span>

   <span class="k">def</span> <span class="nf">_setWarnMidnite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the midnite warning flag.</span>
<span class="sd">      No validations, but we normalize the value to ``True`` or ``False``.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_warnMidnite</span> <span class="o">=</span> <span class="kc">True</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_warnMidnite</span> <span class="o">=</span> <span class="kc">False</span>

   <span class="k">def</span> <span class="nf">_getWarnMidnite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the midnite warning flag.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warnMidnite</span>

   <span class="k">def</span> <span class="nf">_setNoEject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the no-eject flag.</span>
<span class="sd">      No validations, but we normalize the value to ``True`` or ``False``.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_noEject</span> <span class="o">=</span> <span class="kc">True</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_noEject</span> <span class="o">=</span> <span class="kc">False</span>

   <span class="k">def</span> <span class="nf">_getNoEject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the no-eject flag.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_noEject</span>

   <span class="k">def</span> <span class="nf">_setBlankBehavior</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set blanking behavior configuration.</span>
<span class="sd">      If not ``None``, the value must be a ``BlankBehavior`` object.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not a ``BlankBehavior``</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_blankBehavior</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">BlankBehavior</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value must be a ``BlankBehavior`` object.&quot;</span><span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_blankBehavior</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getBlankBehavior</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the blanking behavior configuration.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_blankBehavior</span>

   <span class="k">def</span> <span class="nf">_setRefreshMediaDelay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the refreshMediaDelay.</span>
<span class="sd">      The value must be an integer &gt;= 0.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not valid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_refreshMediaDelay</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Action refreshMediaDelay value must be an integer &gt;= 0.&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Action refreshMediaDelay value must be an integer &gt;= 0.&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># normalize this out, since it&#39;s the default</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_refreshMediaDelay</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getRefreshMediaDelay</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the action refreshMediaDelay.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_refreshMediaDelay</span>

   <span class="k">def</span> <span class="nf">_setEjectDelay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the ejectDelay.</span>
<span class="sd">      The value must be an integer &gt;= 0.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not valid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_ejectDelay</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Action ejectDelay value must be an integer &gt;= 0.&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Action ejectDelay value must be an integer &gt;= 0.&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># normalize this out, since it&#39;s the default</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_ejectDelay</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getEjectDelay</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the action ejectDelay.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ejectDelay</span>

   <span class="n">sourceDir</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getSourceDir</span><span class="p">,</span> <span class="n">_setSourceDir</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Directory whose contents should be written to media.&quot;</span><span class="p">)</span>
   <span class="n">mediaType</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getMediaType</span><span class="p">,</span> <span class="n">_setMediaType</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Type of the media (see notes above).&quot;</span><span class="p">)</span>
   <span class="n">deviceType</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getDeviceType</span><span class="p">,</span> <span class="n">_setDeviceType</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Type of the device (optional, see notes above).&quot;</span><span class="p">)</span>
   <span class="n">devicePath</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getDevicePath</span><span class="p">,</span> <span class="n">_setDevicePath</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Filesystem device name for writer device.&quot;</span><span class="p">)</span>
   <span class="n">deviceScsiId</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getDeviceScsiId</span><span class="p">,</span> <span class="n">_setDeviceScsiId</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;SCSI id for writer device (optional, see notes above).&quot;</span><span class="p">)</span>
   <span class="n">driveSpeed</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getDriveSpeed</span><span class="p">,</span> <span class="n">_setDriveSpeed</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Speed of the drive.&quot;</span><span class="p">)</span>
   <span class="n">checkData</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getCheckData</span><span class="p">,</span> <span class="n">_setCheckData</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Whether resulting image should be validated.&quot;</span><span class="p">)</span>
   <span class="n">checkMedia</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getCheckMedia</span><span class="p">,</span> <span class="n">_setCheckMedia</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Whether media should be checked before being written to.&quot;</span><span class="p">)</span>
   <span class="n">warnMidnite</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getWarnMidnite</span><span class="p">,</span> <span class="n">_setWarnMidnite</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Whether to generate warnings for crossing midnite.&quot;</span><span class="p">)</span>
   <span class="n">noEject</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getNoEject</span><span class="p">,</span> <span class="n">_setNoEject</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Indicates that the writer device should not be ejected.&quot;</span><span class="p">)</span>
   <span class="n">blankBehavior</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getBlankBehavior</span><span class="p">,</span> <span class="n">_setBlankBehavior</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Controls optimized blanking behavior.&quot;</span><span class="p">)</span>
   <span class="n">refreshMediaDelay</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getRefreshMediaDelay</span><span class="p">,</span> <span class="n">_setRefreshMediaDelay</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Delay, in seconds, to add after refreshing media.&quot;</span><span class="p">)</span>
   <span class="n">ejectDelay</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getEjectDelay</span><span class="p">,</span> <span class="n">_setEjectDelay</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Delay, in seconds, to add after ejecting media before closing the tray&quot;</span><span class="p">)</span></div>


<span class="c1">########################################################################</span>
<span class="c1"># PurgeConfig class definition</span>
<span class="c1">########################################################################</span>

<span class="nd">@total_ordering</span>
<div class="viewcode-block" id="PurgeConfig"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.PurgeConfig">[docs]</a><span class="k">class</span> <span class="nc">PurgeConfig</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Class representing a Cedar Backup purge configuration.</span>

<span class="sd">   The following restrictions exist on data in this class:</span>

<span class="sd">      - The purge directory list must be a list of ``PurgeDir`` objects.</span>

<span class="sd">   For the ``purgeDirs`` list, validation is accomplished through the</span>
<span class="sd">   :any:`util.ObjectTypeList` list implementation that overrides common list</span>
<span class="sd">   methods and transparently ensures that each element is a ``PurgeDir``.</span>

<span class="sd">   *Note:* Lists within this class are &quot;unordered&quot; for equality comparisons.</span>

<span class="sd">   &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PurgeConfig.__init__"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.PurgeConfig.__init__">[docs]</a>   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">purgeDirs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Constructor for the ``Purge`` class.</span>
<span class="sd">      Args:</span>
<span class="sd">         purgeDirs: List of purge directories</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If one of the values is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_purgeDirs</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">purgeDirs</span> <span class="o">=</span> <span class="n">purgeDirs</span></div>

   <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Official string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s2">&quot;PurgeConfig(</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">purgeDirs</span>

   <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Informal string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

   <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Equals operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Less-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Greater-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Original Python 2 comparison operator.</span>
<span class="sd">      Lists within this class are &quot;unordered&quot; for equality comparisons.</span>
<span class="sd">      Args:</span>
<span class="sd">         other: Other object to compare to</span>
<span class="sd">      Returns:</span>
<span class="sd">          -1/0/1 depending on whether self is ``&lt;``, ``=`` or ``&gt;`` other</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">purgeDirs</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">purgeDirs</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">purgeDirs</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">purgeDirs</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">return</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">_setPurgeDirs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the purge dirs list.</span>
<span class="sd">      Either the value must be ``None`` or each element must be a ``PurgeDir``.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not a ``PurgeDir``</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_purgeDirs</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">try</span><span class="p">:</span>
            <span class="n">saved</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_purgeDirs</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_purgeDirs</span> <span class="o">=</span> <span class="n">ObjectTypeList</span><span class="p">(</span><span class="n">PurgeDir</span><span class="p">,</span> <span class="s2">&quot;PurgeDir&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_purgeDirs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_purgeDirs</span> <span class="o">=</span> <span class="n">saved</span>
            <span class="k">raise</span> <span class="n">e</span>

   <span class="k">def</span> <span class="nf">_getPurgeDirs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the purge dirs list.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_purgeDirs</span>

   <span class="n">purgeDirs</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getPurgeDirs</span><span class="p">,</span> <span class="n">_setPurgeDirs</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;List of directories to purge.&quot;</span><span class="p">)</span></div>


<span class="c1">########################################################################</span>
<span class="c1"># Config class definition</span>
<span class="c1">########################################################################</span>

<span class="nd">@total_ordering</span>
<div class="viewcode-block" id="Config"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.Config">[docs]</a><span class="k">class</span> <span class="nc">Config</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

   <span class="c1">######################</span>
   <span class="c1"># Class documentation</span>
   <span class="c1">######################</span>

   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Class representing a Cedar Backup XML configuration document.</span>

<span class="sd">   The ``Config`` class is a Python object representation of a Cedar Backup XML</span>
<span class="sd">   configuration file.  It is intended to be the only Python-language interface</span>
<span class="sd">   to Cedar Backup configuration on disk for both Cedar Backup itself and for</span>
<span class="sd">   external applications.</span>

<span class="sd">   The object representation is two-way: XML data can be used to create a</span>
<span class="sd">   ``Config`` object, and then changes to the object can be propogated back to</span>
<span class="sd">   disk.  A ``Config`` object can even be used to create a configuration file</span>
<span class="sd">   from scratch programmatically.</span>

<span class="sd">   This class and the classes it is composed from often use Python&#39;s</span>
<span class="sd">   ``property`` construct to validate input and limit access to values.  Some</span>
<span class="sd">   validations can only be done once a document is considered &quot;complete&quot;</span>
<span class="sd">   (see module notes for more details).</span>

<span class="sd">   Assignments to the various instance variables must match the expected</span>
<span class="sd">   type, i.e. ``reference`` must be a ``ReferenceConfig``.  The internal check</span>
<span class="sd">   uses the built-in ``isinstance`` function, so it should be OK to use</span>
<span class="sd">   subclasses if you want to.</span>

<span class="sd">   If an instance variable is not set, its value will be ``None``.  When an</span>
<span class="sd">   object is initialized without using an XML document, all of the values</span>
<span class="sd">   will be ``None``.  Even when an object is initialized using XML, some of</span>
<span class="sd">   the values might be ``None`` because not every section is required.</span>

<span class="sd">   *Note:* Lists within this class are &quot;unordered&quot; for equality comparisons.</span>

<span class="sd">   &quot;&quot;&quot;</span>

   <span class="c1">##############</span>
   <span class="c1"># Constructor</span>
   <span class="c1">##############</span>

<div class="viewcode-block" id="Config.__init__"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.Config.__init__">[docs]</a>   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmlData</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xmlPath</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Initializes a configuration object.</span>

<span class="sd">      If you initialize the object without passing either ``xmlData`` or</span>
<span class="sd">      ``xmlPath``, then configuration will be empty and will be invalid until it</span>
<span class="sd">      is filled in properly.</span>

<span class="sd">      No reference to the original XML data or original path is saved off by</span>
<span class="sd">      this class.  Once the data has been parsed (successfully or not) this</span>
<span class="sd">      original information is discarded.</span>

<span class="sd">      Unless the ``validate`` argument is ``False``, the :any:`Config.validate`</span>
<span class="sd">      method will be called (with its default arguments) against configuration</span>
<span class="sd">      after successfully parsing any passed-in XML.  Keep in mind that even if</span>
<span class="sd">      ``validate`` is ``False``, it might not be possible to parse the passed-in</span>
<span class="sd">      XML document if lower-level validations fail.</span>

<span class="sd">      *Note:* It is strongly suggested that the ``validate`` option always be set</span>
<span class="sd">      to ``True`` (the default) unless there is a specific need to read in</span>
<span class="sd">      invalid configuration from disk.</span>

<span class="sd">      Args:</span>
<span class="sd">         xmlData (String data): XML data representing configuration</span>
<span class="sd">         xmlPath (Absolute path to a file on disk): Path to an XML file on disk</span>
<span class="sd">         validate (Boolean true/false): Validate the document after parsing it</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If both ``xmlData`` and ``xmlPath`` are passed-in</span>
<span class="sd">         ValueError: If the XML data in ``xmlData`` or ``xmlPath`` cannot be parsed</span>
<span class="sd">         ValueError: If the parsed configuration document is not valid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_reference</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_extensions</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_peers</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_collect</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_stage</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_store</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_purge</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">reference</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">peers</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">collect</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">stage</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">store</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">purge</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">if</span> <span class="n">xmlData</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">xmlPath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Use either xmlData or xmlPath, but not both.&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">xmlData</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_parseXmlData</span><span class="p">(</span><span class="n">xmlData</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
      <span class="k">elif</span> <span class="n">xmlPath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">xmlPath</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">xmlData</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_parseXmlData</span><span class="p">(</span><span class="n">xmlData</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span></div>


   <span class="c1">#########################</span>
   <span class="c1"># String representations</span>
   <span class="c1">#########################</span>

   <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Official string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="s2">&quot;Config(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reference</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
                                                         <span class="bp">self</span><span class="o">.</span><span class="n">peers</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="p">,</span>
                                                         <span class="bp">self</span><span class="o">.</span><span class="n">purge</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Informal string representation for class instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>


   <span class="c1">#############################</span>
   <span class="c1"># Standard comparison method</span>
   <span class="c1">#############################</span>

   <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Equals operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Less-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Greater-than operator, implemented in terms of original Python 2 compare operator.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cmp__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

   <span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Original Python 2 comparison operator.</span>
<span class="sd">      Lists within this class are &quot;unordered&quot; for equality comparisons.</span>
<span class="sd">      Args:</span>
<span class="sd">         other: Other object to compare to</span>
<span class="sd">      Returns:</span>
<span class="sd">          -1/0/1 depending on whether self is ``&lt;``, ``=`` or ``&gt;`` other</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">reference</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">reference</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">extensions</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">extensions</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">peers</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">peers</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">peers</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">peers</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">collect</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">collect</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stage</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">stage</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stage</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">stage</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">store</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">store</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">purge</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">purge</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">purge</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">purge</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
      <span class="k">return</span> <span class="mi">0</span>


   <span class="c1">#############</span>
   <span class="c1"># Properties</span>
   <span class="c1">#############</span>

   <span class="k">def</span> <span class="nf">_setReference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the reference configuration value.</span>
<span class="sd">      If not ``None``, the value must be a ``ReferenceConfig`` object.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not a ``ReferenceConfig``</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_reference</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ReferenceConfig</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value must be a ``ReferenceConfig`` object.&quot;</span><span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_reference</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getReference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the reference configuration value.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reference</span>

   <span class="k">def</span> <span class="nf">_setExtensions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the extensions configuration value.</span>
<span class="sd">      If not ``None``, the value must be a ``ExtensionsConfig`` object.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not a ``ExtensionsConfig``</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_extensions</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ExtensionsConfig</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value must be a ``ExtensionsConfig`` object.&quot;</span><span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_extensions</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getExtensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the extensions configuration value.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extensions</span>

   <span class="k">def</span> <span class="nf">_setOptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the options configuration value.</span>
<span class="sd">      If not ``None``, the value must be an ``OptionsConfig`` object.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not a ``OptionsConfig``</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">OptionsConfig</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value must be a ``OptionsConfig`` object.&quot;</span><span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getOptions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the options configuration value.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_options</span>

   <span class="k">def</span> <span class="nf">_setPeers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the peers configuration value.</span>
<span class="sd">      If not ``None``, the value must be an ``PeersConfig`` object.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not a ``PeersConfig``</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_peers</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">PeersConfig</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value must be a ``PeersConfig`` object.&quot;</span><span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_peers</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getPeers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the peers configuration value.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_peers</span>

   <span class="k">def</span> <span class="nf">_setCollect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the collect configuration value.</span>
<span class="sd">      If not ``None``, the value must be a ``CollectConfig`` object.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not a ``CollectConfig``</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_collect</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">CollectConfig</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value must be a ``CollectConfig`` object.&quot;</span><span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_collect</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getCollect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the collect configuration value.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collect</span>

   <span class="k">def</span> <span class="nf">_setStage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the stage configuration value.</span>
<span class="sd">      If not ``None``, the value must be a ``StageConfig`` object.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not a ``StageConfig``</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_stage</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">StageConfig</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value must be a ``StageConfig`` object.&quot;</span><span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_stage</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getStage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the stage configuration value.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stage</span>

   <span class="k">def</span> <span class="nf">_setStore</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the store configuration value.</span>
<span class="sd">      If not ``None``, the value must be a ``StoreConfig`` object.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not a ``StoreConfig``</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_store</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">StoreConfig</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value must be a ``StoreConfig`` object.&quot;</span><span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_store</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getStore</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the store configuration value.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_store</span>

   <span class="k">def</span> <span class="nf">_setPurge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to set the purge configuration value.</span>
<span class="sd">      If not ``None``, the value must be a ``PurgeConfig`` object.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the value is not a ``PurgeConfig``</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_purge</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">PurgeConfig</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value must be a ``PurgeConfig`` object.&quot;</span><span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_purge</span> <span class="o">=</span> <span class="n">value</span>

   <span class="k">def</span> <span class="nf">_getPurge</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Property target used to get the purge configuration value.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_purge</span>

   <span class="n">reference</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getReference</span><span class="p">,</span> <span class="n">_setReference</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Reference configuration in terms of a ``ReferenceConfig`` object.&quot;</span><span class="p">)</span>
   <span class="n">extensions</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getExtensions</span><span class="p">,</span> <span class="n">_setExtensions</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Extensions configuration in terms of a ``ExtensionsConfig`` object.&quot;</span><span class="p">)</span>
   <span class="n">options</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getOptions</span><span class="p">,</span> <span class="n">_setOptions</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Options configuration in terms of a ``OptionsConfig`` object.&quot;</span><span class="p">)</span>
   <span class="n">peers</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getPeers</span><span class="p">,</span> <span class="n">_setPeers</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Peers configuration in terms of a ``PeersConfig`` object.&quot;</span><span class="p">)</span>
   <span class="n">collect</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getCollect</span><span class="p">,</span> <span class="n">_setCollect</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Collect configuration in terms of a ``CollectConfig`` object.&quot;</span><span class="p">)</span>
   <span class="n">stage</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getStage</span><span class="p">,</span> <span class="n">_setStage</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Stage configuration in terms of a ``StageConfig`` object.&quot;</span><span class="p">)</span>
   <span class="n">store</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getStore</span><span class="p">,</span> <span class="n">_setStore</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Store configuration in terms of a ``StoreConfig`` object.&quot;</span><span class="p">)</span>
   <span class="n">purge</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getPurge</span><span class="p">,</span> <span class="n">_setPurge</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Purge configuration in terms of a ``PurgeConfig`` object.&quot;</span><span class="p">)</span>


   <span class="c1">#################</span>
   <span class="c1"># Public methods</span>
   <span class="c1">#################</span>

<div class="viewcode-block" id="Config.extractXml"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.Config.extractXml">[docs]</a>   <span class="k">def</span> <span class="nf">extractXml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmlPath</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Extracts configuration into an XML document.</span>

<span class="sd">      If ``xmlPath`` is not provided, then the XML document will be returned as</span>
<span class="sd">      a string.  If ``xmlPath`` is provided, then the XML document will be written</span>
<span class="sd">      to the file and ``None`` will be returned.</span>

<span class="sd">      Unless the ``validate`` parameter is ``False``, the :any:`Config.validate`</span>
<span class="sd">      method will be called (with its default arguments) against the</span>
<span class="sd">      configuration before extracting the XML.  If configuration is not valid,</span>
<span class="sd">      then an XML document will not be extracted.</span>

<span class="sd">      *Note:* It is strongly suggested that the ``validate`` option always be set</span>
<span class="sd">      to ``True`` (the default) unless there is a specific need to write an</span>
<span class="sd">      invalid configuration file to disk.</span>

<span class="sd">      Args:</span>
<span class="sd">         xmlPath (Absolute path to a file): Path to an XML file to create on disk</span>
<span class="sd">         validate (Boolean true/false): Validate the document before extracting it</span>
<span class="sd">      Returns:</span>
<span class="sd">          XML string data or ``None`` as described above</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If configuration within the object is not valid</span>
<span class="sd">         IOError: If there is an error writing to the file</span>
<span class="sd">         OSError: If there is an error writing to the file</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
      <span class="n">xmlData</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extractXml</span><span class="p">()</span>
      <span class="k">if</span> <span class="n">xmlPath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">xmlPath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xmlData</span><span class="p">)</span>
         <span class="k">return</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="k">return</span> <span class="n">xmlData</span></div>

<div class="viewcode-block" id="Config.validate"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.Config.validate">[docs]</a>   <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">requireOneAction</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">requireReference</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">requireExtensions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">requireOptions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">requireCollect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">requireStage</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">requireStore</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">requirePurge</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">requirePeers</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Validates configuration represented by the object.</span>

<span class="sd">      This method encapsulates all of the validations that should apply to a</span>
<span class="sd">      fully &quot;complete&quot; document but are not already taken care of by earlier</span>
<span class="sd">      validations.  It also provides some extra convenience functionality which</span>
<span class="sd">      might be useful to some people.  The process of validation is laid out in</span>
<span class="sd">      the *Validation* section in the class notes (above).</span>

<span class="sd">      Args:</span>
<span class="sd">         requireOneAction: Require at least one of the collect, stage, store or purge sections</span>
<span class="sd">         requireReference: Require the reference section</span>
<span class="sd">         requireExtensions: Require the extensions section</span>
<span class="sd">         requireOptions: Require the options section</span>
<span class="sd">         requirePeers: Require the peers section</span>
<span class="sd">         requireCollect: Require the collect section</span>
<span class="sd">         requireStage: Require the stage section</span>
<span class="sd">         requireStore: Require the store section</span>
<span class="sd">         requirePurge: Require the purge section</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If one of the validations fails</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">requireOneAction</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">collect</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stage</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">purge</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;At least one of the collect, stage, store and purge sections is required.&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">requireReference</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The reference is section is required.&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">requireExtensions</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The extensions is section is required.&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">requireOptions</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The options is section is required.&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">requirePeers</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">peers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The peers is section is required.&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">requireCollect</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The collect is section is required.&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">requireStage</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stage</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The stage is section is required.&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">requireStore</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The store is section is required.&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">requirePurge</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">purge</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The purge is section is required.&quot;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_validateContents</span><span class="p">()</span></div>


   <span class="c1">#####################################</span>
   <span class="c1"># High-level methods for parsing XML</span>
   <span class="c1">#####################################</span>

   <span class="k">def</span> <span class="nf">_parseXmlData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmlData</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Internal method to parse an XML string into the object.</span>

<span class="sd">      This method parses the XML document into a DOM tree (``xmlDom``) and then</span>
<span class="sd">      calls individual static methods to parse each of the individual</span>
<span class="sd">      configuration sections.</span>

<span class="sd">      Most of the validation we do here has to do with whether the document can</span>
<span class="sd">      be parsed and whether any values which exist are valid.  We don&#39;t do much</span>
<span class="sd">      validation as to whether required elements actually exist unless we have</span>
<span class="sd">      to to make sense of the document (instead, that&#39;s the job of the</span>
<span class="sd">      :any:`validate` method).</span>

<span class="sd">      Args:</span>
<span class="sd">         xmlData (String data): XML data to be parsed</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the XML cannot be successfully parsed</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">)</span> <span class="o">=</span> <span class="n">createInputDom</span><span class="p">(</span><span class="n">xmlData</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_reference</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_parseReference</span><span class="p">(</span><span class="n">parentNode</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_extensions</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_parseExtensions</span><span class="p">(</span><span class="n">parentNode</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_options</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_parseOptions</span><span class="p">(</span><span class="n">parentNode</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_peers</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_parsePeers</span><span class="p">(</span><span class="n">parentNode</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_collect</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_parseCollect</span><span class="p">(</span><span class="n">parentNode</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_stage</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_parseStage</span><span class="p">(</span><span class="n">parentNode</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_store</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_parseStore</span><span class="p">(</span><span class="n">parentNode</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_purge</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_parsePurge</span><span class="p">(</span><span class="n">parentNode</span><span class="p">)</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_parseReference</span><span class="p">(</span><span class="n">parentNode</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Parses a reference configuration section.</span>

<span class="sd">      We read the following fields::</span>

<span class="sd">         author         //cb_config/reference/author</span>
<span class="sd">         revision       //cb_config/reference/revision</span>
<span class="sd">         description    //cb_config/reference/description</span>
<span class="sd">         generator      //cb_config/reference/generator</span>

<span class="sd">      Args:</span>
<span class="sd">         parentNode: Parent node to search beneath</span>

<span class="sd">      Returns:</span>
<span class="sd">          ``ReferenceConfig`` object or ``None`` if the section does not exist</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If some filled-in value is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">reference</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">readFirstChild</span><span class="p">(</span><span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;reference&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">sectionNode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">reference</span> <span class="o">=</span> <span class="n">ReferenceConfig</span><span class="p">()</span>
         <span class="n">reference</span><span class="o">.</span><span class="n">author</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;author&quot;</span><span class="p">)</span>
         <span class="n">reference</span><span class="o">.</span><span class="n">revision</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;revision&quot;</span><span class="p">)</span>
         <span class="n">reference</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">)</span>
         <span class="n">reference</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;generator&quot;</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">reference</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_parseExtensions</span><span class="p">(</span><span class="n">parentNode</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Parses an extensions configuration section.</span>

<span class="sd">      We read the following fields::</span>

<span class="sd">         orderMode            //cb_config/extensions/order_mode</span>

<span class="sd">      We also read groups of the following items, one list element per item::</span>

<span class="sd">         name                 //cb_config/extensions/action/name</span>
<span class="sd">         module               //cb_config/extensions/action/module</span>
<span class="sd">         function             //cb_config/extensions/action/function</span>
<span class="sd">         index                //cb_config/extensions/action/index</span>
<span class="sd">         dependencies         //cb_config/extensions/action/depends</span>

<span class="sd">      The extended actions are parsed by :any:`_parseExtendedActions`.</span>

<span class="sd">      Args:</span>
<span class="sd">         parentNode: Parent node to search beneath</span>

<span class="sd">      Returns:</span>
<span class="sd">          ``ExtensionsConfig`` object or ``None`` if the section does not exist</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If some filled-in value is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">extensions</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">readFirstChild</span><span class="p">(</span><span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;extensions&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">sectionNode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">extensions</span> <span class="o">=</span> <span class="n">ExtensionsConfig</span><span class="p">()</span>
         <span class="n">extensions</span><span class="o">.</span><span class="n">orderMode</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;order_mode&quot;</span><span class="p">)</span>
         <span class="n">extensions</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_parseExtendedActions</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">extensions</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_parseOptions</span><span class="p">(</span><span class="n">parentNode</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Parses a options configuration section.</span>

<span class="sd">      We read the following fields::</span>

<span class="sd">         startingDay    //cb_config/options/starting_day</span>
<span class="sd">         workingDir     //cb_config/options/working_dir</span>
<span class="sd">         backupUser     //cb_config/options/backup_user</span>
<span class="sd">         backupGroup    //cb_config/options/backup_group</span>
<span class="sd">         rcpCommand     //cb_config/options/rcp_command</span>
<span class="sd">         rshCommand     //cb_config/options/rsh_command</span>
<span class="sd">         cbackCommand   //cb_config/options/cback_command</span>
<span class="sd">         managedActions //cb_config/options/managed_actions</span>

<span class="sd">      The list of managed actions is a comma-separated list of action names.</span>

<span class="sd">      We also read groups of the following items, one list element per</span>
<span class="sd">      item::</span>

<span class="sd">         overrides      //cb_config/options/override</span>
<span class="sd">         hooks          //cb_config/options/hook</span>

<span class="sd">      The overrides are parsed by :any:`_parseOverrides` and the hooks are parsed</span>
<span class="sd">      by :any:`_parseHooks`.</span>

<span class="sd">      Args:</span>
<span class="sd">         parentNode: Parent node to search beneath</span>

<span class="sd">      Returns:</span>
<span class="sd">          ``OptionsConfig`` object or ``None`` if the section does not exist</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If some filled-in value is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">options</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">readFirstChild</span><span class="p">(</span><span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;options&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">sectionNode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">options</span> <span class="o">=</span> <span class="n">OptionsConfig</span><span class="p">()</span>
         <span class="n">options</span><span class="o">.</span><span class="n">startingDay</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;starting_day&quot;</span><span class="p">)</span>
         <span class="n">options</span><span class="o">.</span><span class="n">workingDir</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;working_dir&quot;</span><span class="p">)</span>
         <span class="n">options</span><span class="o">.</span><span class="n">backupUser</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;backup_user&quot;</span><span class="p">)</span>
         <span class="n">options</span><span class="o">.</span><span class="n">backupGroup</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;backup_group&quot;</span><span class="p">)</span>
         <span class="n">options</span><span class="o">.</span><span class="n">rcpCommand</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;rcp_command&quot;</span><span class="p">)</span>
         <span class="n">options</span><span class="o">.</span><span class="n">rshCommand</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;rsh_command&quot;</span><span class="p">)</span>
         <span class="n">options</span><span class="o">.</span><span class="n">cbackCommand</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;cback_command&quot;</span><span class="p">)</span>
         <span class="n">options</span><span class="o">.</span><span class="n">overrides</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_parseOverrides</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">)</span>
         <span class="n">options</span><span class="o">.</span><span class="n">hooks</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_parseHooks</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">)</span>
         <span class="n">managedActions</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;managed_actions&quot;</span><span class="p">)</span>
         <span class="n">options</span><span class="o">.</span><span class="n">managedActions</span> <span class="o">=</span> <span class="n">parseCommaSeparatedString</span><span class="p">(</span><span class="n">managedActions</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">options</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_parsePeers</span><span class="p">(</span><span class="n">parentNode</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Parses a peers configuration section.</span>

<span class="sd">      We read groups of the following items, one list element per</span>
<span class="sd">      item::</span>

<span class="sd">         localPeers     //cb_config/stage/peer</span>
<span class="sd">         remotePeers    //cb_config/stage/peer</span>

<span class="sd">      The individual peer entries are parsed by :any:`_parsePeerList`.</span>

<span class="sd">      Args:</span>
<span class="sd">         parentNode: Parent node to search beneath</span>

<span class="sd">      Returns:</span>
<span class="sd">          ``StageConfig`` object or ``None`` if the section does not exist</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If some filled-in value is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">peers</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">readFirstChild</span><span class="p">(</span><span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;peers&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">sectionNode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">peers</span> <span class="o">=</span> <span class="n">PeersConfig</span><span class="p">()</span>
         <span class="p">(</span><span class="n">peers</span><span class="o">.</span><span class="n">localPeers</span><span class="p">,</span> <span class="n">peers</span><span class="o">.</span><span class="n">remotePeers</span><span class="p">)</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_parsePeerList</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">peers</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_parseCollect</span><span class="p">(</span><span class="n">parentNode</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Parses a collect configuration section.</span>

<span class="sd">      We read the following individual fields::</span>

<span class="sd">         targetDir            //cb_config/collect/collect_dir</span>
<span class="sd">         collectMode          //cb_config/collect/collect_mode</span>
<span class="sd">         archiveMode          //cb_config/collect/archive_mode</span>
<span class="sd">         ignoreFile           //cb_config/collect/ignore_file</span>

<span class="sd">      We also read groups of the following items, one list element per</span>
<span class="sd">      item::</span>

<span class="sd">         absoluteExcludePaths //cb_config/collect/exclude/abs_path</span>
<span class="sd">         excludePatterns      //cb_config/collect/exclude/pattern</span>
<span class="sd">         collectFiles         //cb_config/collect/file</span>
<span class="sd">         collectDirs          //cb_config/collect/dir</span>

<span class="sd">      The exclusions are parsed by :any:`_parseExclusions`, the collect files are</span>
<span class="sd">      parsed by :any:`_parseCollectFiles`, and the directories are parsed by</span>
<span class="sd">      :any:`_parseCollectDirs`.</span>

<span class="sd">      Args:</span>
<span class="sd">         parentNode: Parent node to search beneath</span>

<span class="sd">      Returns:</span>
<span class="sd">          ``CollectConfig`` object or ``None`` if the section does not exist</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If some filled-in value is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">collect</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">readFirstChild</span><span class="p">(</span><span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;collect&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">sectionNode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">collect</span> <span class="o">=</span> <span class="n">CollectConfig</span><span class="p">()</span>
         <span class="n">collect</span><span class="o">.</span><span class="n">targetDir</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;collect_dir&quot;</span><span class="p">)</span>
         <span class="n">collect</span><span class="o">.</span><span class="n">collectMode</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;collect_mode&quot;</span><span class="p">)</span>
         <span class="n">collect</span><span class="o">.</span><span class="n">archiveMode</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;archive_mode&quot;</span><span class="p">)</span>
         <span class="n">collect</span><span class="o">.</span><span class="n">ignoreFile</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;ignore_file&quot;</span><span class="p">)</span>
         <span class="p">(</span><span class="n">collect</span><span class="o">.</span><span class="n">absoluteExcludePaths</span><span class="p">,</span> <span class="n">unused</span><span class="p">,</span> <span class="n">collect</span><span class="o">.</span><span class="n">excludePatterns</span><span class="p">)</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_parseExclusions</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">)</span>
         <span class="n">collect</span><span class="o">.</span><span class="n">collectFiles</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_parseCollectFiles</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">)</span>
         <span class="n">collect</span><span class="o">.</span><span class="n">collectDirs</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_parseCollectDirs</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">collect</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_parseStage</span><span class="p">(</span><span class="n">parentNode</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Parses a stage configuration section.</span>

<span class="sd">      We read the following individual fields::</span>

<span class="sd">         targetDir      //cb_config/stage/staging_dir</span>

<span class="sd">      We also read groups of the following items, one list element per</span>
<span class="sd">      item::</span>

<span class="sd">         localPeers     //cb_config/stage/peer</span>
<span class="sd">         remotePeers    //cb_config/stage/peer</span>

<span class="sd">      The individual peer entries are parsed by :any:`_parsePeerList`.</span>

<span class="sd">      Args:</span>
<span class="sd">         parentNode: Parent node to search beneath</span>

<span class="sd">      Returns:</span>
<span class="sd">          ``StageConfig`` object or ``None`` if the section does not exist</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If some filled-in value is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">stage</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">readFirstChild</span><span class="p">(</span><span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;stage&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">sectionNode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">stage</span> <span class="o">=</span> <span class="n">StageConfig</span><span class="p">()</span>
         <span class="n">stage</span><span class="o">.</span><span class="n">targetDir</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;staging_dir&quot;</span><span class="p">)</span>
         <span class="p">(</span><span class="n">stage</span><span class="o">.</span><span class="n">localPeers</span><span class="p">,</span> <span class="n">stage</span><span class="o">.</span><span class="n">remotePeers</span><span class="p">)</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_parsePeerList</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">stage</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_parseStore</span><span class="p">(</span><span class="n">parentNode</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Parses a store configuration section.</span>

<span class="sd">      We read the following fields::</span>

<span class="sd">         sourceDir         //cb_config/store/source_dir</span>
<span class="sd">         mediaType         //cb_config/store/media_type</span>
<span class="sd">         deviceType        //cb_config/store/device_type</span>
<span class="sd">         devicePath        //cb_config/store/target_device</span>
<span class="sd">         deviceScsiId      //cb_config/store/target_scsi_id</span>
<span class="sd">         driveSpeed        //cb_config/store/drive_speed</span>
<span class="sd">         checkData         //cb_config/store/check_data</span>
<span class="sd">         checkMedia        //cb_config/store/check_media</span>
<span class="sd">         warnMidnite       //cb_config/store/warn_midnite</span>
<span class="sd">         noEject           //cb_config/store/no_eject</span>

<span class="sd">      Blanking behavior configuration is parsed by the ``_parseBlankBehavior``</span>
<span class="sd">      method.</span>

<span class="sd">      Args:</span>
<span class="sd">         parentNode: Parent node to search beneath</span>

<span class="sd">      Returns:</span>
<span class="sd">          ``StoreConfig`` object or ``None`` if the section does not exist</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If some filled-in value is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">store</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">readFirstChild</span><span class="p">(</span><span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;store&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">sectionNode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">store</span> <span class="o">=</span> <span class="n">StoreConfig</span><span class="p">()</span>
         <span class="n">store</span><span class="o">.</span><span class="n">sourceDir</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span>  <span class="s2">&quot;source_dir&quot;</span><span class="p">)</span>
         <span class="n">store</span><span class="o">.</span><span class="n">mediaType</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span>  <span class="s2">&quot;media_type&quot;</span><span class="p">)</span>
         <span class="n">store</span><span class="o">.</span><span class="n">deviceType</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span>  <span class="s2">&quot;device_type&quot;</span><span class="p">)</span>
         <span class="n">store</span><span class="o">.</span><span class="n">devicePath</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span>  <span class="s2">&quot;target_device&quot;</span><span class="p">)</span>
         <span class="n">store</span><span class="o">.</span><span class="n">deviceScsiId</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span>  <span class="s2">&quot;target_scsi_id&quot;</span><span class="p">)</span>
         <span class="n">store</span><span class="o">.</span><span class="n">driveSpeed</span> <span class="o">=</span> <span class="n">readInteger</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;drive_speed&quot;</span><span class="p">)</span>
         <span class="n">store</span><span class="o">.</span><span class="n">checkData</span> <span class="o">=</span> <span class="n">readBoolean</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;check_data&quot;</span><span class="p">)</span>
         <span class="n">store</span><span class="o">.</span><span class="n">checkMedia</span> <span class="o">=</span> <span class="n">readBoolean</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;check_media&quot;</span><span class="p">)</span>
         <span class="n">store</span><span class="o">.</span><span class="n">warnMidnite</span> <span class="o">=</span> <span class="n">readBoolean</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;warn_midnite&quot;</span><span class="p">)</span>
         <span class="n">store</span><span class="o">.</span><span class="n">noEject</span> <span class="o">=</span> <span class="n">readBoolean</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;no_eject&quot;</span><span class="p">)</span>
         <span class="n">store</span><span class="o">.</span><span class="n">blankBehavior</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_parseBlankBehavior</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">)</span>
         <span class="n">store</span><span class="o">.</span><span class="n">refreshMediaDelay</span> <span class="o">=</span> <span class="n">readInteger</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;refresh_media_delay&quot;</span><span class="p">)</span>
         <span class="n">store</span><span class="o">.</span><span class="n">ejectDelay</span> <span class="o">=</span> <span class="n">readInteger</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;eject_delay&quot;</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">store</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_parsePurge</span><span class="p">(</span><span class="n">parentNode</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Parses a purge configuration section.</span>

<span class="sd">      We read groups of the following items, one list element per</span>
<span class="sd">      item::</span>

<span class="sd">         purgeDirs     //cb_config/purge/dir</span>

<span class="sd">      The individual directory entries are parsed by :any:`_parsePurgeDirs`.</span>

<span class="sd">      Args:</span>
<span class="sd">         parentNode: Parent node to search beneath</span>

<span class="sd">      Returns:</span>
<span class="sd">          ``PurgeConfig`` object or ``None`` if the section does not exist</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If some filled-in value is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">purge</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">readFirstChild</span><span class="p">(</span><span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;purge&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">sectionNode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">purge</span> <span class="o">=</span> <span class="n">PurgeConfig</span><span class="p">()</span>
         <span class="n">purge</span><span class="o">.</span><span class="n">purgeDirs</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_parsePurgeDirs</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">purge</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_parseExtendedActions</span><span class="p">(</span><span class="n">parentNode</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Reads extended actions data from immediately beneath the parent.</span>

<span class="sd">      We read the following individual fields from each extended action::</span>

<span class="sd">         name           name</span>
<span class="sd">         module         module</span>
<span class="sd">         function       function</span>
<span class="sd">         index          index</span>
<span class="sd">         dependencies   depends</span>

<span class="sd">      Dependency information is parsed by the ``_parseDependencies`` method.</span>

<span class="sd">      Args:</span>
<span class="sd">         parentNode: Parent node to search beneath</span>

<span class="sd">      Returns:</span>
<span class="sd">          List of extended actions</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the data at the location can&#39;t be read</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">readChildren</span><span class="p">(</span><span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;action&quot;</span><span class="p">):</span>
         <span class="k">if</span> <span class="n">isElement</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
            <span class="n">action</span> <span class="o">=</span> <span class="n">ExtendedAction</span><span class="p">()</span>
            <span class="n">action</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span>
            <span class="n">action</span><span class="o">.</span><span class="n">module</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;module&quot;</span><span class="p">)</span>
            <span class="n">action</span><span class="o">.</span><span class="n">function</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;function&quot;</span><span class="p">)</span>
            <span class="n">action</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">readInteger</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">)</span>
            <span class="n">action</span><span class="o">.</span><span class="n">dependencies</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_parseDependencies</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">lst</span> <span class="o">==</span> <span class="p">[]:</span>
         <span class="n">lst</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">return</span> <span class="n">lst</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_parseExclusions</span><span class="p">(</span><span class="n">parentNode</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Reads exclusions data from immediately beneath the parent.</span>

<span class="sd">      We read groups of the following items, one list element per item::</span>

<span class="sd">         absolute    exclude/abs_path</span>
<span class="sd">         relative    exclude/rel_path</span>
<span class="sd">         patterns    exclude/pattern</span>

<span class="sd">      If there are none of some pattern (i.e. no relative path items) then</span>
<span class="sd">      ``None`` will be returned for that item in the tuple.</span>

<span class="sd">      This method can be used to parse exclusions on both the collect</span>
<span class="sd">      configuration level and on the collect directory level within collect</span>
<span class="sd">      configuration.</span>

<span class="sd">      Args:</span>
<span class="sd">         parentNode: Parent node to search beneath</span>

<span class="sd">      Returns:</span>
<span class="sd">          Tuple of (absolute, relative, patterns) exclusions</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">readFirstChild</span><span class="p">(</span><span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;exclude&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">sectionNode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="n">absolute</span> <span class="o">=</span> <span class="n">readStringList</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;abs_path&quot;</span><span class="p">)</span>
         <span class="n">relative</span> <span class="o">=</span> <span class="n">readStringList</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;rel_path&quot;</span><span class="p">)</span>
         <span class="n">patterns</span> <span class="o">=</span> <span class="n">readStringList</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;pattern&quot;</span><span class="p">)</span>
         <span class="k">return</span> <span class="p">(</span><span class="n">absolute</span><span class="p">,</span> <span class="n">relative</span><span class="p">,</span> <span class="n">patterns</span><span class="p">)</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_parseOverrides</span><span class="p">(</span><span class="n">parentNode</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Reads a list of ``CommandOverride`` objects from immediately beneath the parent.</span>

<span class="sd">      We read the following individual fields::</span>

<span class="sd">         command                 command</span>
<span class="sd">         absolutePath            abs_path</span>

<span class="sd">      Args:</span>
<span class="sd">         parentNode: Parent node to search beneath</span>

<span class="sd">      Returns:</span>
<span class="sd">          List of ``CommandOverride`` objects or ``None`` if none are found</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If some filled-in value is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">readChildren</span><span class="p">(</span><span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;override&quot;</span><span class="p">):</span>
         <span class="k">if</span> <span class="n">isElement</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
            <span class="n">override</span> <span class="o">=</span> <span class="n">CommandOverride</span><span class="p">()</span>
            <span class="n">override</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;command&quot;</span><span class="p">)</span>
            <span class="n">override</span><span class="o">.</span><span class="n">absolutePath</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;abs_path&quot;</span><span class="p">)</span>
            <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">override</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">lst</span> <span class="o">==</span> <span class="p">[]:</span>
         <span class="n">lst</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">return</span> <span class="n">lst</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_parseHooks</span><span class="p">(</span><span class="n">parentNode</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Reads a list of ``ActionHook`` objects from immediately beneath the parent.</span>

<span class="sd">      We read the following individual fields::</span>

<span class="sd">         action                  action</span>
<span class="sd">         command                 command</span>

<span class="sd">      Args:</span>
<span class="sd">         parentNode: Parent node to search beneath</span>

<span class="sd">      Returns:</span>
<span class="sd">          List of ``ActionHook`` objects or ``None`` if none are found</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If some filled-in value is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">readChildren</span><span class="p">(</span><span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;pre_action_hook&quot;</span><span class="p">):</span>
         <span class="k">if</span> <span class="n">isElement</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
            <span class="n">hook</span> <span class="o">=</span> <span class="n">PreActionHook</span><span class="p">()</span>
            <span class="n">hook</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;action&quot;</span><span class="p">)</span>
            <span class="n">hook</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;command&quot;</span><span class="p">)</span>
            <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hook</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">readChildren</span><span class="p">(</span><span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;post_action_hook&quot;</span><span class="p">):</span>
         <span class="k">if</span> <span class="n">isElement</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
            <span class="n">hook</span> <span class="o">=</span> <span class="n">PostActionHook</span><span class="p">()</span>
            <span class="n">hook</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;action&quot;</span><span class="p">)</span>
            <span class="n">hook</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;command&quot;</span><span class="p">)</span>
            <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hook</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">lst</span> <span class="o">==</span> <span class="p">[]:</span>
         <span class="n">lst</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">return</span> <span class="n">lst</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_parseCollectFiles</span><span class="p">(</span><span class="n">parentNode</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Reads a list of ``CollectFile`` objects from immediately beneath the parent.</span>

<span class="sd">      We read the following individual fields::</span>

<span class="sd">         absolutePath            abs_path</span>
<span class="sd">         collectMode             mode *or* collect_mode</span>
<span class="sd">         archiveMode             archive_mode</span>

<span class="sd">      The collect mode is a special case.  Just a ``mode`` tag is accepted, but</span>
<span class="sd">      we prefer ``collect_mode`` for consistency with the rest of the config</span>
<span class="sd">      file and to avoid confusion with the archive mode.  If both are provided,</span>
<span class="sd">      only ``mode`` will be used.</span>

<span class="sd">      Args:</span>
<span class="sd">         parentNode: Parent node to search beneath</span>

<span class="sd">      Returns:</span>
<span class="sd">          List of ``CollectFile`` objects or ``None`` if none are found</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If some filled-in value is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">readChildren</span><span class="p">(</span><span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;file&quot;</span><span class="p">):</span>
         <span class="k">if</span> <span class="n">isElement</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
            <span class="n">cfile</span> <span class="o">=</span> <span class="n">CollectFile</span><span class="p">()</span>
            <span class="n">cfile</span><span class="o">.</span><span class="n">absolutePath</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;abs_path&quot;</span><span class="p">)</span>
            <span class="n">cfile</span><span class="o">.</span><span class="n">collectMode</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cfile</span><span class="o">.</span><span class="n">collectMode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
               <span class="n">cfile</span><span class="o">.</span><span class="n">collectMode</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;collect_mode&quot;</span><span class="p">)</span>
            <span class="n">cfile</span><span class="o">.</span><span class="n">archiveMode</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;archive_mode&quot;</span><span class="p">)</span>
            <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cfile</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">lst</span> <span class="o">==</span> <span class="p">[]:</span>
         <span class="n">lst</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">return</span> <span class="n">lst</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_parseCollectDirs</span><span class="p">(</span><span class="n">parentNode</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Reads a list of ``CollectDir`` objects from immediately beneath the parent.</span>

<span class="sd">      We read the following individual fields::</span>

<span class="sd">         absolutePath            abs_path</span>
<span class="sd">         collectMode             mode *or* collect_mode</span>
<span class="sd">         archiveMode             archive_mode</span>
<span class="sd">         ignoreFile              ignore_file</span>
<span class="sd">         linkDepth               link_depth</span>
<span class="sd">         dereference             dereference</span>
<span class="sd">         recursionLevel          recursion_level</span>

<span class="sd">      The collect mode is a special case.  Just a ``mode`` tag is accepted for</span>
<span class="sd">      backwards compatibility, but we prefer ``collect_mode`` for consistency</span>
<span class="sd">      with the rest of the config file and to avoid confusion with the archive</span>
<span class="sd">      mode.  If both are provided, only ``mode`` will be used.</span>

<span class="sd">      We also read groups of the following items, one list element per</span>
<span class="sd">      item::</span>

<span class="sd">         absoluteExcludePaths    exclude/abs_path</span>
<span class="sd">         relativeExcludePaths    exclude/rel_path</span>
<span class="sd">         excludePatterns         exclude/pattern</span>

<span class="sd">      The exclusions are parsed by :any:`_parseExclusions`.</span>

<span class="sd">      Args:</span>
<span class="sd">         parentNode: Parent node to search beneath</span>

<span class="sd">      Returns:</span>
<span class="sd">          List of ``CollectDir`` objects or ``None`` if none are found</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If some filled-in value is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">readChildren</span><span class="p">(</span><span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;dir&quot;</span><span class="p">):</span>
         <span class="k">if</span> <span class="n">isElement</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
            <span class="n">cdir</span> <span class="o">=</span> <span class="n">CollectDir</span><span class="p">()</span>
            <span class="n">cdir</span><span class="o">.</span><span class="n">absolutePath</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;abs_path&quot;</span><span class="p">)</span>
            <span class="n">cdir</span><span class="o">.</span><span class="n">collectMode</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cdir</span><span class="o">.</span><span class="n">collectMode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
               <span class="n">cdir</span><span class="o">.</span><span class="n">collectMode</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;collect_mode&quot;</span><span class="p">)</span>
            <span class="n">cdir</span><span class="o">.</span><span class="n">archiveMode</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;archive_mode&quot;</span><span class="p">)</span>
            <span class="n">cdir</span><span class="o">.</span><span class="n">ignoreFile</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;ignore_file&quot;</span><span class="p">)</span>
            <span class="n">cdir</span><span class="o">.</span><span class="n">linkDepth</span> <span class="o">=</span> <span class="n">readInteger</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;link_depth&quot;</span><span class="p">)</span>
            <span class="n">cdir</span><span class="o">.</span><span class="n">dereference</span> <span class="o">=</span> <span class="n">readBoolean</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;dereference&quot;</span><span class="p">)</span>
            <span class="n">cdir</span><span class="o">.</span><span class="n">recursionLevel</span> <span class="o">=</span> <span class="n">readInteger</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;recursion_level&quot;</span><span class="p">)</span>
            <span class="p">(</span><span class="n">cdir</span><span class="o">.</span><span class="n">absoluteExcludePaths</span><span class="p">,</span> <span class="n">cdir</span><span class="o">.</span><span class="n">relativeExcludePaths</span><span class="p">,</span> <span class="n">cdir</span><span class="o">.</span><span class="n">excludePatterns</span><span class="p">)</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_parseExclusions</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cdir</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">lst</span> <span class="o">==</span> <span class="p">[]:</span>
         <span class="n">lst</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">return</span> <span class="n">lst</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_parsePurgeDirs</span><span class="p">(</span><span class="n">parentNode</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Reads a list of ``PurgeDir`` objects from immediately beneath the parent.</span>

<span class="sd">      We read the following individual fields::</span>

<span class="sd">         absolutePath            &lt;baseExpr&gt;/abs_path</span>
<span class="sd">         retainDays              &lt;baseExpr&gt;/retain_days</span>

<span class="sd">      Args:</span>
<span class="sd">         parentNode: Parent node to search beneath</span>

<span class="sd">      Returns:</span>
<span class="sd">          List of ``PurgeDir`` objects or ``None`` if none are found</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the data at the location can&#39;t be read</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">readChildren</span><span class="p">(</span><span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;dir&quot;</span><span class="p">):</span>
         <span class="k">if</span> <span class="n">isElement</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
            <span class="n">cdir</span> <span class="o">=</span> <span class="n">PurgeDir</span><span class="p">()</span>
            <span class="n">cdir</span><span class="o">.</span><span class="n">absolutePath</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;abs_path&quot;</span><span class="p">)</span>
            <span class="n">cdir</span><span class="o">.</span><span class="n">retainDays</span> <span class="o">=</span> <span class="n">readInteger</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;retain_days&quot;</span><span class="p">)</span>
            <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cdir</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">lst</span> <span class="o">==</span> <span class="p">[]:</span>
         <span class="n">lst</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">return</span> <span class="n">lst</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_parsePeerList</span><span class="p">(</span><span class="n">parentNode</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Reads remote and local peer data from immediately beneath the parent.</span>

<span class="sd">      We read the following individual fields for both remote</span>
<span class="sd">      and local peers::</span>

<span class="sd">         name        name</span>
<span class="sd">         collectDir  collect_dir</span>

<span class="sd">      We also read the following individual fields for remote peers</span>
<span class="sd">      only::</span>

<span class="sd">         remoteUser     backup_user</span>
<span class="sd">         rcpCommand     rcp_command</span>
<span class="sd">         rshCommand     rsh_command</span>
<span class="sd">         cbackCommand   cback_command</span>
<span class="sd">         managed        managed</span>
<span class="sd">         managedActions managed_actions</span>

<span class="sd">      Additionally, the value in the ``type`` field is used to determine whether</span>
<span class="sd">      this entry is a remote peer.  If the type is ``&quot;remote&quot;``, it&#39;s a remote</span>
<span class="sd">      peer, and if the type is ``&quot;local&quot;``, it&#39;s a remote peer.</span>

<span class="sd">      If there are none of one type of peer (i.e. no local peers) then ``None``</span>
<span class="sd">      will be returned for that item in the tuple.</span>

<span class="sd">      Args:</span>
<span class="sd">         parentNode: Parent node to search beneath</span>

<span class="sd">      Returns:</span>
<span class="sd">          Tuple of (local, remote) peer lists</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the data at the location can&#39;t be read</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">localPeers</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="n">remotePeers</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">readChildren</span><span class="p">(</span><span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;peer&quot;</span><span class="p">):</span>
         <span class="k">if</span> <span class="n">isElement</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
            <span class="n">peerType</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">peerType</span> <span class="o">==</span> <span class="s2">&quot;local&quot;</span><span class="p">:</span>
               <span class="n">localPeer</span> <span class="o">=</span> <span class="n">LocalPeer</span><span class="p">()</span>
               <span class="n">localPeer</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span>
               <span class="n">localPeer</span><span class="o">.</span><span class="n">collectDir</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;collect_dir&quot;</span><span class="p">)</span>
               <span class="n">localPeer</span><span class="o">.</span><span class="n">ignoreFailureMode</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;ignore_failures&quot;</span><span class="p">)</span>
               <span class="n">localPeers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">localPeer</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">peerType</span> <span class="o">==</span> <span class="s2">&quot;remote&quot;</span><span class="p">:</span>
               <span class="n">remotePeer</span> <span class="o">=</span> <span class="n">RemotePeer</span><span class="p">()</span>
               <span class="n">remotePeer</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span>
               <span class="n">remotePeer</span><span class="o">.</span><span class="n">collectDir</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;collect_dir&quot;</span><span class="p">)</span>
               <span class="n">remotePeer</span><span class="o">.</span><span class="n">remoteUser</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;backup_user&quot;</span><span class="p">)</span>
               <span class="n">remotePeer</span><span class="o">.</span><span class="n">rcpCommand</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;rcp_command&quot;</span><span class="p">)</span>
               <span class="n">remotePeer</span><span class="o">.</span><span class="n">rshCommand</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;rsh_command&quot;</span><span class="p">)</span>
               <span class="n">remotePeer</span><span class="o">.</span><span class="n">cbackCommand</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;cback_command&quot;</span><span class="p">)</span>
               <span class="n">remotePeer</span><span class="o">.</span><span class="n">ignoreFailureMode</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;ignore_failures&quot;</span><span class="p">)</span>
               <span class="n">remotePeer</span><span class="o">.</span><span class="n">managed</span> <span class="o">=</span> <span class="n">readBoolean</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;managed&quot;</span><span class="p">)</span>
               <span class="n">managedActions</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;managed_actions&quot;</span><span class="p">)</span>
               <span class="n">remotePeer</span><span class="o">.</span><span class="n">managedActions</span> <span class="o">=</span> <span class="n">parseCommaSeparatedString</span><span class="p">(</span><span class="n">managedActions</span><span class="p">)</span>
               <span class="n">remotePeers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">remotePeer</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">localPeers</span> <span class="o">==</span> <span class="p">[]:</span>
         <span class="n">localPeers</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">if</span> <span class="n">remotePeers</span> <span class="o">==</span> <span class="p">[]:</span>
         <span class="n">remotePeers</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">return</span> <span class="p">(</span><span class="n">localPeers</span><span class="p">,</span> <span class="n">remotePeers</span><span class="p">)</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_parseDependencies</span><span class="p">(</span><span class="n">parentNode</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Reads extended action dependency information from a parent node.</span>

<span class="sd">      We read the following individual fields::</span>

<span class="sd">         runBefore   depends/run_before</span>
<span class="sd">         runAfter    depends/run_after</span>

<span class="sd">      Each of these fields is a comma-separated list of action names.</span>

<span class="sd">      The result is placed into an ``ActionDependencies`` object.</span>

<span class="sd">      If the dependencies parent node does not exist, ``None`` will be returned.</span>
<span class="sd">      Otherwise, an ``ActionDependencies`` object will always be created, even</span>
<span class="sd">      if it does not contain any actual dependencies in it.</span>

<span class="sd">      Args:</span>
<span class="sd">         parentNode: Parent node to search beneath</span>

<span class="sd">      Returns:</span>
<span class="sd">          ``ActionDependencies`` object or ``None``</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If the data at the location can&#39;t be read</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">readFirstChild</span><span class="p">(</span><span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;depends&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">sectionNode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="n">runBefore</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;run_before&quot;</span><span class="p">)</span>
         <span class="n">runAfter</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;run_after&quot;</span><span class="p">)</span>
         <span class="n">beforeList</span> <span class="o">=</span> <span class="n">parseCommaSeparatedString</span><span class="p">(</span><span class="n">runBefore</span><span class="p">)</span>
         <span class="n">afterList</span> <span class="o">=</span> <span class="n">parseCommaSeparatedString</span><span class="p">(</span><span class="n">runAfter</span><span class="p">)</span>
         <span class="k">return</span> <span class="n">ActionDependencies</span><span class="p">(</span><span class="n">beforeList</span><span class="p">,</span> <span class="n">afterList</span><span class="p">)</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_parseBlankBehavior</span><span class="p">(</span><span class="n">parentNode</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Reads a single ``BlankBehavior`` object from immediately beneath the parent.</span>

<span class="sd">      We read the following individual fields::</span>

<span class="sd">         blankMode     blank_behavior/mode</span>
<span class="sd">         blankFactor   blank_behavior/factor</span>

<span class="sd">      Args:</span>
<span class="sd">         parentNode: Parent node to search beneath</span>

<span class="sd">      Returns:</span>
<span class="sd">          ``BlankBehavior`` object or ``None`` if none if the section is not found</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If some filled-in value is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="n">blankBehavior</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">readFirstChild</span><span class="p">(</span><span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;blank_behavior&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">sectionNode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">blankBehavior</span> <span class="o">=</span> <span class="n">BlankBehavior</span><span class="p">()</span>
         <span class="n">blankBehavior</span><span class="o">.</span><span class="n">blankMode</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">)</span>
         <span class="n">blankBehavior</span><span class="o">.</span><span class="n">blankFactor</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;factor&quot;</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">blankBehavior</span>


   <span class="c1">########################################</span>
   <span class="c1"># High-level methods for generating XML</span>
   <span class="c1">########################################</span>

   <span class="k">def</span> <span class="nf">_extractXml</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Internal method to extract configuration into an XML string.</span>

<span class="sd">      This method assumes that the internal :any:`validate` method has been called</span>
<span class="sd">      prior to extracting the XML, if the caller cares.  No validation will be</span>
<span class="sd">      done internally.</span>

<span class="sd">      As a general rule, fields that are set to ``None`` will be extracted into</span>
<span class="sd">      the document as empty tags.  The same goes for container tags that are</span>
<span class="sd">      filled based on lists - if the list is empty or ``None``, the container</span>
<span class="sd">      tag will be empty.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">)</span> <span class="o">=</span> <span class="n">createOutputDom</span><span class="p">()</span>
      <span class="n">Config</span><span class="o">.</span><span class="n">_addReference</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference</span><span class="p">)</span>
      <span class="n">Config</span><span class="o">.</span><span class="n">_addExtensions</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span><span class="p">)</span>
      <span class="n">Config</span><span class="o">.</span><span class="n">_addOptions</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>
      <span class="n">Config</span><span class="o">.</span><span class="n">_addPeers</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peers</span><span class="p">)</span>
      <span class="n">Config</span><span class="o">.</span><span class="n">_addCollect</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect</span><span class="p">)</span>
      <span class="n">Config</span><span class="o">.</span><span class="n">_addStage</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stage</span><span class="p">)</span>
      <span class="n">Config</span><span class="o">.</span><span class="n">_addStore</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="p">)</span>
      <span class="n">Config</span><span class="o">.</span><span class="n">_addPurge</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">purge</span><span class="p">)</span>
      <span class="n">xmlData</span> <span class="o">=</span> <span class="n">serializeDom</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">)</span>
      <span class="n">xmlDom</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
      <span class="k">return</span> <span class="n">xmlData</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_addReference</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="n">referenceConfig</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Adds a &lt;reference&gt; configuration section as the next child of a parent.</span>

<span class="sd">      We add the following fields to the document::</span>

<span class="sd">         author         //cb_config/reference/author</span>
<span class="sd">         revision       //cb_config/reference/revision</span>
<span class="sd">         description    //cb_config/reference/description</span>
<span class="sd">         generator      //cb_config/reference/generator</span>

<span class="sd">      If ``referenceConfig`` is ``None``, then no container will be added.</span>

<span class="sd">      Args:</span>
<span class="sd">         xmlDom: DOM tree as from :any:`createOutputDom`</span>
<span class="sd">         parentNode: Parent that the section should be appended to</span>
<span class="sd">         referenceConfig: Reference configuration section to be added to the document</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">referenceConfig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">addContainerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;reference&quot;</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;author&quot;</span><span class="p">,</span> <span class="n">referenceConfig</span><span class="o">.</span><span class="n">author</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;revision&quot;</span><span class="p">,</span> <span class="n">referenceConfig</span><span class="o">.</span><span class="n">revision</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="n">referenceConfig</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;generator&quot;</span><span class="p">,</span> <span class="n">referenceConfig</span><span class="o">.</span><span class="n">generator</span><span class="p">)</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_addExtensions</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="n">extensionsConfig</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Adds an &lt;extensions&gt; configuration section as the next child of a parent.</span>

<span class="sd">      We add the following fields to the document::</span>

<span class="sd">         order_mode     //cb_config/extensions/order_mode</span>

<span class="sd">      We also add groups of the following items, one list element per item::</span>

<span class="sd">         actions        //cb_config/extensions/action</span>

<span class="sd">      The extended action entries are added by :any:`_addExtendedAction`.</span>

<span class="sd">      If ``extensionsConfig`` is ``None``, then no container will be added.</span>

<span class="sd">      Args:</span>
<span class="sd">         xmlDom: DOM tree as from :any:`createOutputDom`</span>
<span class="sd">         parentNode: Parent that the section should be appended to</span>
<span class="sd">         extensionsConfig: Extensions configuration section to be added to the document</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">extensionsConfig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">addContainerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;extensions&quot;</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;order_mode&quot;</span><span class="p">,</span> <span class="n">extensionsConfig</span><span class="o">.</span><span class="n">orderMode</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">extensionsConfig</span><span class="o">.</span><span class="n">actions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">extensionsConfig</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
               <span class="n">Config</span><span class="o">.</span><span class="n">_addExtendedAction</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_addOptions</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="n">optionsConfig</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Adds a &lt;options&gt; configuration section as the next child of a parent.</span>

<span class="sd">      We add the following fields to the document::</span>

<span class="sd">         startingDay    //cb_config/options/starting_day</span>
<span class="sd">         workingDir     //cb_config/options/working_dir</span>
<span class="sd">         backupUser     //cb_config/options/backup_user</span>
<span class="sd">         backupGroup    //cb_config/options/backup_group</span>
<span class="sd">         rcpCommand     //cb_config/options/rcp_command</span>
<span class="sd">         rshCommand     //cb_config/options/rsh_command</span>
<span class="sd">         cbackCommand   //cb_config/options/cback_command</span>
<span class="sd">         managedActions //cb_config/options/managed_actions</span>

<span class="sd">      We also add groups of the following items, one list element per</span>
<span class="sd">      item::</span>

<span class="sd">         overrides      //cb_config/options/override</span>
<span class="sd">         hooks          //cb_config/options/pre_action_hook</span>
<span class="sd">         hooks          //cb_config/options/post_action_hook</span>

<span class="sd">      The individual override items are added by :any:`_addOverride`.  The</span>
<span class="sd">      individual hook items are added by :any:`_addHook`.</span>

<span class="sd">      If ``optionsConfig`` is ``None``, then no container will be added.</span>

<span class="sd">      Args:</span>
<span class="sd">         xmlDom: DOM tree as from :any:`createOutputDom`</span>
<span class="sd">         parentNode: Parent that the section should be appended to</span>
<span class="sd">         optionsConfig: Options configuration section to be added to the document</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">optionsConfig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">addContainerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;options&quot;</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;starting_day&quot;</span><span class="p">,</span> <span class="n">optionsConfig</span><span class="o">.</span><span class="n">startingDay</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;working_dir&quot;</span><span class="p">,</span> <span class="n">optionsConfig</span><span class="o">.</span><span class="n">workingDir</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;backup_user&quot;</span><span class="p">,</span> <span class="n">optionsConfig</span><span class="o">.</span><span class="n">backupUser</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;backup_group&quot;</span><span class="p">,</span> <span class="n">optionsConfig</span><span class="o">.</span><span class="n">backupGroup</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;rcp_command&quot;</span><span class="p">,</span> <span class="n">optionsConfig</span><span class="o">.</span><span class="n">rcpCommand</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;rsh_command&quot;</span><span class="p">,</span> <span class="n">optionsConfig</span><span class="o">.</span><span class="n">rshCommand</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;cback_command&quot;</span><span class="p">,</span> <span class="n">optionsConfig</span><span class="o">.</span><span class="n">cbackCommand</span><span class="p">)</span>
         <span class="n">managedActions</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_buildCommaSeparatedString</span><span class="p">(</span><span class="n">optionsConfig</span><span class="o">.</span><span class="n">managedActions</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;managed_actions&quot;</span><span class="p">,</span> <span class="n">managedActions</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">optionsConfig</span><span class="o">.</span><span class="n">overrides</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">override</span> <span class="ow">in</span> <span class="n">optionsConfig</span><span class="o">.</span><span class="n">overrides</span><span class="p">:</span>
               <span class="n">Config</span><span class="o">.</span><span class="n">_addOverride</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="n">override</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">optionsConfig</span><span class="o">.</span><span class="n">hooks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">hook</span> <span class="ow">in</span> <span class="n">optionsConfig</span><span class="o">.</span><span class="n">hooks</span><span class="p">:</span>
               <span class="n">Config</span><span class="o">.</span><span class="n">_addHook</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="n">hook</span><span class="p">)</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_addPeers</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="n">peersConfig</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Adds a &lt;peers&gt; configuration section as the next child of a parent.</span>

<span class="sd">      We add groups of the following items, one list element per</span>
<span class="sd">      item::</span>

<span class="sd">         localPeers     //cb_config/peers/peer</span>
<span class="sd">         remotePeers    //cb_config/peers/peer</span>

<span class="sd">      The individual local and remote peer entries are added by</span>
<span class="sd">      :any:`_addLocalPeer` and :any:`_addRemotePeer`, respectively.</span>

<span class="sd">      If ``peersConfig`` is ``None``, then no container will be added.</span>

<span class="sd">      Args:</span>
<span class="sd">         xmlDom: DOM tree as from :any:`createOutputDom`</span>
<span class="sd">         parentNode: Parent that the section should be appended to</span>
<span class="sd">         peersConfig: Peers configuration section to be added to the document</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">peersConfig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">addContainerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;peers&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">peersConfig</span><span class="o">.</span><span class="n">localPeers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">localPeer</span> <span class="ow">in</span> <span class="n">peersConfig</span><span class="o">.</span><span class="n">localPeers</span><span class="p">:</span>
               <span class="n">Config</span><span class="o">.</span><span class="n">_addLocalPeer</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="n">localPeer</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">peersConfig</span><span class="o">.</span><span class="n">remotePeers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">remotePeer</span> <span class="ow">in</span> <span class="n">peersConfig</span><span class="o">.</span><span class="n">remotePeers</span><span class="p">:</span>
               <span class="n">Config</span><span class="o">.</span><span class="n">_addRemotePeer</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="n">remotePeer</span><span class="p">)</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_addCollect</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="n">collectConfig</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Adds a &lt;collect&gt; configuration section as the next child of a parent.</span>

<span class="sd">      We add the following fields to the document::</span>

<span class="sd">         targetDir            //cb_config/collect/collect_dir</span>
<span class="sd">         collectMode          //cb_config/collect/collect_mode</span>
<span class="sd">         archiveMode          //cb_config/collect/archive_mode</span>
<span class="sd">         ignoreFile           //cb_config/collect/ignore_file</span>

<span class="sd">      We also add groups of the following items, one list element per</span>
<span class="sd">      item::</span>

<span class="sd">         absoluteExcludePaths //cb_config/collect/exclude/abs_path</span>
<span class="sd">         excludePatterns      //cb_config/collect/exclude/pattern</span>
<span class="sd">         collectFiles         //cb_config/collect/file</span>
<span class="sd">         collectDirs          //cb_config/collect/dir</span>

<span class="sd">      The individual collect files are added by :any:`_addCollectFile` and</span>
<span class="sd">      individual collect directories are added by :any:`_addCollectDir`.</span>

<span class="sd">      If ``collectConfig`` is ``None``, then no container will be added.</span>

<span class="sd">      Args:</span>
<span class="sd">         xmlDom: DOM tree as from :any:`createOutputDom`</span>
<span class="sd">         parentNode: Parent that the section should be appended to</span>
<span class="sd">         collectConfig: Collect configuration section to be added to the document</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">collectConfig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">addContainerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;collect&quot;</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;collect_dir&quot;</span><span class="p">,</span> <span class="n">collectConfig</span><span class="o">.</span><span class="n">targetDir</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;collect_mode&quot;</span><span class="p">,</span> <span class="n">collectConfig</span><span class="o">.</span><span class="n">collectMode</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;archive_mode&quot;</span><span class="p">,</span> <span class="n">collectConfig</span><span class="o">.</span><span class="n">archiveMode</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;ignore_file&quot;</span><span class="p">,</span> <span class="n">collectConfig</span><span class="o">.</span><span class="n">ignoreFile</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">((</span><span class="n">collectConfig</span><span class="o">.</span><span class="n">absoluteExcludePaths</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">collectConfig</span><span class="o">.</span><span class="n">absoluteExcludePaths</span> <span class="o">!=</span> <span class="p">[])</span> <span class="ow">or</span>
             <span class="p">(</span><span class="n">collectConfig</span><span class="o">.</span><span class="n">excludePatterns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">collectConfig</span><span class="o">.</span><span class="n">excludePatterns</span> <span class="o">!=</span> <span class="p">[])):</span>
            <span class="n">excludeNode</span> <span class="o">=</span> <span class="n">addContainerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;exclude&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">collectConfig</span><span class="o">.</span><span class="n">absoluteExcludePaths</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
               <span class="k">for</span> <span class="n">absolutePath</span> <span class="ow">in</span> <span class="n">collectConfig</span><span class="o">.</span><span class="n">absoluteExcludePaths</span><span class="p">:</span>
                  <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">excludeNode</span><span class="p">,</span> <span class="s2">&quot;abs_path&quot;</span><span class="p">,</span> <span class="n">absolutePath</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">collectConfig</span><span class="o">.</span><span class="n">excludePatterns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
               <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">collectConfig</span><span class="o">.</span><span class="n">excludePatterns</span><span class="p">:</span>
                  <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">excludeNode</span><span class="p">,</span> <span class="s2">&quot;pattern&quot;</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">collectConfig</span><span class="o">.</span><span class="n">collectFiles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">collectFile</span> <span class="ow">in</span> <span class="n">collectConfig</span><span class="o">.</span><span class="n">collectFiles</span><span class="p">:</span>
               <span class="n">Config</span><span class="o">.</span><span class="n">_addCollectFile</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="n">collectFile</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">collectConfig</span><span class="o">.</span><span class="n">collectDirs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">collectDir</span> <span class="ow">in</span> <span class="n">collectConfig</span><span class="o">.</span><span class="n">collectDirs</span><span class="p">:</span>
               <span class="n">Config</span><span class="o">.</span><span class="n">_addCollectDir</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="n">collectDir</span><span class="p">)</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_addStage</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="n">stageConfig</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Adds a &lt;stage&gt; configuration section as the next child of a parent.</span>

<span class="sd">      We add the following fields to the document::</span>

<span class="sd">         targetDir      //cb_config/stage/staging_dir</span>

<span class="sd">      We also add groups of the following items, one list element per</span>
<span class="sd">      item::</span>

<span class="sd">         localPeers     //cb_config/stage/peer</span>
<span class="sd">         remotePeers    //cb_config/stage/peer</span>

<span class="sd">      The individual local and remote peer entries are added by</span>
<span class="sd">      :any:`_addLocalPeer` and :any:`_addRemotePeer`, respectively.</span>

<span class="sd">      If ``stageConfig`` is ``None``, then no container will be added.</span>

<span class="sd">      Args:</span>
<span class="sd">         xmlDom: DOM tree as from :any:`createOutputDom`</span>
<span class="sd">         parentNode: Parent that the section should be appended to</span>
<span class="sd">         stageConfig: Stage configuration section to be added to the document</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">stageConfig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">addContainerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;stage&quot;</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;staging_dir&quot;</span><span class="p">,</span> <span class="n">stageConfig</span><span class="o">.</span><span class="n">targetDir</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">stageConfig</span><span class="o">.</span><span class="n">localPeers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">localPeer</span> <span class="ow">in</span> <span class="n">stageConfig</span><span class="o">.</span><span class="n">localPeers</span><span class="p">:</span>
               <span class="n">Config</span><span class="o">.</span><span class="n">_addLocalPeer</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="n">localPeer</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">stageConfig</span><span class="o">.</span><span class="n">remotePeers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">remotePeer</span> <span class="ow">in</span> <span class="n">stageConfig</span><span class="o">.</span><span class="n">remotePeers</span><span class="p">:</span>
               <span class="n">Config</span><span class="o">.</span><span class="n">_addRemotePeer</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="n">remotePeer</span><span class="p">)</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_addStore</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="n">storeConfig</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Adds a &lt;store&gt; configuration section as the next child of a parent.</span>

<span class="sd">      We add the following fields to the document::</span>

<span class="sd">         sourceDir         //cb_config/store/source_dir</span>
<span class="sd">         mediaType         //cb_config/store/media_type</span>
<span class="sd">         deviceType        //cb_config/store/device_type</span>
<span class="sd">         devicePath        //cb_config/store/target_device</span>
<span class="sd">         deviceScsiId      //cb_config/store/target_scsi_id</span>
<span class="sd">         driveSpeed        //cb_config/store/drive_speed</span>
<span class="sd">         checkData         //cb_config/store/check_data</span>
<span class="sd">         checkMedia        //cb_config/store/check_media</span>
<span class="sd">         warnMidnite       //cb_config/store/warn_midnite</span>
<span class="sd">         noEject           //cb_config/store/no_eject</span>
<span class="sd">         refreshMediaDelay //cb_config/store/refresh_media_delay</span>
<span class="sd">         ejectDelay        //cb_config/store/eject_delay</span>

<span class="sd">      Blanking behavior configuration is added by the :any:`_addBlankBehavior`</span>
<span class="sd">      method.</span>

<span class="sd">      If ``storeConfig`` is ``None``, then no container will be added.</span>

<span class="sd">      Args:</span>
<span class="sd">         xmlDom: DOM tree as from :any:`createOutputDom`</span>
<span class="sd">         parentNode: Parent that the section should be appended to</span>
<span class="sd">         storeConfig: Store configuration section to be added to the document</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">storeConfig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">addContainerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;store&quot;</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;source_dir&quot;</span><span class="p">,</span> <span class="n">storeConfig</span><span class="o">.</span><span class="n">sourceDir</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;media_type&quot;</span><span class="p">,</span> <span class="n">storeConfig</span><span class="o">.</span><span class="n">mediaType</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;device_type&quot;</span><span class="p">,</span> <span class="n">storeConfig</span><span class="o">.</span><span class="n">deviceType</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;target_device&quot;</span><span class="p">,</span> <span class="n">storeConfig</span><span class="o">.</span><span class="n">devicePath</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;target_scsi_id&quot;</span><span class="p">,</span> <span class="n">storeConfig</span><span class="o">.</span><span class="n">deviceScsiId</span><span class="p">)</span>
         <span class="n">addIntegerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;drive_speed&quot;</span><span class="p">,</span> <span class="n">storeConfig</span><span class="o">.</span><span class="n">driveSpeed</span><span class="p">)</span>
         <span class="n">addBooleanNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;check_data&quot;</span><span class="p">,</span> <span class="n">storeConfig</span><span class="o">.</span><span class="n">checkData</span><span class="p">)</span>
         <span class="n">addBooleanNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;check_media&quot;</span><span class="p">,</span> <span class="n">storeConfig</span><span class="o">.</span><span class="n">checkMedia</span><span class="p">)</span>
         <span class="n">addBooleanNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;warn_midnite&quot;</span><span class="p">,</span> <span class="n">storeConfig</span><span class="o">.</span><span class="n">warnMidnite</span><span class="p">)</span>
         <span class="n">addBooleanNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;no_eject&quot;</span><span class="p">,</span> <span class="n">storeConfig</span><span class="o">.</span><span class="n">noEject</span><span class="p">)</span>
         <span class="n">addIntegerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;refresh_media_delay&quot;</span><span class="p">,</span> <span class="n">storeConfig</span><span class="o">.</span><span class="n">refreshMediaDelay</span><span class="p">)</span>
         <span class="n">addIntegerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;eject_delay&quot;</span><span class="p">,</span> <span class="n">storeConfig</span><span class="o">.</span><span class="n">ejectDelay</span><span class="p">)</span>
         <span class="n">Config</span><span class="o">.</span><span class="n">_addBlankBehavior</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="n">storeConfig</span><span class="o">.</span><span class="n">blankBehavior</span><span class="p">)</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_addPurge</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="n">purgeConfig</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Adds a &lt;purge&gt; configuration section as the next child of a parent.</span>

<span class="sd">      We add the following fields to the document::</span>

<span class="sd">         purgeDirs     //cb_config/purge/dir</span>

<span class="sd">      The individual directory entries are added by :any:`_addPurgeDir`.</span>

<span class="sd">      If ``purgeConfig`` is ``None``, then no container will be added.</span>

<span class="sd">      Args:</span>
<span class="sd">         xmlDom: DOM tree as from :any:`createOutputDom`</span>
<span class="sd">         parentNode: Parent that the section should be appended to</span>
<span class="sd">         purgeConfig: Purge configuration section to be added to the document</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">purgeConfig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">addContainerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;purge&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">purgeConfig</span><span class="o">.</span><span class="n">purgeDirs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">purgeDir</span> <span class="ow">in</span> <span class="n">purgeConfig</span><span class="o">.</span><span class="n">purgeDirs</span><span class="p">:</span>
               <span class="n">Config</span><span class="o">.</span><span class="n">_addPurgeDir</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="n">purgeDir</span><span class="p">)</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_addExtendedAction</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Adds an extended action container as the next child of a parent.</span>

<span class="sd">      We add the following fields to the document::</span>

<span class="sd">         name           action/name</span>
<span class="sd">         module         action/module</span>
<span class="sd">         function       action/function</span>
<span class="sd">         index          action/index</span>
<span class="sd">         dependencies   action/depends</span>

<span class="sd">      Dependencies are added by the :any:`_addDependencies` method.</span>

<span class="sd">      The &lt;action&gt; node itself is created as the next child of the parent node.</span>
<span class="sd">      This method only adds one action node.  The parent must loop for each action</span>
<span class="sd">      in the ``ExtensionsConfig`` object.</span>

<span class="sd">      If ``action`` is ``None``, this method call will be a no-op.</span>

<span class="sd">      Args:</span>
<span class="sd">         xmlDom: DOM tree as from :any:`createOutputDom`</span>
<span class="sd">         parentNode: Parent that the section should be appended to</span>
<span class="sd">         action: Purge directory to be added to the document</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">action</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">addContainerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;action&quot;</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;module&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">.</span><span class="n">module</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;function&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">.</span><span class="n">function</span><span class="p">)</span>
         <span class="n">addIntegerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
         <span class="n">Config</span><span class="o">.</span><span class="n">_addDependencies</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="n">action</span><span class="o">.</span><span class="n">dependencies</span><span class="p">)</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_addOverride</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="n">override</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Adds a command override container as the next child of a parent.</span>

<span class="sd">      We add the following fields to the document::</span>

<span class="sd">         command                 override/command</span>
<span class="sd">         absolutePath            override/abs_path</span>

<span class="sd">      The &lt;override&gt; node itself is created as the next child of the parent</span>
<span class="sd">      node.  This method only adds one override node.  The parent must loop for</span>
<span class="sd">      each override in the ``OptionsConfig`` object.</span>

<span class="sd">      If ``override`` is ``None``, this method call will be a no-op.</span>

<span class="sd">      Args:</span>
<span class="sd">         xmlDom: DOM tree as from :any:`createOutputDom`</span>
<span class="sd">         parentNode: Parent that the section should be appended to</span>
<span class="sd">         override: Command override to be added to the document</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">override</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">addContainerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;override&quot;</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;command&quot;</span><span class="p">,</span> <span class="n">override</span><span class="o">.</span><span class="n">command</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;abs_path&quot;</span><span class="p">,</span> <span class="n">override</span><span class="o">.</span><span class="n">absolutePath</span><span class="p">)</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_addHook</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="n">hook</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Adds an action hook container as the next child of a parent.</span>

<span class="sd">      The behavior varies depending on the value of the ``before`` and ``after``</span>
<span class="sd">      flags on the hook.  If the ``before`` flag is set, it&#39;s a pre-action hook,</span>
<span class="sd">      and we&#39;ll add the following fields::</span>

<span class="sd">         action                  pre_action_hook/action</span>
<span class="sd">         command                 pre_action_hook/command</span>

<span class="sd">      If the ``after`` flag is set, it&#39;s a post-action hook, and we&#39;ll add the</span>
<span class="sd">      following fields::</span>

<span class="sd">         action                  post_action_hook/action</span>
<span class="sd">         command                 post_action_hook/command</span>

<span class="sd">      The &lt;pre_action_hook&gt; or &lt;post_action_hook&gt; node itself is created as the</span>
<span class="sd">      next child of the parent node.  This method only adds one hook node.  The</span>
<span class="sd">      parent must loop for each hook in the ``OptionsConfig`` object.</span>

<span class="sd">      If ``hook`` is ``None``, this method call will be a no-op.</span>

<span class="sd">      Args:</span>
<span class="sd">         xmlDom: DOM tree as from :any:`createOutputDom`</span>
<span class="sd">         parentNode: Parent that the section should be appended to</span>
<span class="sd">         hook: Command hook to be added to the document</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">hook</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="n">hook</span><span class="o">.</span><span class="n">before</span><span class="p">:</span>
            <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">addContainerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;pre_action_hook&quot;</span><span class="p">)</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">addContainerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;post_action_hook&quot;</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;action&quot;</span><span class="p">,</span> <span class="n">hook</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;command&quot;</span><span class="p">,</span> <span class="n">hook</span><span class="o">.</span><span class="n">command</span><span class="p">)</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_addCollectFile</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="n">collectFile</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Adds a collect file container as the next child of a parent.</span>

<span class="sd">      We add the following fields to the document::</span>

<span class="sd">         absolutePath            dir/abs_path</span>
<span class="sd">         collectMode             dir/collect_mode</span>
<span class="sd">         archiveMode             dir/archive_mode</span>

<span class="sd">      Note that for consistency with collect directory handling we&#39;ll only emit</span>
<span class="sd">      the preferred ``collect_mode`` tag.</span>

<span class="sd">      The &lt;file&gt; node itself is created as the next child of the parent node.</span>
<span class="sd">      This method only adds one collect file node.  The parent must loop</span>
<span class="sd">      for each collect file in the ``CollectConfig`` object.</span>

<span class="sd">      If ``collectFile`` is ``None``, this method call will be a no-op.</span>

<span class="sd">      Args:</span>
<span class="sd">         xmlDom: DOM tree as from :any:`createOutputDom`</span>
<span class="sd">         parentNode: Parent that the section should be appended to</span>
<span class="sd">         collectFile: Collect file to be added to the document</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">collectFile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">addContainerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;file&quot;</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;abs_path&quot;</span><span class="p">,</span> <span class="n">collectFile</span><span class="o">.</span><span class="n">absolutePath</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;collect_mode&quot;</span><span class="p">,</span> <span class="n">collectFile</span><span class="o">.</span><span class="n">collectMode</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;archive_mode&quot;</span><span class="p">,</span> <span class="n">collectFile</span><span class="o">.</span><span class="n">archiveMode</span><span class="p">)</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_addCollectDir</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="n">collectDir</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Adds a collect directory container as the next child of a parent.</span>

<span class="sd">      We add the following fields to the document::</span>

<span class="sd">         absolutePath            dir/abs_path</span>
<span class="sd">         collectMode             dir/collect_mode</span>
<span class="sd">         archiveMode             dir/archive_mode</span>
<span class="sd">         ignoreFile              dir/ignore_file</span>
<span class="sd">         linkDepth               dir/link_depth</span>
<span class="sd">         dereference             dir/dereference</span>
<span class="sd">         recursionLevel          dir/recursion_level</span>

<span class="sd">      Note that an original XML document might have listed the collect mode</span>
<span class="sd">      using the ``mode`` tag, since we accept both ``collect_mode`` and ``mode``.</span>
<span class="sd">      However, here we&#39;ll only emit the preferred ``collect_mode`` tag.</span>

<span class="sd">      We also add groups of the following items, one list element per item::</span>

<span class="sd">         absoluteExcludePaths    dir/exclude/abs_path</span>
<span class="sd">         relativeExcludePaths    dir/exclude/rel_path</span>
<span class="sd">         excludePatterns         dir/exclude/pattern</span>

<span class="sd">      The &lt;dir&gt; node itself is created as the next child of the parent node.</span>
<span class="sd">      This method only adds one collect directory node.  The parent must loop</span>
<span class="sd">      for each collect directory in the ``CollectConfig`` object.</span>

<span class="sd">      If ``collectDir`` is ``None``, this method call will be a no-op.</span>

<span class="sd">      Args:</span>
<span class="sd">         xmlDom: DOM tree as from :any:`createOutputDom`</span>
<span class="sd">         parentNode: Parent that the section should be appended to</span>
<span class="sd">         collectDir: Collect directory to be added to the document</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">collectDir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">addContainerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;dir&quot;</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;abs_path&quot;</span><span class="p">,</span> <span class="n">collectDir</span><span class="o">.</span><span class="n">absolutePath</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;collect_mode&quot;</span><span class="p">,</span> <span class="n">collectDir</span><span class="o">.</span><span class="n">collectMode</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;archive_mode&quot;</span><span class="p">,</span> <span class="n">collectDir</span><span class="o">.</span><span class="n">archiveMode</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;ignore_file&quot;</span><span class="p">,</span> <span class="n">collectDir</span><span class="o">.</span><span class="n">ignoreFile</span><span class="p">)</span>
         <span class="n">addIntegerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;link_depth&quot;</span><span class="p">,</span> <span class="n">collectDir</span><span class="o">.</span><span class="n">linkDepth</span><span class="p">)</span>
         <span class="n">addBooleanNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;dereference&quot;</span><span class="p">,</span> <span class="n">collectDir</span><span class="o">.</span><span class="n">dereference</span><span class="p">)</span>
         <span class="n">addIntegerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;recursion_level&quot;</span><span class="p">,</span> <span class="n">collectDir</span><span class="o">.</span><span class="n">recursionLevel</span><span class="p">)</span>
         <span class="k">if</span> <span class="p">((</span><span class="n">collectDir</span><span class="o">.</span><span class="n">absoluteExcludePaths</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">collectDir</span><span class="o">.</span><span class="n">absoluteExcludePaths</span> <span class="o">!=</span> <span class="p">[])</span> <span class="ow">or</span>
             <span class="p">(</span><span class="n">collectDir</span><span class="o">.</span><span class="n">relativeExcludePaths</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">collectDir</span><span class="o">.</span><span class="n">relativeExcludePaths</span> <span class="o">!=</span> <span class="p">[])</span> <span class="ow">or</span>
             <span class="p">(</span><span class="n">collectDir</span><span class="o">.</span><span class="n">excludePatterns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">collectDir</span><span class="o">.</span><span class="n">excludePatterns</span> <span class="o">!=</span> <span class="p">[])):</span>
            <span class="n">excludeNode</span> <span class="o">=</span> <span class="n">addContainerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;exclude&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">collectDir</span><span class="o">.</span><span class="n">absoluteExcludePaths</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
               <span class="k">for</span> <span class="n">absolutePath</span> <span class="ow">in</span> <span class="n">collectDir</span><span class="o">.</span><span class="n">absoluteExcludePaths</span><span class="p">:</span>
                  <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">excludeNode</span><span class="p">,</span> <span class="s2">&quot;abs_path&quot;</span><span class="p">,</span> <span class="n">absolutePath</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">collectDir</span><span class="o">.</span><span class="n">relativeExcludePaths</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
               <span class="k">for</span> <span class="n">relativePath</span> <span class="ow">in</span> <span class="n">collectDir</span><span class="o">.</span><span class="n">relativeExcludePaths</span><span class="p">:</span>
                  <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">excludeNode</span><span class="p">,</span> <span class="s2">&quot;rel_path&quot;</span><span class="p">,</span> <span class="n">relativePath</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">collectDir</span><span class="o">.</span><span class="n">excludePatterns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
               <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">collectDir</span><span class="o">.</span><span class="n">excludePatterns</span><span class="p">:</span>
                  <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">excludeNode</span><span class="p">,</span> <span class="s2">&quot;pattern&quot;</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_addLocalPeer</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="n">localPeer</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Adds a local peer container as the next child of a parent.</span>

<span class="sd">      We add the following fields to the document::</span>

<span class="sd">         name                peer/name</span>
<span class="sd">         collectDir          peer/collect_dir</span>
<span class="sd">         ignoreFailureMode   peer/ignore_failures</span>

<span class="sd">      Additionally, ``peer/type`` is filled in with ``&quot;local&quot;``, since this is a</span>
<span class="sd">      local peer.</span>

<span class="sd">      The &lt;peer&gt; node itself is created as the next child of the parent node.</span>
<span class="sd">      This method only adds one peer node.  The parent must loop for each peer</span>
<span class="sd">      in the ``StageConfig`` object.</span>

<span class="sd">      If ``localPeer`` is ``None``, this method call will be a no-op.</span>

<span class="sd">      Args:</span>
<span class="sd">         xmlDom: DOM tree as from :any:`createOutputDom`</span>
<span class="sd">         parentNode: Parent that the section should be appended to</span>
<span class="sd">         localPeer: Purge directory to be added to the document</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">localPeer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">addContainerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;peer&quot;</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">localPeer</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;local&quot;</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;collect_dir&quot;</span><span class="p">,</span> <span class="n">localPeer</span><span class="o">.</span><span class="n">collectDir</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;ignore_failures&quot;</span><span class="p">,</span> <span class="n">localPeer</span><span class="o">.</span><span class="n">ignoreFailureMode</span><span class="p">)</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_addRemotePeer</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="n">remotePeer</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Adds a remote peer container as the next child of a parent.</span>

<span class="sd">      We add the following fields to the document::</span>

<span class="sd">         name                peer/name</span>
<span class="sd">         collectDir          peer/collect_dir</span>
<span class="sd">         remoteUser          peer/backup_user</span>
<span class="sd">         rcpCommand          peer/rcp_command</span>
<span class="sd">         rcpCommand          peer/rcp_command</span>
<span class="sd">         rshCommand          peer/rsh_command</span>
<span class="sd">         cbackCommand        peer/cback_command</span>
<span class="sd">         ignoreFailureMode   peer/ignore_failures</span>
<span class="sd">         managed             peer/managed</span>
<span class="sd">         managedActions      peer/managed_actions</span>

<span class="sd">      Additionally, ``peer/type`` is filled in with ``&quot;remote&quot;``, since this is a</span>
<span class="sd">      remote peer.</span>

<span class="sd">      The &lt;peer&gt; node itself is created as the next child of the parent node.</span>
<span class="sd">      This method only adds one peer node.  The parent must loop for each peer</span>
<span class="sd">      in the ``StageConfig`` object.</span>

<span class="sd">      If ``remotePeer`` is ``None``, this method call will be a no-op.</span>

<span class="sd">      Args:</span>
<span class="sd">         xmlDom: DOM tree as from :any:`createOutputDom`</span>
<span class="sd">         parentNode: Parent that the section should be appended to</span>
<span class="sd">         remotePeer: Purge directory to be added to the document</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">remotePeer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">addContainerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;peer&quot;</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">remotePeer</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;remote&quot;</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;collect_dir&quot;</span><span class="p">,</span> <span class="n">remotePeer</span><span class="o">.</span><span class="n">collectDir</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;backup_user&quot;</span><span class="p">,</span> <span class="n">remotePeer</span><span class="o">.</span><span class="n">remoteUser</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;rcp_command&quot;</span><span class="p">,</span> <span class="n">remotePeer</span><span class="o">.</span><span class="n">rcpCommand</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;rsh_command&quot;</span><span class="p">,</span> <span class="n">remotePeer</span><span class="o">.</span><span class="n">rshCommand</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;cback_command&quot;</span><span class="p">,</span> <span class="n">remotePeer</span><span class="o">.</span><span class="n">cbackCommand</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;ignore_failures&quot;</span><span class="p">,</span> <span class="n">remotePeer</span><span class="o">.</span><span class="n">ignoreFailureMode</span><span class="p">)</span>
         <span class="n">addBooleanNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;managed&quot;</span><span class="p">,</span> <span class="n">remotePeer</span><span class="o">.</span><span class="n">managed</span><span class="p">)</span>
         <span class="n">managedActions</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_buildCommaSeparatedString</span><span class="p">(</span><span class="n">remotePeer</span><span class="o">.</span><span class="n">managedActions</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;managed_actions&quot;</span><span class="p">,</span> <span class="n">managedActions</span><span class="p">)</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_addPurgeDir</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="n">purgeDir</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Adds a purge directory container as the next child of a parent.</span>

<span class="sd">      We add the following fields to the document::</span>

<span class="sd">         absolutePath            dir/abs_path</span>
<span class="sd">         retainDays              dir/retain_days</span>

<span class="sd">      The &lt;dir&gt; node itself is created as the next child of the parent node.</span>
<span class="sd">      This method only adds one purge directory node.  The parent must loop for</span>
<span class="sd">      each purge directory in the ``PurgeConfig`` object.</span>

<span class="sd">      If ``purgeDir`` is ``None``, this method call will be a no-op.</span>

<span class="sd">      Args:</span>
<span class="sd">         xmlDom: DOM tree as from :any:`createOutputDom`</span>
<span class="sd">         parentNode: Parent that the section should be appended to</span>
<span class="sd">         purgeDir: Purge directory to be added to the document</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">purgeDir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">addContainerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;dir&quot;</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;abs_path&quot;</span><span class="p">,</span> <span class="n">purgeDir</span><span class="o">.</span><span class="n">absolutePath</span><span class="p">)</span>
         <span class="n">addIntegerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;retain_days&quot;</span><span class="p">,</span> <span class="n">purgeDir</span><span class="o">.</span><span class="n">retainDays</span><span class="p">)</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_addDependencies</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="n">dependencies</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Adds a extended action dependencies to parent node.</span>

<span class="sd">      We add the following fields to the document::</span>

<span class="sd">         runBefore      depends/run_before</span>
<span class="sd">         runAfter       depends/run_after</span>

<span class="sd">      If ``dependencies`` is ``None``, this method call will be a no-op.</span>

<span class="sd">      Args:</span>
<span class="sd">         xmlDom: DOM tree as from :any:`createOutputDom`</span>
<span class="sd">         parentNode: Parent that the section should be appended to</span>
<span class="sd">         dependencies: ``ActionDependencies`` object to be added to the document</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">dependencies</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">addContainerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;depends&quot;</span><span class="p">)</span>
         <span class="n">runBefore</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_buildCommaSeparatedString</span><span class="p">(</span><span class="n">dependencies</span><span class="o">.</span><span class="n">beforeList</span><span class="p">)</span>
         <span class="n">runAfter</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">_buildCommaSeparatedString</span><span class="p">(</span><span class="n">dependencies</span><span class="o">.</span><span class="n">afterList</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;run_before&quot;</span><span class="p">,</span> <span class="n">runBefore</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;run_after&quot;</span><span class="p">,</span> <span class="n">runAfter</span><span class="p">)</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_buildCommaSeparatedString</span><span class="p">(</span><span class="n">valueList</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Creates a comma-separated string from a list of values.</span>

<span class="sd">      As a special case, if ``valueList`` is ``None``, then ``None`` will be</span>
<span class="sd">      returned.</span>

<span class="sd">      Args:</span>
<span class="sd">         valueList: List of values to be placed into a string</span>

<span class="sd">      Returns:</span>
<span class="sd">          Values from valueList as a comma-separated string</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">valueList</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">return</span> <span class="kc">None</span>
      <span class="k">return</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">valueList</span><span class="p">)</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">_addBlankBehavior</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="n">blankBehavior</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Adds a blanking behavior container as the next child of a parent.</span>

<span class="sd">      We add the following fields to the document::</span>

<span class="sd">         blankMode    blank_behavior/mode</span>
<span class="sd">         blankFactor  blank_behavior/factor</span>

<span class="sd">      The &lt;blank_behavior&gt; node itself is created as the next child of the</span>
<span class="sd">      parent node.</span>

<span class="sd">      If ``blankBehavior`` is ``None``, this method call will be a no-op.</span>

<span class="sd">      Args:</span>
<span class="sd">         xmlDom: DOM tree as from :any:`createOutputDom`</span>
<span class="sd">         parentNode: Parent that the section should be appended to</span>
<span class="sd">         blankBehavior: Blanking behavior to be added to the document</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">blankBehavior</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">sectionNode</span> <span class="o">=</span> <span class="n">addContainerNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="s2">&quot;blank_behavior&quot;</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="n">blankBehavior</span><span class="o">.</span><span class="n">blankMode</span><span class="p">)</span>
         <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">sectionNode</span><span class="p">,</span> <span class="s2">&quot;factor&quot;</span><span class="p">,</span> <span class="n">blankBehavior</span><span class="o">.</span><span class="n">blankFactor</span><span class="p">)</span>


   <span class="c1">#################################################</span>
   <span class="c1"># High-level methods used for validating content</span>
   <span class="c1">#################################################</span>

   <span class="k">def</span> <span class="nf">_validateContents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Validates configuration contents per rules discussed in module</span>
<span class="sd">      documentation.</span>

<span class="sd">      This is the second pass at validation.  It ensures that any filled-in</span>
<span class="sd">      section contains valid data.  Any sections which is not set to ``None`` is</span>
<span class="sd">      validated per the rules for that section, laid out in the module</span>
<span class="sd">      documentation (above).</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If configuration is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_validateReference</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_validateExtensions</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_validateOptions</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_validatePeers</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_validateCollect</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_validateStage</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_validateStore</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_validatePurge</span><span class="p">()</span>

   <span class="k">def</span> <span class="nf">_validateReference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Validates reference configuration.</span>
<span class="sd">      There are currently no reference-related validations.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If reference configuration is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">pass</span>

   <span class="k">def</span> <span class="nf">_validateExtensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Validates extensions configuration.</span>

<span class="sd">      The list of actions may be either ``None`` or an empty list ``[]`` if</span>
<span class="sd">      desired.  Each extended action must include a name, a module, and a</span>
<span class="sd">      function.</span>

<span class="sd">      Then, if the order mode is None or &quot;index&quot;, an index is required; and if</span>
<span class="sd">      the order mode is &quot;dependency&quot;, dependency information is required.</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If reference configuration is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">actions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
               <span class="k">if</span> <span class="n">action</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                  <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each extended action must set a name.&quot;</span><span class="p">)</span>
               <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
               <span class="k">if</span> <span class="n">action</span><span class="o">.</span><span class="n">module</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                  <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each extended action must set a module.&quot;</span><span class="p">)</span>
               <span class="k">if</span> <span class="n">action</span><span class="o">.</span><span class="n">function</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                  <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each extended action must set a function.&quot;</span><span class="p">)</span>
               <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">orderMode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">orderMode</span> <span class="o">==</span> <span class="s2">&quot;index&quot;</span><span class="p">:</span>
                  <span class="k">if</span> <span class="n">action</span><span class="o">.</span><span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each extended action must set an index, based on order mode.&quot;</span><span class="p">)</span>
               <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">orderMode</span> <span class="o">==</span> <span class="s2">&quot;dependency&quot;</span><span class="p">:</span>
                  <span class="k">if</span> <span class="n">action</span><span class="o">.</span><span class="n">dependencies</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each extended action must set dependency information, based on order mode.&quot;</span><span class="p">)</span>
            <span class="n">checkUnique</span><span class="p">(</span><span class="s2">&quot;Duplicate extension names exist:&quot;</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">_validateOptions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Validates options configuration.</span>

<span class="sd">      All fields must be filled in except the rsh command.  The rcp and rsh</span>
<span class="sd">      commands are used as default values for all remote peers.  Remote peers</span>
<span class="sd">      can also rely on the backup user as the default remote user name if they</span>
<span class="sd">      choose.</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If reference configuration is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">startingDay</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Options section starting day must be filled in.&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">workingDir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Options section working directory must be filled in.&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">backupUser</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Options section backup user must be filled in.&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">backupGroup</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Options section backup group must be filled in.&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">rcpCommand</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Options section remote copy command must be filled in.&quot;</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">_validatePeers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Validates peers configuration per rules in :any:`_validatePeerList`.</span>
<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If peers configuration is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">peers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_validatePeerList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peers</span><span class="o">.</span><span class="n">localPeers</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peers</span><span class="o">.</span><span class="n">remotePeers</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">_validateCollect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Validates collect configuration.</span>

<span class="sd">      The target directory must be filled in.  The collect mode, archive mode,</span>
<span class="sd">      ignore file, and recursion level are all optional.  The list of absolute</span>
<span class="sd">      paths to exclude and patterns to exclude may be either ``None`` or an</span>
<span class="sd">      empty list ``[]`` if desired.</span>

<span class="sd">      Each collect directory entry must contain an absolute path to collect,</span>
<span class="sd">      and then must either be able to take collect mode, archive mode and</span>
<span class="sd">      ignore file configuration from the parent ``CollectConfig`` object, or</span>
<span class="sd">      must set each value on its own.  The list of absolute paths to exclude,</span>
<span class="sd">      relative paths to exclude and patterns to exclude may be either ``None``</span>
<span class="sd">      or an empty list ``[]`` if desired.  Any list of absolute paths to exclude</span>
<span class="sd">      or patterns to exclude will be combined with the same list in the</span>
<span class="sd">      ``CollectConfig`` object to make the complete list for a given directory.</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If collect configuration is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect</span><span class="o">.</span><span class="n">targetDir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Collect section target directory must be filled in.&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect</span><span class="o">.</span><span class="n">collectFiles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">collectFile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect</span><span class="o">.</span><span class="n">collectFiles</span><span class="p">:</span>
               <span class="k">if</span> <span class="n">collectFile</span><span class="o">.</span><span class="n">absolutePath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                  <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each collect file must set an absolute path.&quot;</span><span class="p">)</span>
               <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect</span><span class="o">.</span><span class="n">collectMode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">collectFile</span><span class="o">.</span><span class="n">collectMode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                  <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Collect mode must either be set in parent collect section or individual collect file.&quot;</span><span class="p">)</span>
               <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect</span><span class="o">.</span><span class="n">archiveMode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">collectFile</span><span class="o">.</span><span class="n">archiveMode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                  <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Archive mode must either be set in parent collect section or individual collect file.&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect</span><span class="o">.</span><span class="n">collectDirs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">collectDir</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect</span><span class="o">.</span><span class="n">collectDirs</span><span class="p">:</span>
               <span class="k">if</span> <span class="n">collectDir</span><span class="o">.</span><span class="n">absolutePath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                  <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each collect directory must set an absolute path.&quot;</span><span class="p">)</span>
               <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect</span><span class="o">.</span><span class="n">collectMode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">collectDir</span><span class="o">.</span><span class="n">collectMode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                  <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Collect mode must either be set in parent collect section or individual collect directory.&quot;</span><span class="p">)</span>
               <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect</span><span class="o">.</span><span class="n">archiveMode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">collectDir</span><span class="o">.</span><span class="n">archiveMode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                  <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Archive mode must either be set in parent collect section or individual collect directory.&quot;</span><span class="p">)</span>
               <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect</span><span class="o">.</span><span class="n">ignoreFile</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">collectDir</span><span class="o">.</span><span class="n">ignoreFile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                  <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Ignore file must either be set in parent collect section or individual collect directory.&quot;</span><span class="p">)</span>
               <span class="k">if</span> <span class="p">(</span><span class="n">collectDir</span><span class="o">.</span><span class="n">linkDepth</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">collectDir</span><span class="o">.</span><span class="n">linkDepth</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">collectDir</span><span class="o">.</span><span class="n">dereference</span><span class="p">:</span>
                  <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dereference flag is only valid when a non-zero link depth is in use.&quot;</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">_validateStage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Validates stage configuration.</span>

<span class="sd">      The target directory must be filled in, and the peers are</span>
<span class="sd">      also validated.</span>

<span class="sd">      Peers are only required in this section if the peers configuration</span>
<span class="sd">      section is not filled in.  However, if any peers are filled in</span>
<span class="sd">      here, they override the peers configuration and must meet the</span>
<span class="sd">      validation criteria in :any:`_validatePeerList`.</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If stage configuration is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stage</span><span class="o">.</span><span class="n">targetDir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Stage section target directory must be filled in.&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">peers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># In this case, stage configuration is our only configuration and must be valid.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_validatePeerList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stage</span><span class="o">.</span><span class="n">localPeers</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stage</span><span class="o">.</span><span class="n">remotePeers</span><span class="p">)</span>
         <span class="k">else</span><span class="p">:</span>
            <span class="c1"># In this case, peers configuration is the default and stage configuration overrides.</span>
            <span class="c1"># Validation is only needed if it&#39;s stage configuration is actually filled in.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stage</span><span class="o">.</span><span class="n">hasPeers</span><span class="p">():</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">_validatePeerList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stage</span><span class="o">.</span><span class="n">localPeers</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stage</span><span class="o">.</span><span class="n">remotePeers</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">_validateStore</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Validates store configuration.</span>

<span class="sd">      The device type, drive speed, and blanking behavior are optional.  All</span>
<span class="sd">      other values are required. Missing booleans will be set to defaults.</span>

<span class="sd">      If blanking behavior is provided, then both a blanking mode and a</span>
<span class="sd">      blanking factor are required.</span>

<span class="sd">      The image writer functionality in the ``writer`` module is supposed to be</span>
<span class="sd">      able to handle a device speed of ``None``.</span>

<span class="sd">      Any caller which needs a &quot;real&quot; (non-``None``) value for the device type</span>
<span class="sd">      can use ``DEFAULT_DEVICE_TYPE``, which is guaranteed to be sensible.</span>

<span class="sd">      This is also where we make sure that the media type -- which is already a</span>
<span class="sd">      valid type -- matches up properly with the device type.</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If store configuration is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">sourceDir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Store section source directory must be filled in.&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">mediaType</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Store section media type must be filled in.&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">devicePath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Store section device path must be filled in.&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">deviceType</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">deviceType</span> <span class="o">==</span> <span class="s2">&quot;cdwriter&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">mediaType</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">VALID_CD_MEDIA_TYPES</span><span class="p">:</span>
               <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Media type must match device type.&quot;</span><span class="p">)</span>
         <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">deviceType</span> <span class="o">==</span> <span class="s2">&quot;dvdwriter&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">mediaType</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">VALID_DVD_MEDIA_TYPES</span><span class="p">:</span>
               <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Media type must match device type.&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">blankBehavior</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">blankBehavior</span><span class="o">.</span><span class="n">blankMode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">blankBehavior</span><span class="o">.</span><span class="n">blankFactor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
               <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;If blanking behavior is provided, all values must be filled in.&quot;</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">_validatePurge</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Validates purge configuration.</span>

<span class="sd">      The list of purge directories may be either ``None`` or an empty list</span>
<span class="sd">      ``[]`` if desired.  All purge directories must contain a path and a retain</span>
<span class="sd">      days value.</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If purge configuration is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">purge</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">purge</span><span class="o">.</span><span class="n">purgeDirs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">purgeDir</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">purge</span><span class="o">.</span><span class="n">purgeDirs</span><span class="p">:</span>
               <span class="k">if</span> <span class="n">purgeDir</span><span class="o">.</span><span class="n">absolutePath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                  <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each purge directory must set an absolute path.&quot;</span><span class="p">)</span>
               <span class="k">if</span> <span class="n">purgeDir</span><span class="o">.</span><span class="n">retainDays</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                  <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Each purge directory must set a retain days value.&quot;</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">_validatePeerList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">localPeers</span><span class="p">,</span> <span class="n">remotePeers</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Validates the set of local and remote peers.</span>

<span class="sd">      Local peers must be completely filled in, including both name and collect</span>
<span class="sd">      directory.  Remote peers must also fill in the name and collect</span>
<span class="sd">      directory, but can leave the remote user and rcp command unset.  In this</span>
<span class="sd">      case, the remote user is assumed to match the backup user from the</span>
<span class="sd">      options section and rcp command is taken directly from the options</span>
<span class="sd">      section.</span>

<span class="sd">      Args:</span>
<span class="sd">         localPeers: List of local peers</span>
<span class="sd">         remotePeers: List of remote peers</span>

<span class="sd">      Raises:</span>
<span class="sd">         ValueError: If stage configuration is invalid</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="n">localPeers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">remotePeers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Peer list must contain at least one backup peer.&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">localPeers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">remotePeers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">remotePeers</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Peer list must contain at least one backup peer.&quot;</span><span class="p">)</span>
      <span class="k">elif</span> <span class="n">localPeers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">remotePeers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">localPeers</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Peer list must contain at least one backup peer.&quot;</span><span class="p">)</span>
      <span class="k">elif</span> <span class="n">localPeers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">remotePeers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">localPeers</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">remotePeers</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Peer list must contain at least one backup peer.&quot;</span><span class="p">)</span>
      <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="k">if</span> <span class="n">localPeers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">for</span> <span class="n">localPeer</span> <span class="ow">in</span> <span class="n">localPeers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">localPeer</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
               <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Local peers must set a name.&quot;</span><span class="p">)</span>
            <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">localPeer</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">localPeer</span><span class="o">.</span><span class="n">collectDir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
               <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Local peers must set a collect directory.&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">remotePeers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
         <span class="k">for</span> <span class="n">remotePeer</span> <span class="ow">in</span> <span class="n">remotePeers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">remotePeer</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
               <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Remote peers must set a name.&quot;</span><span class="p">)</span>
            <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">remotePeer</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">remotePeer</span><span class="o">.</span><span class="n">collectDir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
               <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Remote peers must set a collect directory.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">backupUser</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="n">remotePeer</span><span class="o">.</span><span class="n">remoteUser</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
               <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Remote user must either be set in options section or individual remote peer.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">rcpCommand</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="n">remotePeer</span><span class="o">.</span><span class="n">rcpCommand</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
               <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Remote copy command must either be set in options section or individual remote peer.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">remotePeer</span><span class="o">.</span><span class="n">managed</span><span class="p">:</span>
               <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">rshCommand</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="n">remotePeer</span><span class="o">.</span><span class="n">rshCommand</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                  <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Remote shell command must either be set in options section or individual remote peer.&quot;</span><span class="p">)</span>
               <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">cbackCommand</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="n">remotePeer</span><span class="o">.</span><span class="n">cbackCommand</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                  <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Remote cback command must either be set in options section or individual remote peer.&quot;</span><span class="p">)</span>
               <span class="k">if</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">managedActions</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">managedActions</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span>
                   <span class="ow">and</span> <span class="p">(</span><span class="n">remotePeer</span><span class="o">.</span><span class="n">managedActions</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">remotePeer</span><span class="o">.</span><span class="n">managedActions</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)):</span>
                  <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Managed actions list must be set in options section or individual remote peer.&quot;</span><span class="p">)</span>
      <span class="n">checkUnique</span><span class="p">(</span><span class="s2">&quot;Duplicate peer names exist:&quot;</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span></div>


<span class="c1">########################################################################</span>
<span class="c1"># General utility functions</span>
<span class="c1">########################################################################</span>

<div class="viewcode-block" id="readByteQuantity"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.readByteQuantity">[docs]</a><span class="k">def</span> <span class="nf">readByteQuantity</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Read a byte size value from an XML document.</span>

<span class="sd">   A byte size value is an interpreted string value.  If the string value</span>
<span class="sd">   ends with &quot;MB&quot; or &quot;GB&quot;, then the string before that is interpreted as</span>
<span class="sd">   megabytes or gigabytes.  Otherwise, it is intepreted as bytes.</span>

<span class="sd">   Args:</span>
<span class="sd">      parent: Parent node to search beneath</span>
<span class="sd">      name: Name of node to search for</span>

<span class="sd">   Returns:</span>
<span class="sd">       ByteQuantity parsed from XML document</span>
<span class="sd">   &quot;&quot;&quot;</span>
   <span class="n">data</span> <span class="o">=</span> <span class="n">readString</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
   <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="k">return</span> <span class="kc">None</span>
   <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
   <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;KB&quot;</span><span class="p">):</span>
      <span class="n">quantity</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">data</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s2">&quot;KB&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
      <span class="n">units</span> <span class="o">=</span> <span class="n">UNIT_KBYTES</span>
   <span class="k">elif</span> <span class="n">data</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;MB&quot;</span><span class="p">):</span>
      <span class="n">quantity</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">data</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s2">&quot;MB&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
      <span class="n">units</span> <span class="o">=</span> <span class="n">UNIT_MBYTES</span>
   <span class="k">elif</span> <span class="n">data</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;GB&quot;</span><span class="p">):</span>
      <span class="n">quantity</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">data</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s2">&quot;GB&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
      <span class="n">units</span> <span class="o">=</span> <span class="n">UNIT_GBYTES</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="n">quantity</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
      <span class="n">units</span> <span class="o">=</span> <span class="n">UNIT_BYTES</span>
   <span class="k">return</span> <span class="n">ByteQuantity</span><span class="p">(</span><span class="n">quantity</span><span class="p">,</span> <span class="n">units</span><span class="p">)</span></div>

<div class="viewcode-block" id="addByteQuantityNode"><a class="viewcode-back" href="../../CedarBackup3.html#CedarBackup3.config.addByteQuantityNode">[docs]</a><span class="k">def</span> <span class="nf">addByteQuantityNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="n">nodeName</span><span class="p">,</span> <span class="n">byteQuantity</span><span class="p">):</span>
   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Adds a text node as the next child of a parent, to contain a byte size.</span>

<span class="sd">   If the ``byteQuantity`` is None, then the node will be created, but will</span>
<span class="sd">   be empty (i.e. will contain no text node child).</span>

<span class="sd">   The size in bytes will be normalized.  If it is larger than 1.0 GB, it will</span>
<span class="sd">   be shown in GB (&quot;1.0 GB&quot;).  If it is larger than 1.0 MB (&quot;1.0 MB&quot;), it will</span>
<span class="sd">   be shown in MB.  Otherwise, it will be shown in bytes (&quot;423413&quot;).</span>

<span class="sd">   Args:</span>
<span class="sd">      xmlDom: DOM tree as from ``impl.createDocument()``</span>
<span class="sd">      parentNode: Parent node to create child for</span>
<span class="sd">      nodeName: Name of the new container node</span>
<span class="sd">      byteQuantity: ByteQuantity object to put into the XML document</span>

<span class="sd">   Returns:</span>
<span class="sd">       Reference to the newly-created node</span>
<span class="sd">   &quot;&quot;&quot;</span>
   <span class="k">if</span> <span class="n">byteQuantity</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">byteString</span> <span class="o">=</span> <span class="kc">None</span>
   <span class="k">elif</span> <span class="n">byteQuantity</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="n">UNIT_KBYTES</span><span class="p">:</span>
      <span class="n">byteString</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> KB&quot;</span> <span class="o">%</span> <span class="n">byteQuantity</span><span class="o">.</span><span class="n">quantity</span>
   <span class="k">elif</span> <span class="n">byteQuantity</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="n">UNIT_MBYTES</span><span class="p">:</span>
      <span class="n">byteString</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> MB&quot;</span> <span class="o">%</span> <span class="n">byteQuantity</span><span class="o">.</span><span class="n">quantity</span>
   <span class="k">elif</span> <span class="n">byteQuantity</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="n">UNIT_GBYTES</span><span class="p">:</span>
      <span class="n">byteString</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> GB&quot;</span> <span class="o">%</span> <span class="n">byteQuantity</span><span class="o">.</span><span class="n">quantity</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="n">byteString</span> <span class="o">=</span> <span class="n">byteQuantity</span><span class="o">.</span><span class="n">quantity</span>
   <span class="k">return</span> <span class="n">addStringNode</span><span class="p">(</span><span class="n">xmlDom</span><span class="p">,</span> <span class="n">parentNode</span><span class="p">,</span> <span class="n">nodeName</span><span class="p">,</span> <span class="n">byteString</span><span class="p">)</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Cedar Backup v3  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright .
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.9.
    </div>
  </body>
</html>
